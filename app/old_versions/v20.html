<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gatos y Peces - Juego Virtual</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Poppins', sans-serif; }
        .pet-card { transition: all 0.3s ease; }
        .pet-card:hover { transform: translateY(-5px); }
        .modal { backdrop-filter: blur(10px); }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .shop-item { transition: all 0.2s ease; }
        .shop-item:hover { transform: scale(1.05); }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- Login Screen -->
    <div id="loginScreen" class="min-h-screen gradient-bg flex items-center justify-center">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md">
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold text-gray-800 mb-2">üê± Gatos y Peces üê†</h1>
                <p class="text-gray-600">Perros pr√≥ximamente</p>
            </div>
            
            <form id="loginForm" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Usuario</label>
                    <input type="text" id="username" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Ingresa tu usuario">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Contrase√±a</label>
                    <input type="password" id="password" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="GAME-****">
                </div>
                
                <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition duration-200">
                    Iniciar Sesi√≥n
                </button>
            </form>
            
            <div class="mt-6 text-center">
                <button id="createAccountBtn" class="text-blue-600 hover:text-blue-800 font-medium">
                    Crear nueva cuenta
                </button>
                
                <div class="mt-4 p-3 bg-blue-50 rounded-lg">
                    <p class="text-sm text-blue-700 font-medium mb-2">üí° Acceso r√°pido:</p>
                    <p class="text-xs text-blue-600">Puedes usar cualquier usuario y contrase√±a para crear una cuenta autom√°ticamente</p>
                    <p class="text-xs text-blue-600 mt-1">Ejemplo: usuario "jugador1" con contrase√±a "GAME-123"</p>
                </div>
            </div>
            

        </div>
    </div>

    <!-- Create Account Modal -->
    <div id="createAccountModal" class="hidden fixed inset-0 bg-black bg-opacity-50 modal flex items-center justify-center z-50">
        <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4">
            <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">Crear Nueva Cuenta</h2>
            
            <form id="createAccountForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Usuario</label>
                    <input type="text" id="newUsername" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Nombre de usuario">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Contrase√±a</label>
                    <input type="password" id="newPassword" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="GAME-****">
                    <p class="text-xs text-gray-500 mt-1">Debe comenzar con GAME-</p>
                </div>
                
                <div class="flex space-x-3 pt-4">
                    <button type="submit" class="flex-1 bg-green-600 text-white py-3 rounded-lg font-semibold hover:bg-green-700 transition duration-200">
                        Crear Cuenta
                    </button>
                    <button type="button" id="cancelCreateBtn" class="flex-1 bg-gray-500 text-white py-3 rounded-lg font-semibold hover:bg-gray-600 transition duration-200">
                        Cancelar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Main Game Interface -->
    <div id="gameScreen" class="hidden">
        <!-- Navigation -->
        <nav class="bg-white shadow-lg">
            <div class="max-w-7xl mx-auto px-4">
                <div class="flex justify-between items-center py-4">
                    <div class="flex items-center space-x-4">
                        <h1 class="text-2xl font-bold text-gray-800">üê± Gatos y Peces</h1>
                        <span id="userWelcome" class="text-gray-600"></span>
                    </div>
                    
                    <div class="flex items-center space-x-6">
                        <div class="flex items-center space-x-2">
                            <span class="text-yellow-500">ü™ô</span>
                            <span id="userCoins" class="font-semibold">1000</span>
                            <span class="text-sm text-gray-600">Monedas</span>
                        </div>
                        
                        <div class="flex space-x-2">
                            <button id="homeBtn" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">Casa</button>
                            <button id="shopBtn" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600">Tienda</button>
                            <button id="shelterBtn" class="px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600">Protectora</button>
                            <button id="vetBtn" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600">Veterinario</button>
                            <button id="workBtn" class="px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600">Trabajos</button>
                            <button id="transportBtn" class="px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600">VITRASA</button>
                            <button id="adminBtn" class="hidden px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900">Admin</button>
                        </div>
                        
                        <button id="logoutBtn" class="text-gray-500 hover:text-gray-700">Salir</button>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Home Section -->
        <div id="homeSection" class="max-w-7xl mx-auto px-4 py-8">
            <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
                <!-- Cats Display -->
                <div class="lg:col-span-2">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">üê± Mis Gatos</h2>
                        <div class="text-sm text-gray-600">
                            <span>‚è∞ <span id="gameTime">D√≠a 1, Mes 1, A√±o 1</span></span>
                        </div>
                    </div>
                    
                    <div id="catsContainer" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- Cats will be dynamically added here -->
                    </div>
                    
                    <div id="noCatsMessage" class="text-center py-8 bg-white rounded-xl shadow-sm">
                        <div class="text-4xl mb-2">üê±</div>
                        <p class="text-gray-500 text-sm">No tienes gatos</p>
                    </div>

                    <!-- Aquariums Display -->
                    <div class="mt-8">
                        <h2 class="text-2xl font-bold text-gray-800 mb-6">üê† Mis Peceras</h2>
                        
                        <div id="aquariumsContainer" class="space-y-4">
                            <!-- Aquariums will be dynamically added here -->
                        </div>
                        
                        <div id="noAquariumsMessage" class="text-center py-8 bg-white rounded-xl shadow-sm">
                            <div class="text-4xl mb-2">üè†</div>
                            <p class="text-gray-500 text-sm mb-4">No tienes peceras</p>
                            <button onclick="showSection('shop')" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 text-sm">
                                Comprar Pecera
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Inventory -->
                <div class="lg:col-span-2 space-y-6">
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">Inventario</h3>
                        <div id="inventoryList" class="space-y-3">
                            <!-- Inventory items will be added here -->
                        </div>
                    </div>

                    <!-- Cat Accessories -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">üê± Accesorios para Gatos</h3>
                        <div id="catAccessoriesContainer" class="space-y-3">
                            <!-- Cat accessories will be displayed here -->
                        </div>
                        <div id="noCatAccessoriesMessage" class="text-center py-4 text-gray-500 text-sm">
                            No tienes accesorios instalados
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">Acciones R√°pidas</h3>
                        <div class="space-y-3">
                            <button onclick="setupAquarium()" class="w-full bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 text-sm">
                                üè† Instalar Pecera
                            </button>
                            <button onclick="setupCatAccessory()" class="w-full bg-orange-500 text-white py-2 rounded-lg hover:bg-orange-600 text-sm">
                                üê± Instalar Accesorio
                            </button>
                            <button onclick="showSection('shelter')" class="w-full bg-purple-500 text-white py-2 rounded-lg hover:bg-purple-600 text-sm">
                                üè† Adoptar Mascota
                            </button>
                            <button onclick="feedAllPets()" class="w-full bg-green-500 text-white py-2 rounded-lg hover:bg-green-600 text-sm">
                                ü•´ Alimentar Todos
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Shop Section -->
        <div id="shopSection" class="hidden max-w-7xl mx-auto px-4 py-8">
            <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">üõí Tienda de Mascotas</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                <!-- Shop items will be dynamically added -->
            </div>
        </div>

        <!-- Shelter Section -->
        <div id="shelterSection" class="hidden max-w-7xl mx-auto px-4 py-8">
            <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">üè† Protectora de Animales</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Available pets for adoption -->
            </div>
        </div>

        <!-- Veterinarian Section -->
        <div id="vetSection" class="hidden max-w-7xl mx-auto px-4 py-8">
            <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">üè• Veterinario</h2>
            
            <div class="bg-white rounded-xl shadow-sm p-8">
                <div class="text-center mb-8">
                    <div class="text-6xl mb-4">üë®‚Äç‚öïÔ∏è</div>
                    <h3 class="text-2xl font-semibold text-gray-800 mb-2">Dr. P√©rez</h3>
                    <p class="text-gray-600">Consulta: 50 monedas</p>
                </div>
                
                <div id="sickPetsList" class="space-y-4">
                    <!-- Sick pets will appear here -->
                </div>
                
                <div id="noSickPets" class="text-center py-8">
                    <p class="text-gray-500">¬°Todas tus mascotas est√°n sanas! üéâ</p>
                </div>
            </div>
        </div>

        <!-- Work Section -->
        <div id="workSection" class="hidden max-w-7xl mx-auto px-4 py-8">
            <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">üíº Centro de Trabajos</h2>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Active Jobs -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Trabajos Activos</h3>
                    <div id="activeJobsList" class="space-y-4">
                        <!-- Active jobs will appear here -->
                    </div>
                    <div id="noActiveJobs" class="text-center py-8 text-gray-500">
                        No tienes trabajos activos
                    </div>
                </div>
                
                <!-- Available Jobs -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Trabajos Disponibles</h3>
                    <div class="space-y-3">
                        <button id="petCareBtn" onclick="startJob('petCare')" class="w-full bg-blue-500 text-white py-3 px-4 rounded-lg hover:bg-blue-600 text-left">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="font-semibold">üêæ Cuidador de Mascotas</div>
                                    <div class="text-sm opacity-90">80-120 monedas ‚Ä¢ 2 horas</div>
                                </div>
                                <div class="text-xs opacity-75">Requiere: Mascotas</div>
                            </div>
                        </button>
                        
                        <button onclick="startJob('shopKeeper')" class="w-full bg-green-500 text-white py-3 px-4 rounded-lg hover:bg-green-600 text-left">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="font-semibold">üè™ Vendedor de Tienda</div>
                                    <div class="text-sm opacity-90">60-100 monedas ‚Ä¢ 3 horas</div>
                                </div>
                                <div class="text-xs opacity-75">Sin requisitos</div>
                            </div>
                        </button>
                        
                        <button onclick="startJob('delivery')" class="w-full bg-purple-500 text-white py-3 px-4 rounded-lg hover:bg-purple-600 text-left">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="font-semibold">üöö Repartidor</div>
                                    <div class="text-sm opacity-90">100-150 monedas ‚Ä¢ 1 hora</div>
                                </div>
                                <div class="text-xs opacity-75">Sin requisitos</div>
                            </div>
                        </button>
                        
                        <button id="vetAssistantBtn" onclick="startJob('vetAssistant')" class="w-full bg-red-500 text-white py-3 px-4 rounded-lg hover:bg-red-600 text-left">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="font-semibold">üè• Asistente Veterinario</div>
                                    <div class="text-sm opacity-90">120-180 monedas ‚Ä¢ 4 horas</div>
                                </div>
                                <div class="text-xs opacity-75">Requiere: Medicinas</div>
                            </div>
                        </button>
                        
                        <button id="trainerBtn" onclick="startJob('trainer')" class="w-full bg-yellow-500 text-white py-3 px-4 rounded-lg hover:bg-yellow-600 text-left">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="font-semibold">üé™ Entrenador de Shows</div>
                                    <div class="text-sm opacity-90">200-300 monedas ‚Ä¢ 6 horas</div>
                                </div>
                                <div class="text-xs opacity-75">Requiere: 3+ mascotas felices</div>
                            </div>
                        </button>
                        
                        <button id="beautyContestBtn" onclick="startJob('beautyContest')" class="w-full bg-pink-500 text-white py-3 px-4 rounded-lg hover:bg-pink-600 text-left">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="font-semibold">üèÜ Concurso de Belleza</div>
                                    <div class="text-sm opacity-90">500-1000 monedas ‚Ä¢ 8 horas</div>
                                </div>
                                <div class="text-xs opacity-75">Requiere: Mascota con collar</div>
                            </div>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Breeding Section -->
            <div class="mt-8 bg-white rounded-xl shadow-sm p-6">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">üíï Centro de Cr√≠a</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="text-center">
                        <div class="text-4xl mb-2">üê±</div>
                        <h4 class="font-semibold mb-2">Cr√≠a de Gatos</h4>
                        <p class="text-sm text-gray-600 mb-4">Costo: 200 monedas ‚Ä¢ Duraci√≥n: 12 horas<br>Resultado: 1-4 gatitos</p>
                        <button onclick="startBreeding('cat')" class="bg-orange-500 text-white px-6 py-2 rounded-lg hover:bg-orange-600">
                            Iniciar Cr√≠a
                        </button>
                    </div>
                    
                    <div class="text-center">
                        <div class="text-4xl mb-2">üê†</div>
                        <h4 class="font-semibold mb-2">Cr√≠a de Peces</h4>
                        <p class="text-sm text-gray-600 mb-4">Costo: 100 monedas ‚Ä¢ Duraci√≥n: 6 horas<br>Resultado: 3-8 alevines</p>
                        <button onclick="startBreeding('fish')" class="bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600">
                            Iniciar Cr√≠a
                        </button>
                    </div>
                </div>
                
                <div id="breedingProjectsList" class="mt-6 space-y-4">
                    <!-- Breeding projects will appear here -->
                </div>
            </div>
        </div>

        <!-- Transport Section -->
        <div id="transportSection" class="hidden max-w-7xl mx-auto px-4 py-8">
            <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">üöå VITRASA - Transporte</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="bg-white rounded-xl shadow-sm p-6 text-center">
                    <div class="text-4xl mb-4">üöå</div>
                    <h3 class="font-semibold text-gray-800 mb-2">L√≠nea C1</h3>
                    <p class="text-sm text-gray-600 mb-4">Casa ‚Üí Tienda ‚Üí Veterinario ‚Üí Casa</p>
                    <button onclick="takeTransport('C1')" class="w-full bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600">
                        15 monedas
                    </button>
                </div>
                
                <div class="bg-white rounded-xl shadow-sm p-6 text-center">
                    <div class="text-4xl mb-4">üöå</div>
                    <h3 class="font-semibold text-gray-800 mb-2">L√≠nea 5A</h3>
                    <p class="text-sm text-gray-600 mb-4">Casa ‚Üí Tienda ‚Üí Casa</p>
                    <button onclick="takeTransport('5A')" class="w-full bg-green-500 text-white py-2 rounded-lg hover:bg-green-600">
                        15 monedas
                    </button>
                </div>
                
                <div class="bg-white rounded-xl shadow-sm p-6 text-center">
                    <div class="text-4xl mb-4">üöå</div>
                    <h3 class="font-semibold text-gray-800 mb-2">L√≠nea 15C</h3>
                    <p class="text-sm text-gray-600 mb-4">Casa ‚Üí Protectora ‚Üí Tienda ‚Üí Protectora ‚Üí Casa</p>
                    <button onclick="takeTransport('15C')" class="w-full bg-purple-500 text-white py-2 rounded-lg hover:bg-purple-600">
                        15 monedas
                    </button>
                </div>
                
                <div class="bg-white rounded-xl shadow-sm p-6 text-center">
                    <div class="text-4xl mb-4">üöå</div>
                    <h3 class="font-semibold text-gray-800 mb-2">L√≠nea 28</h3>
                    <p class="text-sm text-gray-600 mb-4">Casa ‚Üí Veterinario ‚Üí Casa</p>
                    <button onclick="takeTransport('28')" class="w-full bg-red-500 text-white py-2 rounded-lg hover:bg-red-600">
                        15 monedas
                    </button>
                </div>
            </div>
        </div>

        <!-- Admin Section -->
        <div id="adminSection" class="hidden max-w-7xl mx-auto px-4 py-8">
            <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">‚öôÔ∏è Panel de Administrador</h2>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Pet Management -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Gesti√≥n de Animales</h3>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Agregar Nueva Raza</label>
                            <div class="flex space-x-2">
                                <select id="newPetType" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg">
                                    <option value="cat">Gato</option>
                                    <option value="fish">Pez</option>
                                </select>
                                <input type="text" id="newBreedName" placeholder="Nombre de la raza" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg">
                                <button onclick="addBreed()" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">
                                    Agregar
                                </button>
                            </div>
                        </div>
                        
                        <div id="breedsList" class="space-y-2">
                            <!-- Breeds will be listed here -->
                        </div>
                    </div>
                </div>
                
                <!-- Shop Management -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Gesti√≥n de Tienda</h3>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Agregar Producto</label>
                            <div class="grid grid-cols-2 gap-2">
                                <input type="text" id="newItemName" placeholder="Nombre del producto" class="px-3 py-2 border border-gray-300 rounded-lg">
                                <input type="number" id="newItemPrice" placeholder="Precio" class="px-3 py-2 border border-gray-300 rounded-lg">
                                <select id="newItemCategory" class="px-3 py-2 border border-gray-300 rounded-lg">
                                    <option value="food">Comida</option>
                                    <option value="toy">Juguete</option>
                                    <option value="accessory">Accesorio</option>
                                    <option value="medicine">Medicina</option>
                                </select>
                                <button onclick="addShopItem()" class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600">
                                    Agregar
                                </button>
                            </div>
                        </div>
                        
                        <div id="shopItemsList" class="space-y-2 max-h-64 overflow-y-auto">
                            <!-- Shop items will be listed here -->
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Birth Management -->
            <div class="mt-8 bg-white rounded-xl shadow-sm p-6">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">Gesti√≥n de Nacimientos</h3>
                <div id="birthsList" class="space-y-4">
                    <!-- Birth records will appear here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="petModal" class="hidden fixed inset-0 bg-black bg-opacity-50 modal flex items-center justify-center z-50">
        <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4">
            <div id="petModalContent">
                <!-- Pet details will be shown here -->
            </div>
        </div>
    </div>

    <script>
        // Game State
        let gameState = {
            currentUser: null,
            users: {},
            gameTime: {
                hour: 8,
                day: 1,
                month: 1,
                year: 1
            },
            shopItems: [
                { id: 1, name: 'Comida para gatos', price: 25, category: 'food', emoji: 'ü•´' },
                { id: 2, name: 'Comida para peces', price: 15, category: 'food', emoji: 'üêü' },
                { id: 3, name: 'Juguete rat√≥n', price: 30, category: 'toy', emoji: 'üê≠' },
                { id: 4, name: 'Pecera peque√±a (fr√≠a)', price: 80, category: 'aquarium', emoji: 'üè†', capacity: 3, temperature: 'cold' },
                { id: 5, name: 'Pecera mediana (fr√≠a)', price: 150, category: 'aquarium', emoji: 'üèòÔ∏è', capacity: 6, temperature: 'cold' },
                { id: 6, name: 'Pecera grande (fr√≠a)', price: 250, category: 'aquarium', emoji: 'üè∞', capacity: 10, temperature: 'cold' },
                { id: 22, name: 'Pecera peque√±a (caliente)', price: 120, category: 'aquarium', emoji: 'üå°Ô∏è', capacity: 3, temperature: 'warm' },
                { id: 23, name: 'Pecera mediana (caliente)', price: 200, category: 'aquarium', emoji: 'üî•', capacity: 6, temperature: 'warm' },
                { id: 24, name: 'Pecera grande (caliente)', price: 320, category: 'aquarium', emoji: '‚ô®Ô∏è', capacity: 10, temperature: 'warm' },
                { id: 7, name: 'Collar b√°sico', price: 35, category: 'collar', emoji: 'üîó' },
                { id: 8, name: 'Collar elegante', price: 65, category: 'collar', emoji: 'üéÄ' },
                { id: 9, name: 'Collar de diamantes', price: 120, category: 'collar', emoji: 'üíé' },
                { id: 10, name: 'Collar con cascabel', price: 45, category: 'collar', emoji: 'üîî' },
                { id: 25, name: 'Collar de cuero', price: 55, category: 'collar', emoji: 'üü§' },
                { id: 26, name: 'Collar con GPS', price: 180, category: 'collar', emoji: 'üìç' },
                { id: 11, name: 'Cama suave', price: 80, category: 'catAccessory', emoji: 'üõèÔ∏è' },
                { id: 12, name: 'Arenero', price: 60, category: 'catAccessory', emoji: 'üì¶' },
                { id: 27, name: 'Rascador', price: 90, category: 'catAccessory', emoji: 'ü™µ' },
                { id: 13, name: 'Adorno coral', price: 35, category: 'decoration', emoji: 'ü™∏' },
                { id: 14, name: 'Castillo acu√°tico', price: 55, category: 'decoration', emoji: 'üè∞' },
                { id: 15, name: 'Pi√±a decorativa', price: 25, category: 'decoration', emoji: 'üçç' },
                { id: 16, name: 'Cueva rocosa', price: 40, category: 'decoration', emoji: 'ü™®' },
                { id: 17, name: 'Planta acu√°tica', price: 20, category: 'decoration', emoji: 'üåø' },
                { id: 28, name: 'Tesoro pirata', price: 45, category: 'decoration', emoji: 'üí∞' },
                { id: 29, name: 'Barco hundido', price: 60, category: 'decoration', emoji: 'üö¢' },
                { id: 30, name: 'Algas marinas', price: 18, category: 'decoration', emoji: 'üåä' },
                { id: 18, name: 'Vacuna completa', price: 12, category: 'medicine', emoji: 'üíâ' },
                { id: 19, name: 'Antibi√≥tico', price: 20, category: 'medicine', emoji: 'üíä' },
                { id: 20, name: 'Vitaminas', price: 15, category: 'medicine', emoji: 'üß™' },
                { id: 21, name: 'Antiparasitario', price: 18, category: 'medicine', emoji: 'ü©π' }
            ],
            availablePets: [],
            breeds: {
                cat: [
                    { name: 'Siam√©s', emoji: 'üê±', colors: ['blanco', 'chocolate'], photo: 'https://lucasmaneirodelatm-dot.github.io/tamagochi/pictures/cats/Gato%20009.png' },
                    { name: 'Persa', emoji: 'üò∫', colors: ['blanco', 'naranja'], photo: 'https://lucasmaneirodelatm-dot.github.io/tamagochi/pictures/cats/Gato%20de%20cualquier%20recibiendo%20caricias.jpg' },
                    { name: 'Maine Coon', emoji: 'ü¶Å', colors: ['marr√≥n', 'gris'], photo: 'https://lucasmaneirodelatm-dot.github.io/tamagochi/pictures/cats/Gato%20escondido%20(3).jpg' },
                    { name: 'Brit√°nico', emoji: 'üò∏', colors: ['gris'], photo: 'https://lucasmaneirodelatm-dot.github.io/tamagochi/pictures/cats/Gato%20008.png' },
                    { name: 'Bengal√≠', emoji: 'üêÖ', colors: ['dorado', 'manchado'], photo: 'https://lucasmaneirodelatm-dot.github.io/tamagochi/pictures/cats/Gato%20recien%20nacido%20muy%20adorable%20(1).jpg' },
                    { name: 'Ragdoll', emoji: 'üòª', colors: ['blanco', 'gris'], photo: 'https://lucasmaneirodelatm-dot.github.io/tamagochi/pictures/cats/Gatos%20de%20diferentes%20colores%20(3).jpg' },
                    { name: 'Sphynx', emoji: 'üôÄ', colors: ['rosa', 'gris'], photo: 'https://lucasmaneirodelatm-dot.github.io/tamagochi/pictures/cats/Gato%20007.png' },
                    { name: 'Negro', emoji: '‚ö´', colors: ['negro'], photo: 'https://lucasmaneirodelatm-dot.github.io/tamagochi/pictures/cats/photo-1595433707802-6b2626ef1c91.jpg' },
                    { name: 'Atigrado', emoji: 'üêÖ', colors: ['negro', 'gris'], photo: 'https://lucasmaneirodelatm-dot.github.io/tamagochi/pictures/cats/Gato%20007.png' },
                    { name: 'Abisinio', emoji: 'üòæ', colors: ['canela', 'rojizo'], photo: 'https://lucasmaneirodelatm-dot.github.io/tamagochi/pictures/cats/Gato%20002.png' }
                ],
                fish: {
                    coldWater: [
                        { name: 'Cometa Rojo', emoji: 'üêü', colors: ['rojo'], photo: 'https://lucasmaneirodelatm-dot.github.io/tamagochi/pictures/fishes/cometa.webp' },
                        { name: 'Cometa Amarillo', emoji: 'üü°', colors: ['amarillo'], photo: 'https://lucasmaneirodelatm-dot.github.io/tamagochi/pictures/fishes/images%20(4).jpeg' },
                        { name: 'Corydora', emoji: 'üü§', colors: ['rayado', 'amarillo'], photo: 'https://lucasmaneirodelatm-dot.github.io/tamagochi/pictures/fishes/images%20(2).jpeg' },
                        { name: 'Goldfish', emoji: 'üê†', colors: ['dorado', 'azul'], photo: 'https://lucasmaneirodelatm-dot.github.io/tamagochi/pictures/fishes/Pecera%20con%20varios%20peces%20cometa%20de%20diferente%20color%20(3).jpg' }
                    ],
                    warmWater: [
                        { name: 'Betta', emoji: 'üêü', colors: ['blanco', 'naranja', 'negro'], photo: 'https://lucasmaneirodelatm-dot.github.io/tamagochi/pictures/fishes/a63210245b77e940c02d12256d5258a3.jpg' },
                        { name: 'Guppy', emoji: 'üü†', colors: ['rayado', 'gris'], photo: 'https://lucasmaneirodelatm-dot.github.io/tamagochi/pictures/fishes/Cebras(3).jpg' },
                        { name: 'Tetra', emoji: 'üîµ', colors: ['rayado', 'gris'], photo: 'https://lucasmaneirodelatm-dot.github.io/tamagochi/pictures/fishes/Cebras(1).jpg' },
                        { name: 'Nemo', emoji: 'üî∂', colors: ['naranja', 'blanco'], photo: 'https://lucasmaneirodelatm-dot.github.io/tamagochi/pictures/fishes/photo-1535591273668-578e31182c4f.jpg' }
                    ]
                }
            },
            petNames: {
                cat: {
                    male: ['Simba', 'Garfield', 'F√©lix', 'Shadow', 'Tiger', 'Smokey', 'Max', 'Charlie', 'Leo', 'Milo'],
                    female: ['Luna', 'Nala', 'Bella', 'Mittens', 'Coco', 'Mia', 'Chloe', 'Sophie', 'Lily', 'Zoe']
                },
                fish: {
                    male: ['Nemo', 'Finn', 'Neptuno', 'Azul', 'Dorado', 'Cristal', 'Oc√©ano', 'Splash', 'Aqua', 'Coral'],
                    female: ['Dory', 'Marina', 'Perla', 'Estrella', 'Sirena', 'Burbuja', 'Coral', 'Aqua', 'Luna', 'Bella']
                }
            }
        };

        // Initialize game
        document.addEventListener('DOMContentLoaded', function() {
            loadGameData();
            initializeGame();
            startGameTime();
            generateInitialPets();
        });

        function loadGameData() {
            const savedData = localStorage.getItem('catsFishGameData');
            if (savedData) {
                const parsed = JSON.parse(savedData);
                gameState.users = parsed.users || {};
                gameState.gameTime = parsed.gameTime || gameState.gameTime;
                gameState.availablePets = parsed.availablePets || [];
            }
            
            // Create admin account if it doesn't exist
            if (!gameState.users['admin']) {
                gameState.users['admin'] = {
                    password: 'GAME-ADMIN',
                    isAdmin: true,
                    coins: 5000,
                    pets: [],
                    aquariums: [],
                    catAccessories: [],
                    inventory: {
                        'Comida para gatos': 5,
                        'Comida para peces': 5,
                        'Medicina b√°sica': 3,
                        'Vitaminas': 2,
                        'Pecera grande (fr√≠a)': 1,
                        'Rascador': 1,
                        'Arenero': 1,
                        'Adorno coral': 2
                    }
                };
            }
        }

        function saveGameData() {
            const dataToSave = {
                users: gameState.users,
                gameTime: gameState.gameTime,
                availablePets: gameState.availablePets
            };
            localStorage.setItem('catsFishGameData', JSON.stringify(dataToSave));
        }

        function initializeGame() {
            // Event listeners
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
            document.getElementById('createAccountBtn').addEventListener('click', showCreateAccountModal);
            document.getElementById('createAccountForm').addEventListener('submit', handleCreateAccount);
            document.getElementById('cancelCreateBtn').addEventListener('click', hideCreateAccountModal);
            document.getElementById('logoutBtn').addEventListener('click', logout);
            
            // Navigation buttons
            document.getElementById('homeBtn').addEventListener('click', () => showSection('home'));
            document.getElementById('shopBtn').addEventListener('click', () => showSection('shop'));
            document.getElementById('shelterBtn').addEventListener('click', () => showSection('shelter'));
            document.getElementById('vetBtn').addEventListener('click', () => showSection('vet'));
            document.getElementById('workBtn').addEventListener('click', () => showSection('work'));
            document.getElementById('transportBtn').addEventListener('click', () => showSection('transport'));
            document.getElementById('adminBtn').addEventListener('click', () => showSection('admin'));

            updateDisplay();
        }

        function generateInitialPets() {
            if (gameState.availablePets.length < 3) {
                for (let i = 0; i < 5; i++) {
                    addRandomPetToShelter();
                }
            }
        }

        function handleLogin(e) {
            e.preventDefault();
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();

            if (!username || !password) {
                alert('Por favor completa todos los campos');
                return;
            }

            // Check if user exists, if not create a demo account
            if (!gameState.users[username]) {
                // Create demo account automatically
                gameState.users[username] = {
                    password: password,
                    isAdmin: username === 'admin',
                    coins: 1000,
                    pets: [],
                    aquariums: [], // Array of aquarium objects
                    catAccessories: [], // Array of installed cat accessories
                    activeJobs: [], // Array of active jobs
                    breedingProjects: [], // Array of breeding projects
                    inventory: {
                        'Comida para gatos': 3,
                        'Comida para peces': 3,
                        'Vitaminas': 2
                    }
                };
                saveGameData();
            }

            if (gameState.users[username] && gameState.users[username].password === password) {
                gameState.currentUser = username;
                document.getElementById('loginScreen').classList.add('hidden');
                document.getElementById('gameScreen').classList.remove('hidden');
                
                if (gameState.users[username].isAdmin) {
                    document.getElementById('adminBtn').classList.remove('hidden');
                }
                
                // Clear form
                document.getElementById('username').value = '';
                document.getElementById('password').value = '';
                
                // Initialize arrays if they don't exist
                const user = gameState.users[username];
                if (!user.activeJobs) user.activeJobs = [];
                if (!user.breedingProjects) user.breedingProjects = [];
                if (!user.aquariums) user.aquariums = [];
                if (!user.catAccessories) user.catAccessories = [];
                
                updateDisplay();
                showSection('home');
                saveGameData();
            } else {
                alert('Usuario o contrase√±a incorrectos');
            }
        }

        function showCreateAccountModal() {
            document.getElementById('createAccountModal').classList.remove('hidden');
        }

        function hideCreateAccountModal() {
            document.getElementById('createAccountModal').classList.add('hidden');
            // Clear form
            document.getElementById('newUsername').value = '';
            document.getElementById('newPassword').value = '';
        }

        function handleCreateAccount(e) {
            e.preventDefault();
            const username = document.getElementById('newUsername').value.trim();
            const password = document.getElementById('newPassword').value.trim();
            
            if (!username || !password) {
                alert('Por favor completa todos los campos');
                return;
            }
            
            if (gameState.users[username]) {
                alert('Este usuario ya existe');
                return;
            }
            
            if (!password.startsWith('GAME-')) {
                alert('La contrase√±a debe comenzar con GAME-');
                return;
            }
            
            if (password.length < 6) {
                alert('La contrase√±a debe tener al menos 6 caracteres');
                return;
            }
            
            gameState.users[username] = {
                password: password,
                isAdmin: false,
                coins: 1000,
                pets: [],
                aquariums: [],
                catAccessories: [],
                inventory: {
                    'Comida para gatos': 3,
                    'Comida para peces': 3,
                    'Vitaminas': 2
                }
            };
            
            saveGameData();
            hideCreateAccountModal();
            alert('¬°Cuenta creada exitosamente! Ya puedes iniciar sesi√≥n.');
        }

        function logout() {
            gameState.currentUser = null;
            document.getElementById('loginScreen').classList.remove('hidden');
            document.getElementById('gameScreen').classList.add('hidden');
            document.getElementById('adminBtn').classList.add('hidden');
        }

        function showSection(section) {
            // Hide all sections
            const sections = ['home', 'shop', 'shelter', 'vet', 'work', 'transport', 'admin'];
            sections.forEach(s => {
                document.getElementById(s + 'Section').classList.add('hidden');
            });
            
            // Show selected section
            document.getElementById(section + 'Section').classList.remove('hidden');
            
            // Update section content
            switch(section) {
                case 'home':
                    updatePetsDisplay();
                    updateInventoryDisplay();
                    break;
                case 'shop':
                    updateShopDisplay();
                    break;
                case 'shelter':
                    updateShelterDisplay();
                    break;
                case 'vet':
                    updateVetDisplay();
                    break;
                case 'work':
                    updateWorkDisplay();
                    break;
                case 'admin':
                    updateAdminDisplay();
                    break;
            }
        }

        function updateDisplay() {
            if (!gameState.currentUser) return;
            
            const user = gameState.users[gameState.currentUser];
            document.getElementById('userWelcome').textContent = `Bienvenido, ${gameState.currentUser}`;
            document.getElementById('userCoins').textContent = user.coins;
            document.getElementById('gameTime').textContent = `${gameState.gameTime.hour}:00h - D√≠a ${gameState.gameTime.day}, Mes ${gameState.gameTime.month}, A√±o ${gameState.gameTime.year}`;
        }

        function updatePetsDisplay() {
            const user = gameState.users[gameState.currentUser];
            updateCatsDisplay();
            updateAquariumsDisplay();
            updateCatAccessoriesDisplay();
        }

        function updateCatsDisplay() {
            const user = gameState.users[gameState.currentUser];
            const cats = user.pets.filter(pet => pet.type === 'cat');
            const container = document.getElementById('catsContainer');
            const noMessage = document.getElementById('noCatsMessage');
            
            if (cats.length === 0) {
                container.innerHTML = '';
                noMessage.classList.remove('hidden');
                return;
            }
            
            noMessage.classList.add('hidden');
            container.innerHTML = cats.map(pet => {
                const health = Math.round(pet.health * 10) / 10;
                const happiness = Math.round(pet.happiness * 10) / 10;
                const age = Math.round(pet.age * 10) / 10;
                const breedData = gameState.breeds.cat.find(b => b.name === pet.breed);
                
                return `
                <div class="pet-card bg-white rounded-xl shadow-sm p-4 cursor-pointer" onclick="showPetDetails('${pet.id}')">
                    <div class="text-center">
                        <div class="w-20 h-20 mx-auto mb-3 rounded-full overflow-hidden bg-gray-200">
                            <img src="${breedData?.photo || ''}" alt="${pet.name}" class="w-full h-full object-cover" 
                                 onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                            <div class="text-4xl pt-4 hidden">${pet.emoji}</div>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-1">${pet.name}</h3>
                        <p class="text-xs text-gray-600 mb-1">${pet.gender === 'male' ? '‚ôÇÔ∏è' : '‚ôÄÔ∏è'} ${pet.breed}</p>
                        <p class="text-xs text-gray-500 mb-2">${pet.color} ‚Ä¢ ${age} ${age === 1 ? 'mes' : 'meses'}</p>
                        ${pet.collar ? `<p class="text-purple-600 text-xs mb-2">üéÄ ${pet.collar}</p>` : ''}
                        
                        <div class="space-y-1">
                            <div class="flex items-center justify-between text-xs">
                                <span>Salud:</span>
                                <span class="${health > 70 ? 'text-green-600' : health > 40 ? 'text-yellow-600' : 'text-red-600'}">${health}%</span>
                            </div>
                            <div class="flex items-center justify-between text-xs">
                                <span>Felicidad:</span>
                                <span class="${happiness > 70 ? 'text-green-600' : happiness > 40 ? 'text-yellow-600' : 'text-red-600'}">${happiness}%</span>
                            </div>
                        </div>
                        
                        ${health < 50 ? '<div class="mt-2 text-red-500 text-xs">ü§í Enfermo</div>' : ''}
                    </div>
                </div>
            `;
            }).join('');
        }

        function updateCatAccessoriesDisplay() {
            const user = gameState.users[gameState.currentUser];
            const container = document.getElementById('catAccessoriesContainer');
            const noMessage = document.getElementById('noCatAccessoriesMessage');
            
            if (!user.catAccessories || user.catAccessories.length === 0) {
                container.innerHTML = '';
                noMessage.classList.remove('hidden');
                return;
            }
            
            noMessage.classList.add('hidden');
            container.innerHTML = user.catAccessories.map(accessory => `
                <div class="flex items-center justify-between p-3 bg-orange-50 rounded-lg">
                    <div class="flex items-center space-x-3">
                        <span class="text-2xl">${accessory.emoji}</span>
                        <span class="font-medium text-gray-800">${accessory.name}</span>
                    </div>
                    <button onclick="removeCatAccessory('${accessory.id}')" class="text-red-500 hover:text-red-700 text-sm">
                        Quitar
                    </button>
                </div>
            `).join('');
        }

        function updateAquariumsDisplay() {
            const user = gameState.users[gameState.currentUser];
            const container = document.getElementById('aquariumsContainer');
            const noMessage = document.getElementById('noAquariumsMessage');
            
            if (!user.aquariums || user.aquariums.length === 0) {
                container.innerHTML = '';
                noMessage.classList.remove('hidden');
                return;
            }
            
            noMessage.classList.add('hidden');
            container.innerHTML = user.aquariums.map(aquarium => {
                const fish = user.pets.filter(pet => pet.aquariumId === aquarium.id);
                const capacity = aquarium.capacity;
                const used = fish.length;
                const decorations = aquarium.decorations || [];
                const tempIcon = aquarium.temperature === 'warm' ? 'üå°Ô∏è' : '‚ùÑÔ∏è';
                const tempText = aquarium.temperature === 'warm' ? 'Caliente' : 'Fr√≠a';
                
                return `
                <div class="bg-white rounded-xl shadow-sm p-4">
                    <div class="flex justify-between items-center mb-3">
                        <div>
                            <h4 class="font-semibold text-gray-800">${aquarium.emoji} ${aquarium.name}</h4>
                            <p class="text-xs text-gray-500">${tempIcon} Agua ${tempText}</p>
                        </div>
                        <span class="text-sm text-gray-600">${used}/${capacity} peces</span>
                    </div>
                    
                    <!-- Aquarium Visual -->
                    <div class="relative bg-gradient-to-b from-blue-100 to-blue-200 rounded-lg p-3 mb-3 min-h-[120px] border-4 border-blue-300">
                        <!-- Decorations at bottom -->
                        <div class="absolute bottom-2 left-2 right-2 flex justify-center space-x-1">
                            ${decorations.map(decoration => `
                                <span class="text-lg" title="${decoration}">${gameState.shopItems.find(item => item.name === decoration)?.emoji || 'üé®'}</span>
                            `).join('')}
                        </div>
                        
                        <!-- Fish swimming -->
                        <div class="grid grid-cols-5 gap-1 h-full">
                            ${fish.map(pet => {
                                const allFish = [...gameState.breeds.fish.coldWater, ...gameState.breeds.fish.warmWater];
                                const breedData = allFish.find(b => b.name === pet.breed);
                                return `
                                <div class="text-center cursor-pointer flex flex-col justify-center" onclick="showPetDetails('${pet.id}')">
                                    <div class="w-8 h-8 mx-auto mb-1 rounded-full overflow-hidden bg-blue-50">
                                        <img src="${breedData?.photo || ''}" alt="${pet.name}" class="w-full h-full object-cover" 
                                             onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                                        <div class="text-sm pt-1 hidden">${pet.emoji}</div>
                                    </div>
                                    <p class="text-xs text-gray-700">${pet.name}</p>
                                    <p class="text-xs text-gray-500">${pet.gender === 'male' ? '‚ôÇÔ∏è' : '‚ôÄÔ∏è'}</p>
                                </div>
                            `}).join('')}
                            ${Array(capacity - used).fill().map(() => `
                                <div class="w-8 h-8 mx-auto border-2 border-dashed border-blue-300 rounded-full flex items-center justify-center">
                                    <span class="text-blue-400 text-xs">+</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-3 gap-2 text-xs">
                        <button onclick="addFishToAquarium('${aquarium.id}')" 
                                class="bg-blue-500 text-white py-1 px-2 rounded hover:bg-blue-600 ${used >= capacity ? 'opacity-50 cursor-not-allowed' : ''}"
                                ${used >= capacity ? 'disabled' : ''}>
                            + Pez
                        </button>
                        <button onclick="decorateAquarium('${aquarium.id}')" class="bg-green-500 text-white py-1 px-2 rounded hover:bg-green-600">
                            üé® Decorar
                        </button>
                        <button onclick="removeAquarium('${aquarium.id}')" class="bg-red-500 text-white py-1 px-2 rounded hover:bg-red-600">
                            Quitar
                        </button>
                    </div>
                </div>
            `;
            }).join('');
        }

        function updateInventoryDisplay() {
            const user = gameState.users[gameState.currentUser];
            const container = document.getElementById('inventoryList');
            
            const items = Object.entries(user.inventory).filter(([name, quantity]) => quantity > 0);
            
            if (items.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center">Inventario vac√≠o</p>';
                return;
            }
            
            container.innerHTML = items.map(([name, quantity]) => {
                const item = gameState.shopItems.find(i => i.name === name);
                const emoji = item ? item.emoji : 'üì¶';
                
                return `
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <span class="text-2xl">${emoji}</span>
                            <span class="font-medium text-gray-800">${name}</span>
                        </div>
                        <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-sm font-medium">${quantity}</span>
                    </div>
                `;
            }).join('');
        }

        function updateShopDisplay() {
            const container = document.getElementById('shopSection');
            const itemsGrid = container.querySelector('.grid') || container;
            
            itemsGrid.innerHTML = gameState.shopItems.map(item => `
                <div class="shop-item bg-white rounded-xl shadow-sm p-6 text-center">
                    <div class="text-4xl mb-4">${item.emoji}</div>
                    <h3 class="font-semibold text-gray-800 mb-2">${item.name}</h3>
                    <p class="text-2xl font-bold text-green-600 mb-4">${item.price} ü™ô</p>
                    <button onclick="buyItem(${item.id})" class="w-full bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition duration-200">
                        Comprar
                    </button>
                </div>
            `).join('');
        }

        function updateShelterDisplay() {
            const container = document.getElementById('shelterSection');
            const petsGrid = container.querySelector('.grid') || container;
            
            if (gameState.availablePets.length === 0) {
                petsGrid.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <div class="text-6xl mb-4">üè†</div>
                        <h3 class="text-xl font-semibold text-gray-700 mb-2">No hay mascotas disponibles</h3>
                        <p class="text-gray-500">Vuelve m√°s tarde, llegan nuevas mascotas cada hora</p>
                    </div>
                `;
                return;
            }
            
            petsGrid.innerHTML = gameState.availablePets.map(pet => {
                const health = Math.round(pet.health * 10) / 10;
                const happiness = Math.round(pet.happiness * 10) / 10;
                const age = Math.round(pet.age * 10) / 10;
                
                let breedData;
                if (pet.type === 'cat') {
                    breedData = gameState.breeds.cat.find(b => b.name === pet.breed);
                } else {
                    const allFish = [...gameState.breeds.fish.coldWater, ...gameState.breeds.fish.warmWater];
                    breedData = allFish.find(b => b.name === pet.breed);
                }
                
                const tempRequirement = pet.temperature ? 
                    `<p class="text-blue-600 text-xs mb-2">${pet.temperature === 'warm' ? 'üå°Ô∏è Agua caliente' : '‚ùÑÔ∏è Agua fr√≠a'}</p>` : '';
                
                return `
                <div class="bg-white rounded-xl shadow-sm p-6 text-center">
                    <div class="w-24 h-24 mx-auto mb-4 rounded-full overflow-hidden bg-gray-200">
                        <img src="${breedData?.photo || ''}" alt="${pet.name}" class="w-full h-full object-cover" 
                             onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                        <div class="text-6xl pt-4 hidden">${pet.emoji}</div>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-800 mb-2">${pet.name}</h3>
                    <p class="text-gray-600 mb-1">${pet.gender === 'male' ? '‚ôÇÔ∏è' : '‚ôÄÔ∏è'} ${pet.breed}</p>
                    <p class="text-gray-500 mb-4">${pet.color} ‚Ä¢ ${age} ${age === 1 ? 'mes' : 'meses'}</p>
                    
                    <div class="mb-4 space-y-2">
                        <div class="flex justify-between text-sm">
                            <span>Salud:</span>
                            <span class="${health > 70 ? 'text-green-600' : health > 40 ? 'text-yellow-600' : 'text-red-600'}">${health}%</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span>Felicidad:</span>
                            <span class="${happiness > 70 ? 'text-green-600' : happiness > 40 ? 'text-yellow-600' : 'text-red-600'}">${happiness}%</span>
                        </div>
                    </div>
                    
                    ${pet.type === 'fish' ? '<p class="text-orange-600 text-xs mb-2">‚ö†Ô∏è Requiere pecera instalada</p>' : ''}
                    ${tempRequirement}
                    
                    <button onclick="adoptPet(${pet.id})" class="w-full bg-purple-500 text-white py-2 rounded-lg hover:bg-purple-600 transition duration-200">
                        Adoptar (+${pet.type === 'cat' ? '250' : '100'} ü™ô)
                    </button>
                </div>
            `;
            }).join('');
        }

        function updateVetDisplay() {
            const user = gameState.users[gameState.currentUser];
            const sickPets = user.pets.filter(pet => pet.health < 80);
            const sickContainer = document.getElementById('sickPetsList');
            const noSickMessage = document.getElementById('noSickPets');
            
            if (sickPets.length === 0) {
                sickContainer.innerHTML = '';
                noSickMessage.classList.remove('hidden');
                return;
            }
            
            noSickMessage.classList.add('hidden');
            sickContainer.innerHTML = sickPets.map(pet => `
                <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-4">
                            <span class="text-3xl">${pet.emoji}</span>
                            <div>
                                <h4 class="font-semibold text-gray-800">${pet.name}</h4>
                                <p class="text-sm text-gray-600">Salud: ${pet.health}%</p>
                            </div>
                        </div>
                        <button onclick="treatPet('${pet.id}')" class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600">
                            Tratar (50 ü™ô)
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function updateAdminDisplay() {
            if (!gameState.users[gameState.currentUser].isAdmin) return;
            
            // Update breeds list
            const breedsList = document.getElementById('breedsList');
            breedsList.innerHTML = Object.entries(gameState.breeds).map(([type, breeds]) => `
                <div class="p-3 bg-gray-50 rounded-lg">
                    <h4 class="font-semibold text-gray-800 mb-2">${type === 'cat' ? 'Gatos' : 'Peces'}:</h4>
                    <p class="text-sm text-gray-600">${breeds.join(', ')}</p>
                </div>
            `).join('');
            
            // Update shop items list
            const shopItemsList = document.getElementById('shopItemsList');
            shopItemsList.innerHTML = gameState.shopItems.map(item => `
                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                    <div class="flex items-center space-x-3">
                        <span class="text-xl">${item.emoji}</span>
                        <span class="font-medium">${item.name}</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <span class="text-green-600 font-semibold">${item.price} ü™ô</span>
                        <button onclick="removeShopItem(${item.id})" class="text-red-500 hover:text-red-700">
                            ‚ùå
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Game Actions
        function buyItem(itemId) {
            const user = gameState.users[gameState.currentUser];
            const item = gameState.shopItems.find(i => i.id === itemId);
            
            if (!item) return;
            
            if (user.coins < item.price) {
                alert('No tienes suficientes monedas');
                return;
            }
            
            user.coins -= item.price;
            user.inventory[item.name] = (user.inventory[item.name] || 0) + 1;
            
            updateDisplay();
            updateInventoryDisplay();
            saveGameData();
            
            alert(`¬°Has comprado ${item.name}!`);
        }

        function adoptPet(petId) {
            const user = gameState.users[gameState.currentUser];
            const pet = gameState.availablePets.find(p => p.id === petId);
            
            if (!pet) return;
            
            // Check if user has space for fish
            if (pet.type === 'fish') {
                if (!user.aquariums || user.aquariums.length === 0) {
                    alert('¬°Necesitas instalar una pecera primero! Ve a Acciones R√°pidas ‚Üí Instalar Pecera.');
                    return;
                }
                
                // Check if there's a compatible aquarium (temperature match)
                const compatibleAquariums = user.aquariums.filter(aq => {
                    const fishInAquarium = user.pets.filter(p => p.aquariumId === aq.id).length;
                    return fishInAquarium < aq.capacity && aq.temperature === pet.temperature;
                });
                
                if (compatibleAquariums.length === 0) {
                    const tempText = pet.temperature === 'warm' ? 'caliente' : 'fr√≠a';
                    alert(`¬°Este pez necesita agua ${tempText}! Necesitas una pecera ${tempText} con espacio disponible.`);
                    return;
                }
            }
            
            const reward = pet.type === 'cat' ? 250 : 100;
            
            // Add pet to user's collection
            const newPet = {
                ...pet,
                id: Date.now().toString(),
                adoptedAt: gameState.gameTime
            };
            
            // If it's a fish, assign to a compatible aquarium
            if (pet.type === 'fish') {
                const compatibleAquarium = user.aquariums.find(aq => {
                    const fishInAquarium = user.pets.filter(p => p.aquariumId === aq.id).length;
                    return fishInAquarium < aq.capacity && aq.temperature === pet.temperature;
                });
                newPet.aquariumId = compatibleAquarium.id;
            }
            
            user.pets.push(newPet);
            user.coins += reward;
            
            // Remove from available pets
            gameState.availablePets = gameState.availablePets.filter(p => p.id !== petId);
            
            updateDisplay();
            updateShelterDisplay();
            updatePetsDisplay();
            saveGameData();
            
            alert(`¬°Has adoptado a ${pet.name}! Recibes ${reward} monedas de recompensa.`);
        }

        function treatPet(petId) {
            const user = gameState.users[gameState.currentUser];
            
            if (user.coins < 50) {
                alert('No tienes suficientes monedas para el tratamiento');
                return;
            }
            
            const pet = user.pets.find(p => p.id === petId);
            if (!pet) return;
            
            user.coins -= 50;
            pet.health = Math.min(100, pet.health + 30);
            
            updateDisplay();
            updateVetDisplay();
            updatePetsDisplay();
            
            alert(`${pet.name} ha sido tratado y se siente mejor!`);
        }

        function takeTransport(line) {
            const user = gameState.users[gameState.currentUser];
            
            if (user.coins < 15) {
                alert('No tienes suficientes monedas para el transporte');
                return;
            }
            
            user.coins -= 15;
            updateDisplay();
            
            const routes = {
                'C1': 'Casa ‚Üí Tienda ‚Üí Veterinario ‚Üí Casa',
                '5A': 'Casa ‚Üí Tienda ‚Üí Casa',
                '15C': 'Casa ‚Üí Protectora ‚Üí Tienda ‚Üí Protectora ‚Üí Casa',
                '28': 'Casa ‚Üí Veterinario ‚Üí Casa'
            };
            
            alert(`¬°Viajando en la l√≠nea ${line}!\nRuta: ${routes[line]}`);
        }

        function addBreed() {
            const type = document.getElementById('newPetType').value;
            const breedName = document.getElementById('newBreedName').value.trim();
            
            if (!breedName) {
                alert('Ingresa el nombre de la raza');
                return;
            }
            
            if (!gameState.breeds[type].includes(breedName)) {
                gameState.breeds[type].push(breedName);
                document.getElementById('newBreedName').value = '';
                updateAdminDisplay();
                alert(`Raza ${breedName} agregada exitosamente`);
            } else {
                alert('Esta raza ya existe');
            }
        }

        function addShopItem() {
            const name = document.getElementById('newItemName').value.trim();
            const price = parseInt(document.getElementById('newItemPrice').value);
            const category = document.getElementById('newItemCategory').value;
            
            if (!name || !price) {
                alert('Completa todos los campos');
                return;
            }
            
            const emojis = {
                food: 'ü•´',
                toy: 'üß∏',
                accessory: 'üéÄ',
                medicine: 'üíä'
            };
            
            const newItem = {
                id: Date.now(),
                name: name,
                price: price,
                category: category,
                emoji: emojis[category]
            };
            
            gameState.shopItems.push(newItem);
            
            // Clear form
            document.getElementById('newItemName').value = '';
            document.getElementById('newItemPrice').value = '';
            
            updateAdminDisplay();
            alert(`Producto ${name} agregado exitosamente`);
        }

        function removeShopItem(itemId) {
            if (confirm('¬øEst√°s seguro de eliminar este producto?')) {
                gameState.shopItems = gameState.shopItems.filter(item => item.id !== itemId);
                updateAdminDisplay();
            }
        }

        function addRandomPetToShelter() {
            // Ensure equal distribution of cats and fish
            const currentCats = gameState.availablePets.filter(pet => pet.type === 'cat').length;
            const currentFish = gameState.availablePets.filter(pet => pet.type === 'fish').length;
            
            let type;
            if (currentCats > currentFish) {
                type = 'fish';
            } else if (currentFish > currentCats) {
                type = 'cat';
            } else {
                // Equal amounts, choose randomly
                type = Math.random() < 0.5 ? 'cat' : 'fish';
            }
            
            let breed, breedData;
            if (type === 'cat') {
                breedData = gameState.breeds.cat;
                breed = breedData[Math.floor(Math.random() * breedData.length)];
            } else {
                // For fish, combine all breeds to ensure equal representation
                const allFishBreeds = [...gameState.breeds.fish.coldWater, ...gameState.breeds.fish.warmWater];
                breed = allFishBreeds[Math.floor(Math.random() * allFishBreeds.length)];
            }
            
            const gender = Math.random() < 0.5 ? 'male' : 'female';
            const names = gameState.petNames[type][gender];
            const name = names[Math.floor(Math.random() * names.length)];
            const color = breed.colors[Math.floor(Math.random() * breed.colors.length)];
            
            const newPet = {
                id: Date.now() + Math.random(),
                name: name,
                type: type,
                breed: breed.name,
                color: color,
                gender: gender,
                emoji: breed.emoji,
                temperature: breed.temperature, // Always include temperature for fish
                age: Math.round((Math.random() * 24 + 1) * 10) / 10, // 0.1 to 24 months
                health: Math.round((Math.random() * 30 + 70) * 10) / 10, // 70-100%
                happiness: Math.round((Math.random() * 40 + 60) * 10) / 10 // 60-100%
            };
            
            gameState.availablePets.push(newPet);
            saveGameData();
        }

        function setupAquarium() {
            const user = gameState.users[gameState.currentUser];
            
            // Check available aquariums in inventory
            const availableAquariums = gameState.shopItems.filter(item => 
                item.category === 'aquarium' && user.inventory[item.name] > 0
            );
            
            if (availableAquariums.length === 0) {
                alert('¬°No tienes peceras en tu inventario! Compra una en la tienda primero.');
                return;
            }
            
            // Show selection modal
            const aquariumOptions = availableAquariums.map(aq => 
                `<button onclick="installAquarium('${aq.name}')" class="w-full bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 mb-2">
                    ${aq.emoji} ${aq.name} (Capacidad: ${aq.capacity} peces)
                </button>`
            ).join('');
            
            const modal = document.getElementById('petModal');
            const content = document.getElementById('petModalContent');
            
            content.innerHTML = `
                <div class="text-center">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">üè† Instalar Pecera</h2>
                    <p class="text-gray-600 mb-6">Selecciona qu√© pecera quieres instalar:</p>
                    
                    <div class="space-y-3">
                        ${aquariumOptions}
                    </div>
                    
                    <button onclick="closeModal()" class="w-full bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 mt-4">
                        Cancelar
                    </button>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        function installAquarium(aquariumName) {
            const user = gameState.users[gameState.currentUser];
            const aquariumItem = gameState.shopItems.find(item => item.name === aquariumName);
            
            if (!aquariumItem || !user.inventory[aquariumName] || user.inventory[aquariumName] <= 0) {
                return;
            }
            
            // Initialize aquariums array if it doesn't exist
            if (!user.aquariums) {
                user.aquariums = [];
            }
            
            // Create new aquarium
            const newAquarium = {
                id: Date.now().toString(),
                name: aquariumName,
                emoji: aquariumItem.emoji,
                capacity: aquariumItem.capacity,
                temperature: aquariumItem.temperature,
                decorations: [],
                installedAt: gameState.gameTime
            };
            
            user.aquariums.push(newAquarium);
            user.inventory[aquariumName]--;
            
            updateDisplay();
            updatePetsDisplay();
            updateInventoryDisplay();
            saveGameData();
            closeModal();
            
            alert(`¬°Pecera ${aquariumName} instalada correctamente!`);
        }

        function removeAquarium(aquariumId) {
            const user = gameState.users[gameState.currentUser];
            const aquarium = user.aquariums.find(aq => aq.id === aquariumId);
            
            if (!aquarium) return;
            
            // Check if aquarium has fish
            const fishInAquarium = user.pets.filter(pet => pet.aquariumId === aquariumId);
            
            if (fishInAquarium.length > 0) {
                alert('¬°No puedes quitar una pecera que tiene peces! Mueve los peces primero.');
                return;
            }
            
            if (confirm(`¬øEst√°s seguro de quitar la ${aquarium.name}?`)) {
                // Return aquarium to inventory
                user.inventory[aquarium.name] = (user.inventory[aquarium.name] || 0) + 1;
                
                // Remove aquarium
                user.aquariums = user.aquariums.filter(aq => aq.id !== aquariumId);
                
                updateDisplay();
                updatePetsDisplay();
                updateInventoryDisplay();
                saveGameData();
                
                alert(`${aquarium.name} devuelta al inventario.`);
            }
        }

        function addFishToAquarium(aquariumId) {
            showSection('shelter');
            alert('Ve a la protectora para adoptar peces. Se asignar√°n autom√°ticamente a esta pecera si hay espacio.');
        }

        function setupCatAccessory() {
            const user = gameState.users[gameState.currentUser];
            
            // Check available cat accessories in inventory
            const availableAccessories = gameState.shopItems.filter(item => 
                item.category === 'catAccessory' && user.inventory[item.name] > 0
            );
            
            if (availableAccessories.length === 0) {
                alert('¬°No tienes accesorios para gatos en tu inventario! Compra algunos en la tienda primero.');
                return;
            }
            
            // Show selection modal
            const accessoryOptions = availableAccessories.map(acc => 
                `<button onclick="installCatAccessory('${acc.name}')" class="w-full bg-orange-500 text-white py-2 px-4 rounded-lg hover:bg-orange-600 mb-2">
                    ${acc.emoji} ${acc.name}
                </button>`
            ).join('');
            
            const modal = document.getElementById('petModal');
            const content = document.getElementById('petModalContent');
            
            content.innerHTML = `
                <div class="text-center">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">üê± Instalar Accesorio</h2>
                    <p class="text-gray-600 mb-6">Selecciona qu√© accesorio quieres instalar:</p>
                    
                    <div class="space-y-3">
                        ${accessoryOptions}
                    </div>
                    
                    <button onclick="closeModal()" class="w-full bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 mt-4">
                        Cancelar
                    </button>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        function installCatAccessory(accessoryName) {
            const user = gameState.users[gameState.currentUser];
            const accessoryItem = gameState.shopItems.find(item => item.name === accessoryName);
            
            if (!accessoryItem || !user.inventory[accessoryName] || user.inventory[accessoryName] <= 0) {
                return;
            }
            
            // Initialize catAccessories array if it doesn't exist
            if (!user.catAccessories) {
                user.catAccessories = [];
            }
            
            // Create new accessory
            const newAccessory = {
                id: Date.now().toString(),
                name: accessoryName,
                emoji: accessoryItem.emoji,
                installedAt: gameState.gameTime
            };
            
            user.catAccessories.push(newAccessory);
            user.inventory[accessoryName]--;
            
            updateDisplay();
            updatePetsDisplay();
            updateInventoryDisplay();
            saveGameData();
            closeModal();
            
            alert(`¬°${accessoryName} instalado correctamente!`);
        }

        function removeCatAccessory(accessoryId) {
            const user = gameState.users[gameState.currentUser];
            const accessory = user.catAccessories.find(acc => acc.id === accessoryId);
            
            if (!accessory) return;
            
            if (confirm(`¬øEst√°s seguro de quitar ${accessory.name}?`)) {
                // Return accessory to inventory
                user.inventory[accessory.name] = (user.inventory[accessory.name] || 0) + 1;
                
                // Remove accessory
                user.catAccessories = user.catAccessories.filter(acc => acc.id !== accessoryId);
                
                updateDisplay();
                updatePetsDisplay();
                updateInventoryDisplay();
                saveGameData();
                
                alert(`${accessory.name} devuelto al inventario.`);
            }
        }

        function decorateAquarium(aquariumId) {
            const user = gameState.users[gameState.currentUser];
            const aquarium = user.aquariums.find(aq => aq.id === aquariumId);
            
            if (!aquarium) return;
            
            // Check available decorations in inventory
            const availableDecorations = gameState.shopItems.filter(item => 
                item.category === 'decoration' && user.inventory[item.name] > 0
            );
            
            if (availableDecorations.length === 0) {
                alert('¬°No tienes decoraciones en tu inventario! Compra algunas en la tienda primero.');
                return;
            }
            
            // Show selection modal
            const decorationOptions = availableDecorations.map(dec => 
                `<button onclick="addDecoration('${aquariumId}', '${dec.name}')" class="w-full bg-green-500 text-white py-2 px-4 rounded-lg hover:bg-green-600 mb-2">
                    ${dec.emoji} ${dec.name}
                </button>`
            ).join('');
            
            const currentDecorations = aquarium.decorations && aquarium.decorations.length > 0 ? 
                `<div class="mb-4">
                    <h4 class="font-medium mb-2">Decoraciones actuales:</h4>
                    <div class="flex flex-wrap gap-2">
                        ${aquarium.decorations.map(dec => `
                            <button onclick="removeDecoration('${aquariumId}', '${dec}')" class="bg-red-100 text-red-700 px-2 py-1 rounded text-sm hover:bg-red-200">
                                ${gameState.shopItems.find(item => item.name === dec)?.emoji || 'üé®'} ${dec} ‚ùå
                            </button>
                        `).join('')}
                    </div>
                </div>` : '';
            
            const modal = document.getElementById('petModal');
            const content = document.getElementById('petModalContent');
            
            content.innerHTML = `
                <div class="text-center">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">üé® Decorar Pecera</h2>
                    <p class="text-gray-600 mb-4">${aquarium.name}</p>
                    
                    ${currentDecorations}
                    
                    <h4 class="font-medium mb-2">Agregar decoraci√≥n:</h4>
                    <div class="space-y-3 mb-4">
                        ${decorationOptions}
                    </div>
                    
                    <button onclick="closeModal()" class="w-full bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600">
                        Cerrar
                    </button>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        function addDecoration(aquariumId, decorationName) {
            const user = gameState.users[gameState.currentUser];
            const aquarium = user.aquariums.find(aq => aq.id === aquariumId);
            
            if (!aquarium || !user.inventory[decorationName] || user.inventory[decorationName] <= 0) {
                return;
            }
            
            // Initialize decorations array if it doesn't exist
            if (!aquarium.decorations) {
                aquarium.decorations = [];
            }
            
            // Check if decoration already exists
            if (aquarium.decorations.includes(decorationName)) {
                alert('Esta decoraci√≥n ya est√° en la pecera.');
                return;
            }
            
            // Add decoration
            aquarium.decorations.push(decorationName);
            user.inventory[decorationName]--;
            
            updateDisplay();
            updatePetsDisplay();
            updateInventoryDisplay();
            saveGameData();
            
            alert(`¬°${decorationName} agregado a la pecera!`);
            
            // Refresh the modal
            decorateAquarium(aquariumId);
        }

        function removeDecoration(aquariumId, decorationName) {
            const user = gameState.users[gameState.currentUser];
            const aquarium = user.aquariums.find(aq => aq.id === aquariumId);
            
            if (!aquarium) return;
            
            // Remove decoration and return to inventory
            aquarium.decorations = aquarium.decorations.filter(dec => dec !== decorationName);
            user.inventory[decorationName] = (user.inventory[decorationName] || 0) + 1;
            
            updateDisplay();
            updatePetsDisplay();
            updateInventoryDisplay();
            saveGameData();
            
            alert(`${decorationName} devuelto al inventario.`);
            
            // Refresh the modal
            decorateAquarium(aquariumId);
        }

        function feedAllPets() {
            const user = gameState.users[gameState.currentUser];
            
            const cats = user.pets.filter(pet => pet.type === 'cat');
            const fish = user.pets.filter(pet => pet.type === 'fish');
            
            const catFoodNeeded = cats.length;
            const fishFoodNeeded = fish.length;
            
            const catFoodAvailable = user.inventory['Comida para gatos'] || 0;
            const fishFoodAvailable = user.inventory['Comida para peces'] || 0;
            
            if (catFoodNeeded > catFoodAvailable || fishFoodNeeded > fishFoodAvailable) {
                alert(`No tienes suficiente comida. Necesitas: ${catFoodNeeded} comida para gatos y ${fishFoodNeeded} comida para peces.`);
                return;
            }
            
            // Feed all pets
            cats.forEach(pet => {
                pet.health = Math.min(100, pet.health + 15);
                pet.happiness = Math.min(100, pet.happiness + 10);
            });
            
            fish.forEach(pet => {
                pet.health = Math.min(100, pet.health + 15);
                pet.happiness = Math.min(100, pet.happiness + 10);
            });
            
            // Consume food
            user.inventory['Comida para gatos'] -= catFoodNeeded;
            user.inventory['Comida para peces'] -= fishFoodNeeded;
            
            updateDisplay();
            updatePetsDisplay();
            updateInventoryDisplay();
            saveGameData();
            
            alert(`¬°Todas las mascotas han sido alimentadas! (${cats.length} gatos, ${fish.length} peces)`);
        }

        function showPetDetails(petId) {
            const user = gameState.users[gameState.currentUser];
            const pet = user.pets.find(p => p.id === petId);
            
            if (!pet) return;
            
            const modal = document.getElementById('petModal');
            const content = document.getElementById('petModalContent');
            
            const health = Math.round(pet.health * 10) / 10;
            const happiness = Math.round(pet.happiness * 10) / 10;
            const age = Math.round(pet.age * 10) / 10;
            
            // Check available collars
            const availableCollars = gameState.shopItems.filter(item => 
                item.category === 'collar' && user.inventory[item.name] > 0
            );
            
            // Check available medicines
            const availableMedicines = gameState.shopItems.filter(item => 
                item.category === 'medicine' && user.inventory[item.name] > 0
            );
            
            const breedData = gameState.breeds[pet.type].find(b => b.name === pet.breed);
            
            content.innerHTML = `
                <div class="text-center">
                    <div class="w-32 h-32 mx-auto mb-4 rounded-full overflow-hidden bg-gray-200 border-4 border-blue-300">
                        <img src="${breedData?.photo || ''}" alt="${pet.name}" class="w-full h-full object-cover" 
                             onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                        <div class="text-8xl pt-8 hidden">${pet.emoji}</div>
                    </div>
                    ${breedData?.photo ? `<p class="text-xs text-gray-500 mb-2">üì∏ Foto de la raza ${pet.breed}</p>` : ''}
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">${pet.name}</h2>
                    <p class="text-gray-600 mb-1">${pet.gender === 'male' ? '‚ôÇÔ∏è Macho' : '‚ôÄÔ∏è Hembra'} ${pet.breed}</p>
                    <p class="text-gray-500 mb-4">${pet.color} ‚Ä¢ ${age} ${age === 1 ? 'mes' : 'meses'}</p>
                    ${pet.collar ? `<p class="text-purple-600 text-sm mb-4">üéÄ Lleva: ${pet.collar}</p>` : ''}
                    ${pet.type === 'fish' && pet.aquariumId ? `<p class="text-blue-600 text-sm mb-4">üè† En pecera</p>` : ''}
                    
                    <div class="space-y-4 mb-6">
                        <div class="flex items-center justify-between">
                            <span class="font-medium">Salud:</span>
                            <div class="flex items-center space-x-2">
                                <div class="w-32 bg-gray-200 rounded-full h-3">
                                    <div class="bg-${health > 70 ? 'green' : health > 40 ? 'yellow' : 'red'}-500 h-3 rounded-full" style="width: ${health}%"></div>
                                </div>
                                <span class="font-bold">${health}%</span>
                            </div>
                        </div>
                        
                        <div class="flex items-center justify-between">
                            <span class="font-medium">Felicidad:</span>
                            <div class="flex items-center space-x-2">
                                <div class="w-32 bg-gray-200 rounded-full h-3">
                                    <div class="bg-${happiness > 70 ? 'green' : happiness > 40 ? 'yellow' : 'red'}-500 h-3 rounded-full" style="width: ${happiness}%"></div>
                                </div>
                                <span class="font-bold">${happiness}%</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-3 mb-4">
                        <button onclick="feedPet('${pet.id}')" class="bg-green-500 text-white py-2 px-4 rounded-lg hover:bg-green-600">
                            ü•´ Alimentar
                        </button>
                        <button onclick="playWithPet('${pet.id}')" class="bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600">
                            üéæ Jugar
                        </button>
                    </div>
                    
                    ${pet.type === 'cat' && availableCollars.length > 0 ? `
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">Poner Collar:</h4>
                            <div class="grid grid-cols-2 gap-2">
                                ${availableCollars.map(collar => `
                                    <button onclick="putCollar('${pet.id}', '${collar.name}')" class="bg-purple-500 text-white py-1 px-2 rounded text-sm hover:bg-purple-600">
                                        ${collar.emoji} ${collar.name}
                                    </button>
                                `).join('')}
                            </div>
                        </div>
                    ` : ''}
                    
                    ${availableMedicines.length > 0 ? `
                        <div class="mb-4">
                            <h4 class="font-medium mb-2">Tratar en Casa:</h4>
                            <div class="grid grid-cols-2 gap-2">
                                ${availableMedicines.filter(medicine => {
                                    // Cats can use all medicines
                                    if (pet.type === 'cat') return true;
                                    // Fish can only use vitamins and some specific treatments
                                    if (pet.type === 'fish') return medicine.name === 'Vitaminas' || medicine.name === 'Antiparasitario';
                                    return false;
                                }).map(medicine => `
                                    <button onclick="treatPetAtHome('${pet.id}', '${medicine.name}')" class="bg-red-500 text-white py-1 px-2 rounded text-sm hover:bg-red-600">
                                        ${medicine.emoji} ${medicine.name}
                                    </button>
                                `).join('')}
                            </div>
                            ${pet.type === 'cat' ? '<p class="text-xs text-gray-500 mt-1">üê± Los gatos pueden usar todas las medicinas</p>' : ''}
                            ${pet.type === 'fish' ? '<p class="text-xs text-gray-500 mt-1">üê† Los peces solo pueden usar vitaminas y antiparasitarios</p>' : ''}
                        </div>
                    ` : ''}
                    
                    <button onclick="closeModal()" class="w-full bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600">
                        Cerrar
                    </button>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        function feedPet(petId) {
            const user = gameState.users[gameState.currentUser];
            const pet = user.pets.find(p => p.id === petId);
            
            if (!pet) return;
            
            const foodType = pet.type === 'cat' ? 'Comida para gatos' : 'Comida para peces';
            
            if (!user.inventory[foodType] || user.inventory[foodType] <= 0) {
                alert(`No tienes ${foodType.toLowerCase()}`);
                return;
            }
            
            user.inventory[foodType]--;
            pet.health = Math.min(100, pet.health + 15);
            pet.happiness = Math.min(100, pet.happiness + 10);
            
            updateDisplay();
            updatePetsDisplay();
            updateInventoryDisplay();
            closeModal();
            
            alert(`${pet.name} ha comido y se siente mejor!`);
        }

        function playWithPet(petId) {
            const user = gameState.users[gameState.currentUser];
            const pet = user.pets.find(p => p.id === petId);
            
            if (!pet) return;
            
            pet.happiness = Math.min(100, pet.happiness + 20);
            pet.health = Math.max(0, pet.health - 5); // Playing uses some energy
            
            updateDisplay();
            updatePetsDisplay();
            saveGameData();
            closeModal();
            
            alert(`¬°${pet.name} se divirti√≥ mucho jugando contigo!`);
        }

        function putCollar(petId, collarName) {
            const user = gameState.users[gameState.currentUser];
            const pet = user.pets.find(p => p.id === petId);
            
            if (!pet || !user.inventory[collarName] || user.inventory[collarName] <= 0) return;
            
            // Remove old collar if exists
            if (pet.collar) {
                user.inventory[pet.collar] = (user.inventory[pet.collar] || 0) + 1;
            }
            
            // Put new collar
            user.inventory[collarName]--;
            pet.collar = collarName;
            pet.happiness = Math.min(100, pet.happiness + 10);
            
            updateDisplay();
            updatePetsDisplay();
            updateInventoryDisplay();
            saveGameData();
            closeModal();
            
            alert(`¬°${pet.name} ahora lleva ${collarName}!`);
        }

        function treatPetAtHome(petId, medicineName) {
            const user = gameState.users[gameState.currentUser];
            const pet = user.pets.find(p => p.id === petId);
            
            if (!pet || !user.inventory[medicineName] || user.inventory[medicineName] <= 0) return;
            
            user.inventory[medicineName]--;
            
            // Different medicines have different effects
            let healthBoost = 15;
            if (medicineName === 'Vacuna completa') healthBoost = 25;
            if (medicineName === 'Antibi√≥tico') healthBoost = 30;
            if (medicineName === 'Vitaminas') healthBoost = 20;
            if (medicineName === 'Antiparasitario') healthBoost = 18;
            
            pet.health = Math.min(100, pet.health + healthBoost);
            
            updateDisplay();
            updatePetsDisplay();
            updateInventoryDisplay();
            saveGameData();
            closeModal();
            
            alert(`¬°${pet.name} ha sido tratado con ${medicineName} y se siente mejor!`);
        }

        function closeModal() {
            document.getElementById('petModal').classList.add('hidden');
        }

        // Game Time System
        function startGameTime() {
            setInterval(() => {
                // Advance time every 10 seconds (1 game hour)
                advanceGameTime();
                updatePetStats();
                updateDisplay();
                
                // Add new pets to shelter occasionally
                if (Math.random() < 0.3) { // 30% chance every hour
                    addRandomPetToShelter();
                }
                
                saveGameData();
            }, 10000); // 10 seconds = 1 game hour
        }

        function advanceGameTime() {
            gameState.gameTime.hour++;
            
            if (gameState.gameTime.hour > 23) {
                gameState.gameTime.hour = 0;
                gameState.gameTime.day++;
                
                if (gameState.gameTime.day > 30) { // 30 days = 1 month
                    gameState.gameTime.day = 1;
                    gameState.gameTime.month++;
                    
                    if (gameState.gameTime.month > 12) {
                        gameState.gameTime.month = 1;
                        gameState.gameTime.year++;
                    }
                }
            }
        }

        function updatePetStats() {
            // Update all pets' stats over time
            Object.values(gameState.users).forEach(user => {
                user.pets.forEach(pet => {
                    // Pets get hungrier and less happy over time
                    pet.health = Math.max(0, pet.health - Math.random() * 5);
                    pet.happiness = Math.max(0, pet.happiness - Math.random() * 8);
                    
                    // Age pets
                    pet.age += 0.2; // Approximate aging
                    
                    // Random events
                    if (Math.random() < 0.1) { // 10% chance
                        if (Math.random() < 0.5) {
                            pet.health = Math.max(20, pet.health - 20);
                            console.log(`${pet.name} got sick!`);
                        }
                    }
                });
            });
            
            if (gameState.currentUser) {
                updatePetsDisplay();
            }
        }

        // Work System Functions
        function updateWorkDisplay() {
            const user = gameState.users[gameState.currentUser];
            updateActiveJobsDisplay();
            updateJobButtons();
        }

        function updateActiveJobsDisplay() {
            const user = gameState.users[gameState.currentUser];
            const container = document.getElementById('activeJobsList');
            const noJobsMessage = document.getElementById('noActiveJobs');
            
            if (!user.activeJobs || user.activeJobs.length === 0) {
                container.innerHTML = '';
                noJobsMessage.classList.remove('hidden');
                return;
            }
            
            noJobsMessage.classList.add('hidden');
            container.innerHTML = user.activeJobs.map(job => {
                const timeLeft = Math.max(0, job.endTime - Date.now());
                const hoursLeft = Math.floor(timeLeft / (1000 * 60 * 60));
                const minutesLeft = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
                
                return `
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-4">
                            <span class="text-3xl">${getJobEmoji(job.type)}</span>
                            <div>
                                <h4 class="font-semibold text-gray-800">${getJobName(job.type)}</h4>
                                <p class="text-sm text-gray-600">Pago esperado: ${job.payment} monedas</p>
                                <p class="text-sm text-blue-600">
                                    ${timeLeft > 0 ? `Tiempo restante: ${hoursLeft}h ${minutesLeft}m` : '¬°Completado!'}
                                </p>
                            </div>
                        </div>
                        ${timeLeft <= 0 ? `
                            <button onclick="completeJob('${job.id}')" class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600">
                                Cobrar
                            </button>
                        ` : `
                            <button onclick="cancelJob('${job.id}')" class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600">
                                Cancelar
                            </button>
                        `}
                    </div>
                </div>
            `;
            }).join('');
        }

        function updateJobButtons() {
            const user = gameState.users[gameState.currentUser];
            
            // Check if user can do each job
            const petCareBtn = document.getElementById('petCareBtn');
            const vetAssistantBtn = document.getElementById('vetAssistantBtn');
            const trainerBtn = document.getElementById('trainerBtn');
            const beautyContestBtn = document.getElementById('beautyContestBtn');
            
            // Pet care requires at least 1 pet
            if (user.pets.length === 0) {
                petCareBtn.disabled = true;
                petCareBtn.textContent = 'Necesitas mascotas';
                petCareBtn.classList.add('opacity-50', 'cursor-not-allowed');
            }
            
            // Vet assistant requires medicines
            const hasMedicines = Object.keys(user.inventory).some(item => 
                gameState.shopItems.find(shopItem => shopItem.name === item && shopItem.category === 'medicine') && user.inventory[item] > 0
            );
            if (!hasMedicines) {
                vetAssistantBtn.disabled = true;
                vetAssistantBtn.textContent = 'Necesitas medicinas';
                vetAssistantBtn.classList.add('opacity-50', 'cursor-not-allowed');
            }
            
            // Trainer requires 3+ happy pets
            const happyPets = user.pets.filter(pet => pet.happiness > 70).length;
            if (happyPets < 3) {
                trainerBtn.disabled = true;
                trainerBtn.textContent = `Necesitas 3+ mascotas felices (${happyPets}/3)`;
                trainerBtn.classList.add('opacity-50', 'cursor-not-allowed');
            }
            
            // Beauty contest requires pet with collar
            const petsWithCollars = user.pets.filter(pet => pet.collar).length;
            if (petsWithCollars === 0) {
                beautyContestBtn.disabled = true;
                beautyContestBtn.textContent = 'Necesitas mascota con collar';
                beautyContestBtn.classList.add('opacity-50', 'cursor-not-allowed');
            }
        }

        function startJob(jobType) {
            const user = gameState.users[gameState.currentUser];
            
            // Check if already working this job
            if (user.activeJobs.some(job => job.type === jobType)) {
                alert('Ya est√°s trabajando en este empleo');
                return;
            }
            
            const jobData = getJobData(jobType);
            if (!jobData) return;
            
            // Check requirements
            if (!checkJobRequirements(jobType)) {
                return;
            }
            
            const newJob = {
                id: Date.now().toString(),
                type: jobType,
                startTime: Date.now(),
                endTime: Date.now() + (jobData.duration * 60 * 60 * 1000), // Convert hours to milliseconds
                payment: Math.floor(Math.random() * (jobData.maxPay - jobData.minPay + 1)) + jobData.minPay
            };
            
            user.activeJobs.push(newJob);
            updateWorkDisplay();
            saveGameData();
            
            alert(`¬°Has comenzado a trabajar como ${getJobName(jobType)}! Vuelve en ${jobData.duration} horas para cobrar.`);
        }

        function completeJob(jobId) {
            const user = gameState.users[gameState.currentUser];
            const job = user.activeJobs.find(j => j.id === jobId);
            
            if (!job) return;
            
            user.coins += job.payment;
            user.activeJobs = user.activeJobs.filter(j => j.id !== jobId);
            
            updateDisplay();
            updateWorkDisplay();
            saveGameData();
            
            alert(`¬°Trabajo completado! Has ganado ${job.payment} monedas.`);
        }

        function cancelJob(jobId) {
            const user = gameState.users[gameState.currentUser];
            
            if (confirm('¬øEst√°s seguro de cancelar este trabajo? No recibir√°s pago.')) {
                user.activeJobs = user.activeJobs.filter(j => j.id !== jobId);
                updateWorkDisplay();
                saveGameData();
            }
        }

        function startBreeding(petType) {
            const user = gameState.users[gameState.currentUser];
            const cost = petType === 'cat' ? 200 : 100;
            
            if (user.coins < cost) {
                alert(`No tienes suficientes monedas. Necesitas ${cost} monedas.`);
                return;
            }
            
            const availablePets = user.pets.filter(pet => 
                pet.type === petType && 
                pet.age >= 6 && // At least 6 months old
                !user.breedingProjects.some(project => project.parents.includes(pet.id))
            );
            
            if (availablePets.length < 2) {
                alert(`Necesitas al menos 2 ${petType === 'cat' ? 'gatos' : 'peces'} adultos (6+ meses) para criar.`);
                return;
            }
            
            // For fish, they need to be same breed
            if (petType === 'fish') {
                const breeds = [...new Set(availablePets.map(pet => pet.breed))];
                if (breeds.length === 0) {
                    alert('Necesitas al menos 2 peces de la misma especie para criar.');
                    return;
                }
            }
            
            user.coins -= cost;
            
            const duration = petType === 'cat' ? 12 : 6; // hours
            const offspring = petType === 'cat' ? Math.floor(Math.random() * 4) + 1 : Math.floor(Math.random() * 6) + 3;
            
            const breedingProject = {
                id: Date.now().toString(),
                type: petType,
                parents: [availablePets[0].id, availablePets[1].id],
                startTime: Date.now(),
                endTime: Date.now() + (duration * 60 * 60 * 1000),
                expectedOffspring: offspring
            };
            
            user.breedingProjects.push(breedingProject);
            updateDisplay();
            saveGameData();
            
            alert(`¬°Proyecto de cr√≠a iniciado! En ${duration} horas tendr√°s ${offspring} ${petType === 'cat' ? 'gatitos' : 'alevines'}.`);
        }

        function getJobData(jobType) {
            const jobs = {
                petCare: { duration: 2, minPay: 80, maxPay: 120 },
                shopKeeper: { duration: 3, minPay: 60, maxPay: 100 },
                delivery: { duration: 1, minPay: 100, maxPay: 150 },
                vetAssistant: { duration: 4, minPay: 120, maxPay: 180 },
                trainer: { duration: 6, minPay: 200, maxPay: 300 },
                beautyContest: { duration: 8, minPay: 500, maxPay: 1000 }
            };
            return jobs[jobType];
        }

        function getJobName(jobType) {
            const names = {
                petCare: 'Cuidador de Mascotas',
                shopKeeper: 'Vendedor de Tienda',
                delivery: 'Repartidor',
                vetAssistant: 'Asistente Veterinario',
                trainer: 'Entrenador de Shows',
                beautyContest: 'Concurso de Belleza'
            };
            return names[jobType];
        }

        function getJobEmoji(jobType) {
            const emojis = {
                petCare: 'üêæ',
                shopKeeper: 'üè™',
                delivery: 'üöö',
                vetAssistant: 'üè•',
                trainer: 'üé™',
                beautyContest: 'üèÜ'
            };
            return emojis[jobType];
        }

        function checkJobRequirements(jobType) {
            const user = gameState.users[gameState.currentUser];
            
            switch(jobType) {
                case 'petCare':
                    if (user.pets.length === 0) {
                        alert('Necesitas tener al menos 1 mascota para este trabajo.');
                        return false;
                    }
                    break;
                case 'vetAssistant':
                    const hasMedicines = Object.keys(user.inventory).some(item => 
                        gameState.shopItems.find(shopItem => shopItem.name === item && shopItem.category === 'medicine') && user.inventory[item] > 0
                    );
                    if (!hasMedicines) {
                        alert('Necesitas tener medicinas en tu inventario para este trabajo.');
                        return false;
                    }
                    break;
                case 'trainer':
                    const happyPets = user.pets.filter(pet => pet.happiness > 70).length;
                    if (happyPets < 3) {
                        alert(`Necesitas al menos 3 mascotas felices (>70% felicidad). Tienes ${happyPets}.`);
                        return false;
                    }
                    break;
                case 'beautyContest':
                    const petsWithCollars = user.pets.filter(pet => pet.collar).length;
                    if (petsWithCollars === 0) {
                        alert('Necesitas al menos una mascota con collar para participar.');
                        return false;
                    }
                    break;
            }
            return true;
        }

        // Click outside modal to close
        document.getElementById('petModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        document.getElementById('createAccountModal').addEventListener('click', function(e) {
            if (e.target === this) {
                hideCreateAccountModal();
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9bd6b4e5867033db',t:'MTc2ODMyNjMxOS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
