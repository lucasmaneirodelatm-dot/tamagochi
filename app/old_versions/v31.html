<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gatos y Peces v21 - Juego Virtual</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Poppins', sans-serif; }
        .pet-card { transition: all 0.3s ease; }
        .pet-card:hover { transform: translateY(-5px); }
        .modal { backdrop-filter: blur(10px); }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .shop-item { transition: all 0.2s ease; }
        .shop-item:hover { transform: scale(1.05); }
        .baby-pet { animation: bounce 2s infinite; }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- Login Screen -->
    <div id="loginScreen" class="min-h-screen gradient-bg flex items-center justify-center">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md">
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold text-gray-800 mb-2">ğŸ± Gatos y Peces v21 ğŸ </h1>
                <p class="text-gray-600">Perros prÃ³ximamente</p>
                <p class="text-sm text-blue-600 mt-2">âœ¨ Nuevo: Sistema de camadas y descendencia</p>
            </div>
            
            <form id="loginForm" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Usuario</label>
                    <input type="text" id="username" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Ingresa tu usuario">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ContraseÃ±a</label>
                    <input type="password" id="password" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="GAME-****">
                </div>
                
                <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition duration-200">
                    Iniciar SesiÃ³n
                </button>
            </form>
            
            <div class="mt-6 text-center">
                <div class="mt-4 p-3 bg-blue-50 rounded-lg">
                    <p class="text-sm text-blue-700 font-medium mb-2">ğŸ’¡ Acceso rÃ¡pido:</p>
                    <p class="text-xs text-blue-600">Puedes usar cualquier usuario y contraseÃ±a para crear una cuenta automÃ¡ticamente</p>
                    <p class="text-xs text-blue-600 mt-1">Ejemplo: usuario "jugador1" con contraseÃ±a "GAME-123"</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Game Interface -->
    <div id="gameScreen" class="hidden">
        <!-- Navigation -->
        <nav class="bg-white shadow-lg">
            <div class="max-w-7xl mx-auto px-4">
                <div class="flex justify-between items-center py-4">
                    <div class="flex items-center space-x-4">
                        <h1 class="text-2xl font-bold text-gray-800">ğŸ± Gatos y Peces v21</h1>
                        <span id="userWelcome" class="text-gray-600"></span>
                    </div>
                    
                    <div class="flex items-center space-x-6">
                        <div class="flex items-center space-x-2">
                            <span class="text-yellow-500">ğŸª™</span>
                            <span id="userCoins" class="font-semibold">1000</span>
                            <span class="text-sm text-gray-600">Monedas</span>
                        </div>
                        
                        <div class="flex space-x-2">
                            <button onclick="showSection('home')" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">Casa</button>
                            <button onclick="showSection('shop')" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600">Tienda</button>
                            <button onclick="showSection('shelter')" class="px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600">Protectora</button>
                            <button onclick="showSection('vet')" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600">Veterinario</button>
                            <button onclick="showSection('work')" class="px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600">Trabajos</button>
                            <button onclick="showSection('cemetery')" class="px-3 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700">ğŸª¦</button>
                        </div>
                        
                        <button onclick="logout()" class="text-gray-500 hover:text-gray-700">Salir</button>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Home Section -->
        <div id="homeSection" class="max-w-7xl mx-auto px-4 py-8">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Pets Display -->
                <div class="lg:col-span-2">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">ğŸ± Mis Mascotas</h2>
                    
                    <div id="petsContainer" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- Pets will be dynamically added here -->
                    </div>
                    
                    <div id="noPetsMessage" class="text-center py-8 bg-white rounded-xl shadow-sm">
                        <div class="text-4xl mb-2">ğŸ±</div>
                        <p class="text-gray-500 text-sm">No tienes mascotas</p>
                        <button onclick="showSection('shelter')" class="mt-4 bg-purple-500 text-white px-4 py-2 rounded-lg hover:bg-purple-600">
                            Ir a Protectora
                        </button>
                    </div>
                </div>
                
                <!-- Inventory -->
                <div class="space-y-6">
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">Inventario</h3>
                        <div id="inventoryList" class="space-y-3">
                            <!-- Inventory items will be added here -->
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">Acciones RÃ¡pidas</h3>
                        <div class="space-y-3">
                            <button onclick="feedAllPets()" class="w-full bg-green-500 text-white py-2 rounded-lg hover:bg-green-600 text-sm">
                                ğŸ¥« Alimentar Todos
                            </button>
                            <button onclick="showSection('shelter')" class="w-full bg-purple-500 text-white py-2 rounded-lg hover:bg-purple-600 text-sm">
                                ğŸ  Adoptar Mascota
                            </button>
                            <button onclick="showSection('shop')" class="w-full bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 text-sm">
                                ğŸ›’ Ir a Tienda
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Shop Section -->
        <div id="shopSection" class="hidden max-w-7xl mx-auto px-4 py-8">
            <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">ğŸ›’ Tienda de Mascotas</h2>
            
            <div id="shopContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                <!-- Shop items will be dynamically added -->
            </div>
        </div>

        <!-- Shelter Section -->
        <div id="shelterSection" class="hidden max-w-7xl mx-auto px-4 py-8">
            <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">ğŸ  Protectora de Animales</h2>
            
            <div id="shelterContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Available pets for adoption -->
            </div>
        </div>

        <!-- Veterinarian Section -->
        <div id="vetSection" class="hidden max-w-7xl mx-auto px-4 py-8">
            <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">ğŸ¥ Veterinario Dr. PÃ©rez</h2>
            
            <div class="bg-white rounded-xl shadow-sm p-8 mb-8">
                <div class="text-center mb-8">
                    <div class="text-6xl mb-4">ğŸ‘¨â€âš•ï¸</div>
                    <h3 class="text-2xl font-semibold text-gray-800 mb-2">Dr. PÃ©rez - ClÃ­nica Veterinaria</h3>
                    <p class="text-gray-600">Tratamiento: 50 monedas por mascota</p>
                </div>
                
                <div id="sickPetsList" class="space-y-4">
                    <!-- Sick pets will appear here -->
                </div>
                
                <div id="noSickPets" class="text-center py-8">
                    <p class="text-gray-500">Â¡Todas tus mascotas estÃ¡n sanas! ğŸ‰</p>
                </div>
            </div>
        </div>

        <!-- Cemetery Section -->
        <div id="cemeterySection" class="hidden max-w-7xl mx-auto px-4 py-8">
            <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">ğŸª¦ Cementerio de Mascotas</h2>
            
            <div class="bg-white rounded-xl shadow-sm p-8 mb-8">
                <div class="text-center mb-8">
                    <div class="text-6xl mb-4">ğŸŒˆ</div>
                    <h3 class="text-2xl font-semibold text-gray-800 mb-2">En Memoria de Nuestros Queridos CompaÃ±eros</h3>
                    <p class="text-gray-600">AquÃ­ descansan las mascotas que nos acompaÃ±aron en vida</p>
                </div>
                
                <div id="cemeteryList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Deceased pets will appear here -->
                </div>
                
                <div id="noCemeteryPets" class="text-center py-8">
                    <p class="text-gray-500">Afortunadamente, no has perdido ninguna mascota aÃºn ğŸ™</p>
                </div>
            </div>
        </div>

        <!-- Work Section -->
        <div id="workSection" class="hidden max-w-7xl mx-auto px-4 py-8">
            <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">ğŸ’¼ Centro de Trabajos</h2>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Available Jobs -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Trabajos Disponibles</h3>
                    <div class="space-y-3">
                        <button onclick="startJob('petCare')" class="w-full bg-blue-500 text-white py-3 px-4 rounded-lg hover:bg-blue-600 text-left">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="font-semibold">ğŸ¾ Cuidador de Mascotas</div>
                                    <div class="text-sm opacity-90">100 monedas â€¢ InstantÃ¡neo</div>
                                </div>
                            </div>
                        </button>
                        
                        <button onclick="startJob('shopKeeper')" class="w-full bg-green-500 text-white py-3 px-4 rounded-lg hover:bg-green-600 text-left">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="font-semibold">ğŸª Vendedor de Tienda</div>
                                    <div class="text-sm opacity-90">80 monedas â€¢ InstantÃ¡neo</div>
                                </div>
                            </div>
                        </button>
                        
                        <button onclick="startJob('delivery')" class="w-full bg-purple-500 text-white py-3 px-4 rounded-lg hover:bg-purple-600 text-left">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="font-semibold">ğŸšš Repartidor</div>
                                    <div class="text-sm opacity-90">120 monedas â€¢ InstantÃ¡neo</div>
                                </div>
                            </div>
                        </button>
                    </div>
                </div>
                
                <!-- Breeding Section -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">ğŸ’• Centro de CrÃ­a</h3>
                    <div class="space-y-4">
                        <div class="text-center">
                            <div class="text-4xl mb-2">ğŸ±</div>
                            <h4 class="font-semibold mb-2">CrÃ­a de Gatos</h4>
                            <p class="text-sm text-gray-600 mb-4">Costo: 200 monedas<br>Resultado: 1-4 gatitos</p>
                            <button onclick="startBreeding('cat')" class="bg-orange-500 text-white px-6 py-2 rounded-lg hover:bg-orange-600">
                                Iniciar CrÃ­a
                            </button>
                        </div>
                        
                        <div class="text-center">
                            <div class="text-4xl mb-2">ğŸ </div>
                            <h4 class="font-semibold mb-2">CrÃ­a de Peces</h4>
                            <p class="text-sm text-gray-600 mb-4">Costo: 100 monedas<br>Resultado: 3-8 alevines</p>
                            <button onclick="startBreeding('fish')" class="bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600">
                                Iniciar CrÃ­a
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Pet Details Modal -->
    <div id="petModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4">
            <div id="petModalContent">
                <!-- Pet details will be shown here -->
            </div>
        </div>
    </div>

    <script>
        // Game State
        let gameState = {
            currentUser: null,
            users: {},
            lastMortalityCheck: Date.now(),
            shopItems: [
                // Comida bÃ¡sica
                { id: 1, name: 'Comida para gatos', price: 25, category: 'food', emoji: 'ğŸ¥«' },
                { id: 2, name: 'Comida para peces', price: 15, category: 'food', emoji: 'ğŸŸ' },
                
                // Comida premium
                { id: 31, name: 'Comida premium gatos', price: 45, category: 'food', emoji: 'ğŸ–' },
                { id: 32, name: 'Comida premium peces', price: 35, category: 'food', emoji: 'ğŸ¦' },
                { id: 33, name: 'AtÃºn fresco', price: 60, category: 'food', emoji: 'ğŸŸ' },
                { id: 34, name: 'SalmÃ³n ahumado', price: 80, category: 'food', emoji: 'ğŸ£' },
                { id: 35, name: 'Pollo asado', price: 50, category: 'food', emoji: 'ğŸ—' },
                { id: 36, name: 'Leche especial', price: 30, category: 'food', emoji: 'ğŸ¥›' },
                { id: 37, name: 'Galletas para gatos', price: 20, category: 'food', emoji: 'ğŸª' },
                { id: 38, name: 'Hierba gatera', price: 25, category: 'food', emoji: 'ğŸŒ¿' },
                { id: 39, name: 'Artemia viva', price: 40, category: 'food', emoji: 'ğŸ¦ ' },
                { id: 40, name: 'Larvas de mosquito', price: 35, category: 'food', emoji: 'ğŸª±' },
                { id: 41, name: 'Escamas tropicales', price: 28, category: 'food', emoji: 'ğŸŒº' },
                { id: 42, name: 'Algas marinas', price: 22, category: 'food', emoji: 'ğŸŒŠ' },
                { id: 43, name: 'Dafnias congeladas', price: 32, category: 'food', emoji: 'â„ï¸' },
                { id: 44, name: 'Comida en gel', price: 38, category: 'food', emoji: 'ğŸŸ¢' },
                { id: 45, name: 'Snacks mixtos', price: 35, category: 'food', emoji: 'ğŸ¯' },
                { id: 46, name: 'Comida orgÃ¡nica', price: 55, category: 'food', emoji: 'ğŸ¥¬' },
                { id: 47, name: 'Suplemento vitamÃ­nico', price: 40, category: 'food', emoji: 'ğŸ’Š' },
                { id: 48, name: 'Comida energÃ©tica', price: 65, category: 'food', emoji: 'âš¡' },
                
                // Juguetes
                { id: 3, name: 'Juguete ratÃ³n', price: 30, category: 'toy', emoji: 'ğŸ­' },
                { id: 49, name: 'Pelota de lana', price: 25, category: 'toy', emoji: 'ğŸ§¶' },
                { id: 50, name: 'CaÃ±a de pescar', price: 35, category: 'toy', emoji: 'ğŸ£' },
                { id: 51, name: 'TÃºnel de juego', price: 45, category: 'toy', emoji: 'ğŸŒ€' },
                { id: 52, name: 'LÃ¡ser pointer', price: 40, category: 'toy', emoji: 'ğŸ”´' },
                { id: 53, name: 'Peluche pez', price: 28, category: 'toy', emoji: 'ğŸ§¸' },
                { id: 54, name: 'Cascabel dorado', price: 22, category: 'toy', emoji: 'ğŸ””' },
                { id: 55, name: 'Pluma mÃ¡gica', price: 33, category: 'toy', emoji: 'ğŸª¶' },
                { id: 56, name: 'Circuito de pelotas', price: 60, category: 'toy', emoji: 'ğŸª' },
                { id: 57, name: 'Juguete interactivo', price: 75, category: 'toy', emoji: 'ğŸ¤–' },
                
                // Collares
                { id: 4, name: 'Collar bÃ¡sico', price: 35, category: 'collar', emoji: 'ğŸ”—' },
                { id: 5, name: 'Collar elegante', price: 65, category: 'collar', emoji: 'ğŸ€' },
                { id: 58, name: 'Collar de diamantes', price: 120, category: 'collar', emoji: 'ğŸ’' },
                { id: 59, name: 'Collar con cascabel', price: 45, category: 'collar', emoji: 'ğŸ””' },
                { id: 60, name: 'Collar de cuero', price: 55, category: 'collar', emoji: 'ğŸŸ¤' },
                { id: 61, name: 'Collar con GPS', price: 180, category: 'collar', emoji: 'ğŸ“' },
                { id: 62, name: 'Collar luminoso', price: 70, category: 'collar', emoji: 'âœ¨' },
                { id: 63, name: 'Collar personalizado', price: 90, category: 'collar', emoji: 'ğŸ·ï¸' },
                
                // Accesorios para gatos
                { id: 64, name: 'Cama suave', price: 80, category: 'catAccessory', emoji: 'ğŸ›ï¸' },
                { id: 65, name: 'Arenero', price: 60, category: 'catAccessory', emoji: 'ğŸ“¦' },
                { id: 66, name: 'Rascador', price: 90, category: 'catAccessory', emoji: 'ğŸªµ' },
                { id: 67, name: 'Casa para gatos', price: 150, category: 'catAccessory', emoji: 'ğŸ ' },
                { id: 68, name: 'Ãrbol rascador', price: 200, category: 'catAccessory', emoji: 'ğŸŒ³' },
                { id: 69, name: 'Fuente de agua', price: 120, category: 'catAccessory', emoji: 'â›²' },
                { id: 70, name: 'Comedero automÃ¡tico', price: 180, category: 'catAccessory', emoji: 'ğŸ¤–' },
                { id: 71, name: 'TransportÃ­n', price: 100, category: 'catAccessory', emoji: 'ğŸ§³' },
                
                // Peceras
                { id: 72, name: 'Pecera pequeÃ±a (frÃ­a)', price: 80, category: 'aquarium', emoji: 'ğŸ ' },
                { id: 73, name: 'Pecera mediana (frÃ­a)', price: 150, category: 'aquarium', emoji: 'ğŸ˜ï¸' },
                { id: 74, name: 'Pecera grande (frÃ­a)', price: 250, category: 'aquarium', emoji: 'ğŸ°' },
                { id: 75, name: 'Pecera pequeÃ±a (caliente)', price: 120, category: 'aquarium', emoji: 'ğŸŒ¡ï¸' },
                { id: 76, name: 'Pecera mediana (caliente)', price: 200, category: 'aquarium', emoji: 'ğŸ”¥' },
                { id: 77, name: 'Pecera grande (caliente)', price: 320, category: 'aquarium', emoji: 'â™¨ï¸' },
                { id: 78, name: 'Acuario marino', price: 500, category: 'aquarium', emoji: 'ğŸŒŠ' },
                { id: 79, name: 'Pecera de lujo', price: 800, category: 'aquarium', emoji: 'ğŸ’' },
                
                // Decoraciones para peceras
                { id: 80, name: 'Adorno coral', price: 35, category: 'decoration', emoji: 'ğŸª¸' },
                { id: 81, name: 'Castillo acuÃ¡tico', price: 55, category: 'decoration', emoji: 'ğŸ°' },
                { id: 82, name: 'PiÃ±a decorativa', price: 25, category: 'decoration', emoji: 'ğŸ' },
                { id: 83, name: 'Cueva rocosa', price: 40, category: 'decoration', emoji: 'ğŸª¨' },
                { id: 84, name: 'Planta acuÃ¡tica', price: 20, category: 'decoration', emoji: 'ğŸŒ¿' },
                { id: 85, name: 'Tesoro pirata', price: 45, category: 'decoration', emoji: 'ğŸ’°' },
                { id: 86, name: 'Barco hundido', price: 60, category: 'decoration', emoji: 'ğŸš¢' },
                { id: 87, name: 'Algas marinas', price: 18, category: 'decoration', emoji: 'ğŸŒŠ' },
                { id: 88, name: 'VolcÃ¡n submarino', price: 70, category: 'decoration', emoji: 'ğŸŒ‹' },
                { id: 89, name: 'Estatua de sirena', price: 85, category: 'decoration', emoji: 'ğŸ§œâ€â™€ï¸' },
                { id: 90, name: 'Arrecife artificial', price: 95, category: 'decoration', emoji: 'ğŸš' },
                { id: 91, name: 'Puente japonÃ©s', price: 50, category: 'decoration', emoji: 'ğŸŒ‰' },
                
                // Medicinas
                { id: 6, name: 'Medicina bÃ¡sica', price: 40, category: 'medicine', emoji: 'ğŸ’Š' },
                { id: 7, name: 'Vitaminas', price: 25, category: 'medicine', emoji: 'ğŸ§ª' },
                { id: 92, name: 'Vacuna completa', price: 60, category: 'medicine', emoji: 'ğŸ’‰' },
                { id: 93, name: 'AntibiÃ³tico', price: 50, category: 'medicine', emoji: 'ğŸ’Š' },
                { id: 94, name: 'Antiparasitario', price: 45, category: 'medicine', emoji: 'ğŸ©¹' },
                { id: 95, name: 'Calmante natural', price: 35, category: 'medicine', emoji: 'ğŸŒ¿' },
                { id: 96, name: 'Suero hidratante', price: 30, category: 'medicine', emoji: 'ğŸ’§' },
                { id: 97, name: 'Medicina de emergencia', price: 100, category: 'medicine', emoji: 'ğŸš¨' },
                
                // Productos especiales
                { id: 98, name: 'PociÃ³n de felicidad', price: 150, category: 'special', emoji: 'âœ¨' },
                { id: 99, name: 'Elixir de salud', price: 200, category: 'special', emoji: 'ğŸ§ª' },
                { id: 100, name: 'Cristal de energÃ­a', price: 300, category: 'special', emoji: 'ğŸ’' },
                { id: 101, name: 'Amuleto de la suerte', price: 250, category: 'special', emoji: 'ğŸ€' },
                { id: 102, name: 'Pergamino mÃ¡gico', price: 180, category: 'special', emoji: 'ğŸ“œ' }
            ],
            availablePets: [],
            breeds: {
                cat: ['SiamÃ©s', 'Persa', 'Maine Coon', 'BritÃ¡nico', 'BengalÃ­'],
                fish: ['Goldfish', 'Nemo', 'Cebra', 'Ãngel']
            },
            petNames: {
                cat: {
                    male: ['Simba', 'Garfield', 'FÃ©lix', 'Shadow', 'Tiger'],
                    female: ['Luna', 'Nala', 'Bella', 'Mittens', 'Coco']
                },
                fish: {
                    male: ['Nemo', 'Finn', 'Neptuno', 'Azul', 'Dorado'],
                    female: ['Dory', 'Marina', 'Perla', 'Estrella', 'Sirena']
                }
            }
        };

        // Initialize game
        document.addEventListener('DOMContentLoaded', function() {
            loadGameData();
            initializeGame();
            generateInitialPets();
        });

        function loadGameData() {
            const savedData = localStorage.getItem('catsFishGameData');
            if (savedData) {
                const parsed = JSON.parse(savedData);
                gameState.users = parsed.users || {};
                gameState.availablePets = parsed.availablePets || [];
            }
        }

        function saveGameData() {
            const dataToSave = {
                users: gameState.users,
                availablePets: gameState.availablePets
            };
            localStorage.setItem('catsFishGameData', JSON.stringify(dataToSave));
        }

        function initializeGame() {
            // Login form
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
        }

        function generateInitialPets() {
            if (gameState.availablePets.length < 3) {
                for (let i = 0; i < 5; i++) {
                    addRandomPetToShelter();
                }
            }
        }

        function handleLogin(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();

            if (!username || !password) {
                alert('Por favor completa todos los campos');
                return;
            }

            // Create new account automatically if user doesn't exist
            if (!gameState.users[username]) {
                gameState.users[username] = {
                    password: password,
                    coins: 1000,
                    pets: [],
                    cemetery: [],
                    inventory: {
                        'Comida para gatos': 3,
                        'Comida para peces': 3,
                        'Medicina bÃ¡sica': 2
                    }
                };
            }

            // Login user
            const user = gameState.users[username];
            
            if (user && user.password === password) {
                gameState.currentUser = username;
                
                // Hide login screen and show game
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('gameScreen').style.display = 'block';
                
                // Clear form
                document.getElementById('username').value = '';
                document.getElementById('password').value = '';
                
                // Update displays
                updateDisplay();
                showSection('home');
                saveGameData();
                
                alert(`Â¡Bienvenido ${username}!`);
            } else {
                alert('Error en el login. Verifica tu usuario y contraseÃ±a.');
            }
        }

        function logout() {
            gameState.currentUser = null;
            document.getElementById('loginScreen').style.display = 'flex';
            document.getElementById('gameScreen').style.display = 'none';
        }

        function showSection(section) {
            // Hide all sections
            const sections = ['home', 'shop', 'shelter', 'vet', 'work', 'cemetery'];
            sections.forEach(s => {
                const element = document.getElementById(s + 'Section');
                if (element) {
                    element.classList.add('hidden');
                }
            });
            
            // Show selected section
            const targetSection = document.getElementById(section + 'Section');
            if (targetSection) {
                targetSection.classList.remove('hidden');
            }
            
            // Update section content
            switch(section) {
                case 'home':
                    updatePetsDisplay();
                    updateInventoryDisplay();
                    break;
                case 'shop':
                    updateShopDisplay();
                    break;
                case 'shelter':
                    updateShelterDisplay();
                    break;
                case 'vet':
                    updateVetDisplay();
                    break;
                case 'cemetery':
                    updateCemeteryDisplay();
                    break;
            }
        }

        function updateDisplay() {
            if (!gameState.currentUser) return;
            
            const user = gameState.users[gameState.currentUser];
            document.getElementById('userWelcome').textContent = `Bienvenido, ${gameState.currentUser}`;
            document.getElementById('userCoins').textContent = user.coins;
        }

        function updatePetsDisplay() {
            const user = gameState.users[gameState.currentUser];
            const container = document.getElementById('petsContainer');
            const noMessage = document.getElementById('noPetsMessage');
            
            if (!user.pets || user.pets.length === 0) {
                container.innerHTML = '';
                noMessage.classList.remove('hidden');
                return;
            }
            
            noMessage.classList.add('hidden');
            container.innerHTML = user.pets.map(pet => {
                const health = Math.round(pet.health);
                const happiness = Math.round(pet.happiness);
                
                return `
                <div class="pet-card bg-white rounded-xl shadow-sm p-4 cursor-pointer" onclick="showPetDetails('${pet.id}')">
                    <div class="text-center">
                        <div class="text-4xl mb-3">${pet.emoji}</div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-1">${pet.name}</h3>
                        <p class="text-xs text-gray-600 mb-1">${pet.gender === 'male' ? 'â™‚ï¸' : 'â™€ï¸'} ${pet.breed}</p>
                        <p class="text-xs text-gray-500 mb-1">${pet.color}</p>
                        <p class="text-xs text-gray-400 mb-2">${getAgeDisplay(pet)}</p>
                        ${pet.collar ? `<p class="text-purple-600 text-xs mb-2">ğŸ€ ${pet.collar}</p>` : ''}
                        
                        <div class="space-y-1">
                            <div class="flex items-center justify-between text-xs">
                                <span>Salud:</span>
                                <span class="${health > 70 ? 'text-green-600' : health > 40 ? 'text-yellow-600' : 'text-red-600'}">${health}%</span>
                            </div>
                            <div class="flex items-center justify-between text-xs">
                                <span>Felicidad:</span>
                                <span class="${happiness > 70 ? 'text-green-600' : happiness > 40 ? 'text-yellow-600' : 'text-red-600'}">${happiness}%</span>
                            </div>
                        </div>
                        
                        ${pet.isBaby ? `
                            <div class="mt-2 p-2 bg-yellow-50 rounded border border-yellow-200">
                                <p class="text-yellow-600 text-xs font-medium baby-pet">ğŸ¼ BebÃ©</p>
                            </div>
                        ` : ''}
                    </div>
                </div>
            `;
            }).join('');
        }

        function updateInventoryDisplay() {
            const user = gameState.users[gameState.currentUser];
            const container = document.getElementById('inventoryList');
            
            const items = Object.entries(user.inventory).filter(([name, quantity]) => quantity > 0);
            
            if (items.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center">Inventario vacÃ­o</p>';
                return;
            }
            
            container.innerHTML = items.map(([name, quantity]) => {
                const item = gameState.shopItems.find(i => i.name === name);
                const emoji = item ? item.emoji : 'ğŸ“¦';
                
                return `
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <span class="text-2xl">${emoji}</span>
                            <span class="font-medium text-gray-800">${name}</span>
                        </div>
                        <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-sm font-medium">${quantity}</span>
                    </div>
                `;
            }).join('');
        }

        function updateShopDisplay() {
            const container = document.getElementById('shopContainer');
            
            container.innerHTML = gameState.shopItems.map(item => `
                <div class="shop-item bg-white rounded-xl shadow-sm p-6 text-center">
                    <div class="text-4xl mb-4">${item.emoji}</div>
                    <h3 class="font-semibold text-gray-800 mb-2">${item.name}</h3>
                    <p class="text-2xl font-bold text-green-600 mb-4">${item.price} ğŸª™</p>
                    <button onclick="buyItem(${item.id})" class="w-full bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition duration-200">
                        Comprar
                    </button>
                </div>
            `).join('');
        }

        function updateShelterDisplay() {
            const container = document.getElementById('shelterContainer');
            
            if (gameState.availablePets.length === 0) {
                container.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <div class="text-6xl mb-4">ğŸ </div>
                        <h3 class="text-xl font-semibold text-gray-700 mb-2">No hay mascotas disponibles</h3>
                        <p class="text-gray-500">Vuelve mÃ¡s tarde</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = gameState.availablePets.map(pet => {
                const health = Math.round(pet.health);
                const happiness = Math.round(pet.happiness);
                
                return `
                <div class="bg-white rounded-xl shadow-sm p-6 text-center">
                    <div class="text-6xl mb-4">${pet.emoji}</div>
                    <h3 class="text-xl font-semibold text-gray-800 mb-2">${pet.name}</h3>
                    <p class="text-gray-600 mb-1">${pet.gender === 'male' ? 'â™‚ï¸' : 'â™€ï¸'} ${pet.breed}</p>
                    <p class="text-gray-500 mb-4">${pet.color}</p>
                    
                    <div class="mb-4 space-y-2">
                        <div class="flex justify-between text-sm">
                            <span>Salud:</span>
                            <span class="${health > 70 ? 'text-green-600' : health > 40 ? 'text-yellow-600' : 'text-red-600'}">${health}%</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span>Felicidad:</span>
                            <span class="${happiness > 70 ? 'text-green-600' : happiness > 40 ? 'text-yellow-600' : 'text-red-600'}">${happiness}%</span>
                        </div>
                    </div>
                    
                    <button onclick="adoptPet(${pet.id})" class="w-full bg-purple-500 text-white py-2 rounded-lg hover:bg-purple-600 transition duration-200">
                        Adoptar (+200 ğŸª™)
                    </button>
                </div>
            `;
            }).join('');
        }

        function updateVetDisplay() {
            const user = gameState.users[gameState.currentUser];
            const sickPets = user.pets.filter(pet => pet.health < 80);
            const sickContainer = document.getElementById('sickPetsList');
            const noSickMessage = document.getElementById('noSickPets');
            
            if (sickPets.length === 0) {
                sickContainer.innerHTML = '';
                noSickMessage.classList.remove('hidden');
                return;
            }
            
            noSickMessage.classList.add('hidden');
            sickContainer.innerHTML = sickPets.map(pet => `
                <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-4">
                            <span class="text-3xl">${pet.emoji}</span>
                            <div>
                                <h4 class="font-semibold text-gray-800">${pet.name}</h4>
                                <p class="text-sm text-gray-600">Salud: ${Math.round(pet.health)}%</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <p class="text-lg font-bold text-red-600 mb-2">50 ğŸª™</p>
                            <button onclick="treatPet('${pet.id}')" class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600">
                                Tratar
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        function updateCemeteryDisplay() {
            const user = gameState.users[gameState.currentUser];
            if (!user.cemetery) user.cemetery = [];
            
            const container = document.getElementById('cemeteryList');
            const noMessage = document.getElementById('noCemeteryPets');
            
            if (user.cemetery.length === 0) {
                container.innerHTML = '';
                noMessage.classList.remove('hidden');
                return;
            }
            
            noMessage.classList.add('hidden');
            container.innerHTML = user.cemetery.map(pet => `
                <div class="bg-gray-50 border border-gray-200 rounded-xl p-6 text-center">
                    <div class="text-4xl mb-3 opacity-60">${pet.emoji}</div>
                    <h3 class="text-lg font-semibold text-gray-700 mb-1">${pet.name}</h3>
                    <p class="text-sm text-gray-500 mb-1">${pet.gender === 'male' ? 'â™‚ï¸' : 'â™€ï¸'} ${pet.breed}</p>
                    <p class="text-sm text-gray-400 mb-2">${pet.color}</p>
                    <p class="text-xs text-gray-400 mb-2">ViviÃ³ ${getAgeDisplay(pet)}</p>
                    <div class="border-t border-gray-200 pt-3 mt-3">
                        <p class="text-xs text-gray-500 mb-1">FalleciÃ³ por: ${pet.causeOfDeath}</p>
                        <p class="text-xs text-gray-400">${new Date(pet.deathDate).toLocaleDateString()}</p>
                    </div>
                    <div class="mt-3 text-gray-400">
                        <span class="text-lg">ğŸŒˆ</span>
                        <p class="text-xs mt-1">Descansa en paz</p>
                    </div>
                </div>
            `).join('');
        }

        // Game Actions
        function buyItem(itemId) {
            const user = gameState.users[gameState.currentUser];
            const item = gameState.shopItems.find(i => i.id === itemId);
            
            if (!item) return;
            
            if (user.coins < item.price) {
                alert('No tienes suficientes monedas');
                return;
            }
            
            user.coins -= item.price;
            user.inventory[item.name] = (user.inventory[item.name] || 0) + 1;
            
            updateDisplay();
            updateInventoryDisplay();
            saveGameData();
            
            alert(`Â¡Has comprado ${item.name}!`);
        }

        function adoptPet(petId) {
            const user = gameState.users[gameState.currentUser];
            const pet = gameState.availablePets.find(p => p.id === petId);
            
            if (!pet) return;
            
            // Add pet to user's collection
            const newPet = {
                ...pet,
                id: Date.now().toString()
            };
            
            user.pets.push(newPet);
            user.coins += 200; // Reward for adoption
            
            // Remove from available pets
            gameState.availablePets = gameState.availablePets.filter(p => p.id !== petId);
            
            updateDisplay();
            updateShelterDisplay();
            updatePetsDisplay();
            saveGameData();
            
            alert(`Â¡Has adoptado a ${pet.name}! Recibes 200 monedas de recompensa.`);
        }

        function treatPet(petId) {
            const user = gameState.users[gameState.currentUser];
            const pet = user.pets.find(p => p.id === petId);
            
            if (!pet) return;
            
            if (user.coins < 50) {
                alert('No tienes suficientes monedas para el tratamiento');
                return;
            }
            
            user.coins -= 50;
            pet.health = Math.min(100, pet.health + 40);
            
            updateDisplay();
            updateVetDisplay();
            updatePetsDisplay();
            saveGameData();
            
            alert(`${pet.name} ha sido tratado y se siente mucho mejor!`);
        }

        function feedAllPets() {
            const user = gameState.users[gameState.currentUser];
            
            if (!user.pets || user.pets.length === 0) {
                alert('No tienes mascotas para alimentar');
                return;
            }
            
            const catFood = user.inventory['Comida para gatos'] || 0;
            const fishFood = user.inventory['Comida para peces'] || 0;
            
            const cats = user.pets.filter(pet => pet.type === 'cat');
            const fish = user.pets.filter(pet => pet.type === 'fish');
            
            let fedCats = 0;
            let fedFish = 0;
            
            // Feed cats
            if (cats.length > 0 && catFood > 0) {
                const toFeed = Math.min(cats.length, catFood);
                for (let i = 0; i < toFeed; i++) {
                    cats[i].health = Math.min(100, cats[i].health + 15);
                    cats[i].happiness = Math.min(100, cats[i].happiness + 20);
                }
                user.inventory['Comida para gatos'] -= toFeed;
                fedCats = toFeed;
            }
            
            // Feed fish
            if (fish.length > 0 && fishFood > 0) {
                const toFeed = Math.min(fish.length, fishFood);
                for (let i = 0; i < toFeed; i++) {
                    fish[i].health = Math.min(100, fish[i].health + 15);
                    fish[i].happiness = Math.min(100, fish[i].happiness + 20);
                }
                user.inventory['Comida para peces'] -= toFeed;
                fedFish = toFeed;
            }
            
            updateDisplay();
            updatePetsDisplay();
            updateInventoryDisplay();
            saveGameData();
            
            let message = 'Â¡Mascotas alimentadas!\n';
            if (fedCats > 0) message += `${fedCats} gatos alimentados\n`;
            if (fedFish > 0) message += `${fedFish} peces alimentados\n`;
            if (fedCats === 0 && fedFish === 0) message = 'No tienes comida suficiente';
            
            alert(message);
        }

        function startJob(jobType) {
            const user = gameState.users[gameState.currentUser];
            let reward = 0;
            
            switch(jobType) {
                case 'petCare':
                    reward = 100;
                    break;
                case 'shopKeeper':
                    reward = 80;
                    break;
                case 'delivery':
                    reward = 120;
                    break;
            }
            
            user.coins += reward;
            updateDisplay();
            saveGameData();
            
            alert(`Â¡Trabajo completado! Has ganado ${reward} monedas.`);
        }

        function startBreeding(type) {
            const user = gameState.users[gameState.currentUser];
            const cost = type === 'cat' ? 200 : 100;
            
            if (user.coins < cost) {
                alert(`No tienes suficientes monedas (${cost} ğŸª™)`);
                return;
            }
            
            // Check if user has pets of this type
            const availablePets = user.pets.filter(pet => pet.type === type && pet.health > 70);
            
            if (availablePets.length < 2) {
                const typeText = type === 'cat' ? 'gatos' : 'peces';
                alert(`Necesitas al menos 2 ${typeText} sanos para la crÃ­a`);
                return;
            }
            
            user.coins -= cost;
            
            // Create babies immediately (simplified)
            const count = type === 'cat' ? 
                Math.floor(Math.random() * 4) + 1 : // 1-4 kittens
                Math.floor(Math.random() * 6) + 3;   // 3-8 fry
            
            const parent = availablePets[0];
            
            for (let i = 0; i < count; i++) {
                const gender = Math.random() < 0.5 ? 'male' : 'female';
                const names = gameState.petNames[type][gender];
                const name = names[Math.floor(Math.random() * names.length)];
                
                const baby = {
                    id: Date.now().toString() + '_' + i,
                    name: name,
                    type: type,
                    breed: parent.breed,
                    color: parent.color,
                    gender: gender,
                    emoji: parent.emoji,
                    health: Math.random() * 20 + 80,
                    happiness: Math.random() * 20 + 80,
                    isBaby: true,
                    age: 0,
                    birthDate: Date.now()
                };
                
                user.pets.push(baby);
            }
            
            updateDisplay();
            updatePetsDisplay();
            saveGameData();
            
            const typeText = type === 'cat' ? 'gatitos' : 'alevines';
            alert(`Â¡Felicidades! Has obtenido ${count} ${typeText} bebÃ©s.`);
        }

        function showPetDetails(petId) {
            const user = gameState.users[gameState.currentUser];
            const pet = user.pets.find(p => p.id === petId);
            
            if (!pet) return;
            
            const modal = document.getElementById('petModal');
            const content = document.getElementById('petModalContent');
            
            const health = Math.round(pet.health);
            const happiness = Math.round(pet.happiness);
            
            content.innerHTML = `
                <div class="text-center">
                    <div class="text-8xl mb-4">${pet.emoji}</div>
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">${pet.name}</h2>
                    <p class="text-gray-600 mb-2">${pet.gender === 'male' ? 'â™‚ï¸' : 'â™€ï¸'} ${pet.breed} â€¢ ${pet.color}</p>
                    <p class="text-gray-500 mb-4">Edad: ${getAgeDisplay(pet)}</p>
                    
                    <div class="grid grid-cols-2 gap-4 mb-6">
                        <div class="bg-gray-50 rounded-lg p-3">
                            <p class="text-sm text-gray-600">Salud</p>
                            <p class="text-lg font-semibold ${health > 70 ? 'text-green-600' : health > 40 ? 'text-yellow-600' : 'text-red-600'}">${health}%</p>
                        </div>
                        <div class="bg-gray-50 rounded-lg p-3">
                            <p class="text-sm text-gray-600">Felicidad</p>
                            <p class="text-lg font-semibold ${happiness > 70 ? 'text-green-600' : happiness > 40 ? 'text-yellow-600' : 'text-red-600'}">${happiness}%</p>
                        </div>
                    </div>
                    
                    ${pet.isBaby ? `
                        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4">
                            <p class="text-yellow-600 font-medium baby-pet">ğŸ¼ Es un bebÃ©</p>
                        </div>
                    ` : ''}
                    
                    <button onclick="closeModal()" class="w-full bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600">
                        Cerrar
                    </button>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('petModal').classList.add('hidden');
        }
        
        function getAgeDisplay(pet) {
            if (!pet.age && pet.age !== 0) return 'Edad desconocida';
            
            if (pet.isBaby) {
                return `${pet.age} meses (bebÃ©)`;
            } else if (pet.age < 12) {
                return `${pet.age} meses`;
            } else {
                const years = Math.floor(pet.age / 12);
                const months = pet.age % 12;
                if (months === 0) {
                    return `${years} aÃ±o${years !== 1 ? 's' : ''}`;
                } else {
                    return `${years}a ${months}m`;
                }
            }
        }

        function addRandomPetToShelter() {
            const type = Math.random() < 0.5 ? 'cat' : 'fish';
            const breeds = gameState.breeds[type];
            const breed = breeds[Math.floor(Math.random() * breeds.length)];
            const gender = Math.random() < 0.5 ? 'male' : 'female';
            const names = gameState.petNames[type][gender];
            const name = names[Math.floor(Math.random() * names.length)];
            
            const colors = ['negro', 'blanco', 'gris', 'naranja', 'marrÃ³n', 'atigrado'];
            const color = colors[Math.floor(Math.random() * colors.length)];
            
            const newPet = {
                id: Date.now() + Math.random(),
                name: name,
                type: type,
                breed: breed,
                color: color,
                gender: gender,
                emoji: type === 'cat' ? 'ğŸ±' : 'ğŸ ',
                health: Math.round((Math.random() * 30 + 70)),
                happiness: Math.round((Math.random() * 40 + 60)),
                age: Math.floor(Math.random() * 5) + 1, // 1-5 years
                birthDate: Date.now() - (Math.floor(Math.random() * 5) + 1) * 365 * 24 * 60 * 60 * 1000
            };
            
            gameState.availablePets.push(newPet);
            saveGameData();
        }

        // Pet mortality and aging system
        function checkPetMortality() {
            if (!gameState.currentUser) return;
            
            const user = gameState.users[gameState.currentUser];
            if (!user.pets || user.pets.length === 0) return;
            
            const now = Date.now();
            const timeSinceLastCheck = now - gameState.lastMortalityCheck;
            
            // Only check every 5 minutes to avoid spam
            if (timeSinceLastCheck < 300000) return;
            
            gameState.lastMortalityCheck = now;
            
            let deaths = [];
            
            user.pets.forEach(pet => {
                // Update age based on birth date
                if (!pet.birthDate) {
                    pet.birthDate = now - (pet.age || 1) * 365 * 24 * 60 * 60 * 1000;
                }
                
                const ageInDays = (now - pet.birthDate) / (24 * 60 * 60 * 1000);
                pet.age = Math.floor(ageInDays / 365 * 12); // Age in months for more granular control
                
                // Remove baby status after 6 months
                if (pet.isBaby && pet.age >= 6) {
                    pet.isBaby = false;
                }
                
                // Calculate death probability
                let deathChance = 0;
                
                // Age factor (cats live ~15 years, fish ~5 years)
                const maxAge = pet.type === 'cat' ? 180 : 60; // months
                if (pet.age > maxAge * 0.8) {
                    deathChance += 0.15; // 15% chance for very old pets
                } else if (pet.age > maxAge * 0.6) {
                    deathChance += 0.05; // 5% chance for old pets
                }
                
                // Health factor
                if (pet.health < 20) {
                    deathChance += 0.25; // 25% chance for very sick pets
                } else if (pet.health < 40) {
                    deathChance += 0.10; // 10% chance for sick pets
                } else if (pet.health < 60) {
                    deathChance += 0.03; // 3% chance for unhealthy pets
                }
                
                // Happiness factor (stress can kill)
                if (pet.happiness < 20) {
                    deathChance += 0.08; // 8% chance for very unhappy pets
                }
                
                // Random chance (life is unpredictable)
                deathChance += 0.001; // 0.1% base chance
                
                // Check if pet dies
                if (Math.random() < deathChance) {
                    deaths.push(pet);
                }
            });
            
            // Remove dead pets and notify user
            if (deaths.length > 0) {
                deaths.forEach(deadPet => {
                    user.pets = user.pets.filter(p => p.id !== deadPet.id);
                    
                    // Determine cause of death
                    let cause = 'causas naturales';
                    if (deadPet.health < 20) cause = 'enfermedad grave';
                    else if (deadPet.happiness < 20) cause = 'tristeza extrema';
                    else if (deadPet.age > (deadPet.type === 'cat' ? 144 : 48)) cause = 'vejez';
                    
                    // Add to cemetery
                    if (!user.cemetery) user.cemetery = [];
                    user.cemetery.push({
                        ...deadPet,
                        causeOfDeath: cause,
                        deathDate: Date.now()
                    });
                    
                    // Show death notification
                    setTimeout(() => {
                        alert(`ğŸ’” Lamentamos informarte que ${deadPet.name} ha fallecido por ${cause}. Descanse en paz. ğŸŒˆ\n\nPuedes visitarlo en el cementerio.`);
                    }, 1000);
                });
                
                updatePetsDisplay();
                saveGameData();
            }
        }
        
        // Gradual health and happiness decline
        function updatePetStats() {
            if (!gameState.currentUser) return;
            
            const user = gameState.users[gameState.currentUser];
            if (!user.pets || user.pets.length === 0) return;
            
            user.pets.forEach(pet => {
                // Gradual decline over time
                const decline = Math.random() * 2; // 0-2% decline
                
                pet.health = Math.max(0, pet.health - decline);
                pet.happiness = Math.max(0, pet.happiness - decline * 1.5);
                
                // Older pets decline faster
                if (pet.age > (pet.type === 'cat' ? 120 : 40)) {
                    pet.health = Math.max(0, pet.health - decline);
                }
            });
            
            updatePetsDisplay();
            saveGameData();
        }

        // Add new pets periodically
        setInterval(() => {
            if (Math.random() < 0.3) {
                addRandomPetToShelter();
            }
        }, 30000); // Every 30 seconds
        
        // Check pet mortality every 5 minutes
        setInterval(checkPetMortality, 300000);
        
        // Update pet stats every 2 minutes
        setInterval(updatePetStats, 120000);
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9c692348b41aa431',t:'MTc2OTg2MTc2MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
