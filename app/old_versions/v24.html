<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gatos y Peces v21 - Juego Virtual</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Poppins', sans-serif; }
        .pet-card { transition: all 0.3s ease; }
        .pet-card:hover { transform: translateY(-5px); }
        .modal { backdrop-filter: blur(10px); }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .shop-item { transition: all 0.2s ease; }
        .shop-item:hover { transform: scale(1.05); }
        .litter-card { 
            background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%);
            border: 2px solid #fdcb6e;
        }
        .baby-pet { 
            animation: bounce 2s infinite;
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- Login Screen -->
    <div id="loginScreen" class="min-h-screen gradient-bg flex items-center justify-center">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md">
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold text-gray-800 mb-2">ğŸ± Gatos y Peces v21 ğŸ </h1>
                <p class="text-gray-600">Perros prÃ³ximamente</p>
                <p class="text-sm text-blue-600 mt-2">âœ¨ Nuevo: Sistema de camadas y descendencia</p>
            </div>
            
            <form id="loginForm" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Usuario</label>
                    <input type="text" id="username" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Ingresa tu usuario">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ContraseÃ±a</label>
                    <input type="password" id="password" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="GAME-****">
                </div>
                
                <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition duration-200">
                    Iniciar SesiÃ³n
                </button>
            </form>
            
            <div class="mt-6 text-center">
                <button id="createAccountBtn" class="text-blue-600 hover:text-blue-800 font-medium">
                    Crear nueva cuenta
                </button>
                
                <div class="mt-4 p-3 bg-blue-50 rounded-lg">
                    <p class="text-sm text-blue-700 font-medium mb-2">ğŸ’¡ Acceso rÃ¡pido:</p>
                    <p class="text-xs text-blue-600">Puedes usar cualquier usuario y contraseÃ±a para crear una cuenta automÃ¡ticamente</p>
                    <p class="text-xs text-blue-600 mt-1">Ejemplo: usuario "jugador1" con contraseÃ±a "GAME-123"</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Create Account Modal -->
    <div id="createAccountModal" class="hidden fixed inset-0 bg-black bg-opacity-50 modal flex items-center justify-center z-50">
        <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4">
            <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">Crear Nueva Cuenta</h2>
            
            <form id="createAccountForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Usuario</label>
                    <input type="text" id="newUsername" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Nombre de usuario">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ContraseÃ±a</label>
                    <input type="password" id="newPassword" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="GAME-****">
                    <p class="text-xs text-gray-500 mt-1">Debe comenzar con GAME-</p>
                </div>
                
                <div class="flex space-x-3 pt-4">
                    <button type="submit" class="flex-1 bg-green-600 text-white py-3 rounded-lg font-semibold hover:bg-green-700 transition duration-200">
                        Crear Cuenta
                    </button>
                    <button type="button" id="cancelCreateBtn" class="flex-1 bg-gray-500 text-white py-3 rounded-lg font-semibold hover:bg-gray-600 transition duration-200">
                        Cancelar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Main Game Interface -->
    <div id="gameScreen" class="hidden">
        <!-- Navigation -->
        <nav class="bg-white shadow-lg">
            <div class="max-w-7xl mx-auto px-4">
                <div class="flex justify-between items-center py-4">
                    <div class="flex items-center space-x-4">
                        <h1 class="text-2xl font-bold text-gray-800">ğŸ± Gatos y Peces v21</h1>
                        <span id="userWelcome" class="text-gray-600"></span>
                    </div>
                    
                    <div class="flex items-center space-x-6">
                        <div class="flex items-center space-x-2">
                            <span class="text-yellow-500">ğŸª™</span>
                            <span id="userCoins" class="font-semibold">1000</span>
                            <span class="text-sm text-gray-600">Monedas</span>
                        </div>
                        
                        <div class="flex space-x-2">
                            <button id="homeBtn" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">Casa</button>
                            <button id="shopBtn" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600">Tienda</button>
                            <button id="shelterBtn" class="px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600">Protectora</button>
                            <button id="vetBtn" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600">Veterinario</button>
                            <button id="workBtn" class="px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600">Trabajos</button>
                            <button id="transportBtn" class="px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600">VITRASA</button>
                            <button id="adminBtn" class="hidden px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900">Admin</button>
                        </div>
                        
                        <button id="logoutBtn" class="text-gray-500 hover:text-gray-700">Salir</button>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Home Section -->
        <div id="homeSection" class="max-w-7xl mx-auto px-4 py-8">
            <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
                <!-- Cats Display -->
                <div class="lg:col-span-2">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">ğŸ± Mis Gatos</h2>
                        <div class="text-sm text-gray-600">
                            <span>â° <span id="gameTime">DÃ­a 1, Mes 1, AÃ±o 1</span></span>
                        </div>
                    </div>
                    
                    <div id="catsContainer" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- Cats will be dynamically added here -->
                    </div>
                    
                    <div id="noCatsMessage" class="text-center py-8 bg-white rounded-xl shadow-sm">
                        <div class="text-4xl mb-2">ğŸ±</div>
                        <p class="text-gray-500 text-sm">No tienes gatos</p>
                    </div>

                    <!-- Aquariums Display -->
                    <div class="mt-8">
                        <h2 class="text-2xl font-bold text-gray-800 mb-6">ğŸ  Mis Peceras</h2>
                        
                        <div id="aquariumsContainer" class="space-y-4">
                            <!-- Aquariums will be dynamically added here -->
                        </div>
                        
                        <div id="noAquariumsMessage" class="text-center py-8 bg-white rounded-xl shadow-sm">
                            <div class="text-4xl mb-2">ğŸ </div>
                            <p class="text-gray-500 text-sm mb-4">No tienes peceras</p>
                            <button onclick="showSection('shop')" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 text-sm">
                                Comprar Pecera
                            </button>
                        </div>
                    </div>

                    <!-- Litters Display -->
                    <div class="mt-8">
                        <h2 class="text-2xl font-bold text-gray-800 mb-6">ğŸ¼ Camadas Activas</h2>
                        
                        <div id="littersHomeContainer" class="space-y-4">
                            <!-- Active litters will be displayed here -->
                        </div>
                        
                        <div id="noLittersHomeMessage" class="text-center py-8 bg-white rounded-xl shadow-sm">
                            <div class="text-4xl mb-2">ğŸ¼</div>
                            <p class="text-gray-500 text-sm mb-4">No tienes camadas activas</p>
                            <button onclick="showSection('work')" class="bg-orange-500 text-white px-4 py-2 rounded-lg hover:bg-orange-600 text-sm">
                                Ir a Centro de CrÃ­a
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Inventory -->
                <div class="lg:col-span-2 space-y-6">
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">Inventario</h3>
                        <div id="inventoryList" class="space-y-3">
                            <!-- Inventory items will be added here -->
                        </div>
                    </div>

                    <!-- Cat Accessories -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">ğŸ± Accesorios para Gatos</h3>
                        <div id="catAccessoriesContainer" class="space-y-3">
                            <!-- Cat accessories will be displayed here -->
                        </div>
                        <div id="noCatAccessoriesMessage" class="text-center py-4 text-gray-500 text-sm">
                            No tienes accesorios instalados
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="bg-white rounded-xl shadow-sm p-6">
                        <h3 class="text-xl font-semibold text-gray-800 mb-4">Acciones RÃ¡pidas</h3>
                        <div class="space-y-3">
                            <button onclick="setupAquarium()" class="w-full bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 text-sm">
                                ğŸ  Instalar Pecera
                            </button>
                            <button onclick="setupCatAccessory()" class="w-full bg-orange-500 text-white py-2 rounded-lg hover:bg-orange-600 text-sm">
                                ğŸ± Instalar Accesorio
                            </button>
                            <button onclick="showSection('shelter')" class="w-full bg-purple-500 text-white py-2 rounded-lg hover:bg-purple-600 text-sm">
                                ğŸ  Adoptar Mascota
                            </button>
                            <button onclick="feedAllPets()" class="w-full bg-green-500 text-white py-2 rounded-lg hover:bg-green-600 text-sm">
                                ğŸ¥« Alimentar Todos
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Shop Section -->
        <div id="shopSection" class="hidden max-w-7xl mx-auto px-4 py-8">
            <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">ğŸ›’ Tienda de Mascotas</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                <!-- Shop items will be dynamically added -->
            </div>
        </div>

        <!-- Shelter Section -->
        <div id="shelterSection" class="hidden max-w-7xl mx-auto px-4 py-8">
            <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">ğŸ  Protectora de Animales</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Available pets for adoption -->
            </div>
        </div>

        <!-- Veterinarian Section -->
        <div id="vetSection" class="hidden max-w-7xl mx-auto px-4 py-8">
            <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">ğŸ¥ Veterinario Dr. PÃ©rez</h2>
            
            <div class="bg-white rounded-xl shadow-sm p-8 mb-8">
                <div class="text-center mb-8">
                    <div class="text-6xl mb-4">ğŸ‘¨â€âš•ï¸</div>
                    <h3 class="text-2xl font-semibold text-gray-800 mb-2">Dr. PÃ©rez - ClÃ­nica Veterinaria</h3>
                    <p class="text-gray-600">ğŸ’Š Precios segÃºn tipo de virus detectado</p>
                </div>
                
                <!-- Virus Price List -->
                <div class="bg-blue-50 rounded-lg p-6 mb-6">
                    <h4 class="text-lg font-semibold text-gray-800 mb-4">ğŸ“‹ Tarifas por DiagnÃ³stico</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="space-y-2">
                            <div class="flex justify-between items-center">
                                <span class="text-green-600">ğŸ¤§ Resfriado comÃºn</span>
                                <span class="font-semibold">30 ğŸª™</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-yellow-600">ğŸ¤’ Fiebre leve</span>
                                <span class="font-semibold">45 ğŸª™</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-orange-600">ğŸ¦  InfecciÃ³n bacteriana</span>
                                <span class="font-semibold">65 ğŸª™</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-red-600">ğŸ©¸ ParÃ¡sitos intestinales</span>
                                <span class="font-semibold">80 ğŸª™</span>
                            </div>
                        </div>
                        <div class="space-y-2">
                            <div class="flex justify-between items-center">
                                <span class="text-purple-600">ğŸ¦´ Problemas articulares</span>
                                <span class="font-semibold">95 ğŸª™</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-pink-600">ğŸ’” Problemas cardÃ­acos</span>
                                <span class="font-semibold">120 ğŸª™</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-red-800">ğŸš¨ Enfermedad grave</span>
                                <span class="font-semibold">150 ğŸª™</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-600">ğŸ” Consulta general</span>
                                <span class="font-semibold">25 ğŸª™</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="sickPetsList" class="space-y-4">
                    <!-- Sick pets will appear here -->
                </div>
                
                <div id="noSickPets" class="text-center py-8">
                    <p class="text-gray-500">Â¡Todas tus mascotas estÃ¡n sanas! ğŸ‰</p>
                    <p class="text-sm text-gray-400 mt-2">Las mascotas pueden enfermarse con el tiempo. CuÃ­dalas bien.</p>
                </div>
            </div>
        </div>

        <!-- Work Section -->
        <div id="workSection" class="hidden max-w-7xl mx-auto px-4 py-8">
            <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">ğŸ’¼ Centro de Trabajos</h2>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Active Jobs -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Trabajos Activos</h3>
                    <div id="activeJobsList" class="space-y-4">
                        <!-- Active jobs will appear here -->
                    </div>
                    <div id="noActiveJobs" class="text-center py-8 text-gray-500">
                        No tienes trabajos activos
                    </div>
                </div>
                
                <!-- Available Jobs -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Trabajos Disponibles</h3>
                    <div class="space-y-3">
                        <button id="petCareBtn" onclick="startJob('petCare')" class="w-full bg-blue-500 text-white py-3 px-4 rounded-lg hover:bg-blue-600 text-left">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="font-semibold">ğŸ¾ Cuidador de Mascotas</div>
                                    <div class="text-sm opacity-90">80-120 monedas â€¢ 2 horas</div>
                                </div>
                                <div class="text-xs opacity-75">Requiere: Mascotas</div>
                            </div>
                        </button>
                        
                        <button onclick="startJob('shopKeeper')" class="w-full bg-green-500 text-white py-3 px-4 rounded-lg hover:bg-green-600 text-left">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="font-semibold">ğŸª Vendedor de Tienda</div>
                                    <div class="text-sm opacity-90">60-100 monedas â€¢ 3 horas</div>
                                </div>
                                <div class="text-xs opacity-75">Sin requisitos</div>
                            </div>
                        </button>
                        
                        <button onclick="startJob('delivery')" class="w-full bg-purple-500 text-white py-3 px-4 rounded-lg hover:bg-purple-600 text-left">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="font-semibold">ğŸšš Repartidor</div>
                                    <div class="text-sm opacity-90">100-150 monedas â€¢ 1 hora</div>
                                </div>
                                <div class="text-xs opacity-75">Sin requisitos</div>
                            </div>
                        </button>
                        
                        <button id="vetAssistantBtn" onclick="startJob('vetAssistant')" class="w-full bg-red-500 text-white py-3 px-4 rounded-lg hover:bg-red-600 text-left">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="font-semibold">ğŸ¥ Asistente Veterinario</div>
                                    <div class="text-sm opacity-90">120-180 monedas â€¢ 4 horas</div>
                                </div>
                                <div class="text-xs opacity-75">Requiere: Medicinas</div>
                            </div>
                        </button>
                        
                        <button id="trainerBtn" onclick="startJob('trainer')" class="w-full bg-yellow-500 text-white py-3 px-4 rounded-lg hover:bg-yellow-600 text-left">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="font-semibold">ğŸª Entrenador de Shows</div>
                                    <div class="text-sm opacity-90">200-300 monedas â€¢ 6 horas</div>
                                </div>
                                <div class="text-xs opacity-75">Requiere: 3+ mascotas felices</div>
                            </div>
                        </button>
                        
                        <button id="beautyContestBtn" onclick="startJob('beautyContest')" class="w-full bg-pink-500 text-white py-3 px-4 rounded-lg hover:bg-pink-600 text-left">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="font-semibold">ğŸ† Concurso de Belleza</div>
                                    <div class="text-sm opacity-90">500-1000 monedas â€¢ 8 horas</div>
                                </div>
                                <div class="text-xs opacity-75">Requiere: Mascota con collar</div>
                            </div>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Breeding Section -->
            <div class="mt-8 bg-white rounded-xl shadow-sm p-6">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">ğŸ’• Centro de CrÃ­a</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="text-center">
                        <div class="text-4xl mb-2">ğŸ±</div>
                        <h4 class="font-semibold mb-2">CrÃ­a de Gatos</h4>
                        <p class="text-sm text-gray-600 mb-4">Costo: 200 monedas â€¢ DuraciÃ³n: 12 horas<br>Resultado: 1-4 gatitos</p>
                        <button onclick="startBreeding('cat')" class="bg-orange-500 text-white px-6 py-2 rounded-lg hover:bg-orange-600">
                            Iniciar CrÃ­a
                        </button>
                    </div>
                    
                    <div class="text-center">
                        <div class="text-4xl mb-2">ğŸ </div>
                        <h4 class="font-semibold mb-2">CrÃ­a de Peces</h4>
                        <p class="text-sm text-gray-600 mb-4">Costo: 100 monedas â€¢ DuraciÃ³n: 6 horas<br>Resultado: 3-8 alevines</p>
                        <button onclick="startBreeding('fish')" class="bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600">
                            Iniciar CrÃ­a
                        </button>
                    </div>
                </div>
                
                <div id="breedingProjectsList" class="mt-6 space-y-4">
                    <!-- Breeding projects will appear here -->
                </div>
                
                <!-- Litters Section -->
                <div class="mt-8 bg-gradient-to-r from-yellow-50 to-orange-50 rounded-xl shadow-sm p-6 border-2 border-yellow-200">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">ğŸ¼ Camadas y Descendencia</h3>
                    <p class="text-gray-600 text-sm mb-6">AquÃ­ puedes ver todas tus camadas activas y cuidar de los bebÃ©s hasta que crezcan</p>
                    
                    <div id="littersContainer" class="space-y-4">
                        <!-- Active litters will appear here -->
                    </div>
                    
                    <div id="noLittersMessage" class="text-center py-8 text-gray-500">
                        <div class="text-6xl mb-4">ğŸ¼</div>
                        <p class="text-lg font-medium mb-2">No tienes camadas activas</p>
                        <p class="text-sm">Inicia un proyecto de crÃ­a para tener bebÃ©s</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Transport Section -->
        <div id="transportSection" class="hidden max-w-7xl mx-auto px-4 py-8">
            <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">ğŸšŒ VITRASA - Transporte</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="bg-white rounded-xl shadow-sm p-6 text-center">
                    <div class="text-4xl mb-4">ğŸšŒ</div>
                    <h3 class="font-semibold text-gray-800 mb-2">LÃ­nea C1</h3>
                    <p class="text-sm text-gray-600 mb-4">Casa â†’ Tienda â†’ Veterinario â†’ Casa</p>
                    <button onclick="takeTransport('C1')" class="w-full bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600">
                        15 monedas
                    </button>
                </div>
                
                <div class="bg-white rounded-xl shadow-sm p-6 text-center">
                    <div class="text-4xl mb-4">ğŸšŒ</div>
                    <h3 class="font-semibold text-gray-800 mb-2">LÃ­nea 5A</h3>
                    <p class="text-sm text-gray-600 mb-4">Casa â†’ Tienda â†’ Casa</p>
                    <button onclick="takeTransport('5A')" class="w-full bg-green-500 text-white py-2 rounded-lg hover:bg-green-600">
                        15 monedas
                    </button>
                </div>
                
                <div class="bg-white rounded-xl shadow-sm p-6 text-center">
                    <div class="text-4xl mb-4">ğŸšŒ</div>
                    <h3 class="font-semibold text-gray-800 mb-2">LÃ­nea 15C</h3>
                    <p class="text-sm text-gray-600 mb-4">Casa â†’ Protectora â†’ Tienda â†’ Protectora â†’ Casa</p>
                    <button onclick="takeTransport('15C')" class="w-full bg-purple-500 text-white py-2 rounded-lg hover:bg-purple-600">
                        15 monedas
                    </button>
                </div>
                
                <div class="bg-white rounded-xl shadow-sm p-6 text-center">
                    <div class="text-4xl mb-4">ğŸšŒ</div>
                    <h3 class="font-semibold text-gray-800 mb-2">LÃ­nea 28</h3>
                    <p class="text-sm text-gray-600 mb-4">Casa â†’ Veterinario â†’ Casa</p>
                    <button onclick="takeTransport('28')" class="w-full bg-red-500 text-white py-2 rounded-lg hover:bg-red-600">
                        15 monedas
                    </button>
                </div>
            </div>
        </div>

        <!-- Admin Section -->
        <div id="adminSection" class="hidden max-w-7xl mx-auto px-4 py-8">
            <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">âš™ï¸ Panel de Administrador</h2>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Pet Management -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">GestiÃ³n de Animales</h3>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Agregar Nueva Raza</label>
                            <div class="flex space-x-2">
                                <select id="newPetType" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg">
                                    <option value="cat">Gato</option>
                                    <option value="fish">Pez</option>
                                </select>
                                <input type="text" id="newBreedName" placeholder="Nombre de la raza" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg">
                                <button onclick="addBreed()" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">
                                    Agregar
                                </button>
                            </div>
                        </div>
                        
                        <div id="breedsList" class="space-y-2">
                            <!-- Breeds will be listed here -->
                        </div>
                    </div>
                </div>
                
                <!-- Shop Management -->
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">GestiÃ³n de Tienda</h3>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Agregar Producto</label>
                            <div class="grid grid-cols-2 gap-2">
                                <input type="text" id="newItemName" placeholder="Nombre del producto" class="px-3 py-2 border border-gray-300 rounded-lg">
                                <input type="number" id="newItemPrice" placeholder="Precio" class="px-3 py-2 border border-gray-300 rounded-lg">
                                <select id="newItemCategory" class="px-3 py-2 border border-gray-300 rounded-lg">
                                    <option value="food">Comida</option>
                                    <option value="toy">Juguete</option>
                                    <option value="accessory">Accesorio</option>
                                    <option value="medicine">Medicina</option>
                                </select>
                                <button onclick="addShopItem()" class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600">
                                    Agregar
                                </button>
                            </div>
                        </div>
                        
                        <div id="shopItemsList" class="space-y-2 max-h-64 overflow-y-auto">
                            <!-- Shop items will be listed here -->
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Birth Management -->
            <div class="mt-8 bg-white rounded-xl shadow-sm p-6">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">GestiÃ³n de Nacimientos</h3>
                <div id="birthsList" class="space-y-4">
                    <!-- Birth records will appear here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="petModal" class="hidden fixed inset-0 bg-black bg-opacity-50 modal flex items-center justify-center z-50">
        <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4">
            <div id="petModalContent">
                <!-- Pet details will be shown here -->
            </div>
        </div>
    </div>

    <script>
        // Game State
        let gameState = {
            currentUser: null,
            users: {},
            gameTime: {
                hour: 8,
                day: 1,
                month: 1,
                year: 1
            },
            shopItems: [
                { id: 1, name: 'Comida para gatos', price: 25, category: 'food', emoji: 'ğŸ¥«' },
                { id: 2, name: 'Comida para peces', price: 15, category: 'food', emoji: 'ğŸŸ' },
                { id: 31, name: 'Comida premium gatos', price: 45, category: 'food', emoji: 'ğŸ–', healthBoost: 25, happinessBoost: 15 },
                { id: 32, name: 'Comida premium peces', price: 35, category: 'food', emoji: 'ğŸ¦', healthBoost: 25, happinessBoost: 15 },
                { id: 33, name: 'AtÃºn fresco', price: 60, category: 'food', emoji: 'ğŸŸ', healthBoost: 30, happinessBoost: 20, petType: 'cat' },
                { id: 34, name: 'SalmÃ³n ahumado', price: 80, category: 'food', emoji: 'ğŸ£', healthBoost: 35, happinessBoost: 25, petType: 'cat' },
                { id: 35, name: 'Pollo asado', price: 50, category: 'food', emoji: 'ğŸ—', healthBoost: 28, happinessBoost: 18, petType: 'cat' },
                { id: 36, name: 'Leche especial', price: 30, category: 'food', emoji: 'ğŸ¥›', healthBoost: 15, happinessBoost: 25, petType: 'cat' },
                { id: 37, name: 'Galletas para gatos', price: 20, category: 'food', emoji: 'ğŸª', healthBoost: 10, happinessBoost: 20, petType: 'cat' },
                { id: 38, name: 'Hierba gatera', price: 25, category: 'food', emoji: 'ğŸŒ¿', healthBoost: 5, happinessBoost: 35, petType: 'cat' },
                { id: 39, name: 'Artemia viva', price: 40, category: 'food', emoji: 'ğŸ¦ ', healthBoost: 30, happinessBoost: 20, petType: 'fish' },
                { id: 40, name: 'Larvas de mosquito', price: 35, category: 'food', emoji: 'ğŸª±', healthBoost: 25, happinessBoost: 15, petType: 'fish' },
                { id: 41, name: 'Escamas tropicales', price: 28, category: 'food', emoji: 'ğŸŒº', healthBoost: 20, happinessBoost: 18, petType: 'fish' },
                { id: 42, name: 'Algas marinas', price: 22, category: 'food', emoji: 'ğŸŒŠ', healthBoost: 18, happinessBoost: 12, petType: 'fish' },
                { id: 43, name: 'Dafnias congeladas', price: 32, category: 'food', emoji: 'â„ï¸', healthBoost: 22, happinessBoost: 16, petType: 'fish' },
                { id: 44, name: 'Comida en gel', price: 38, category: 'food', emoji: 'ğŸŸ¢', healthBoost: 24, happinessBoost: 14, petType: 'fish' },
                { id: 45, name: 'Snacks mixtos', price: 35, category: 'food', emoji: 'ğŸ¯', healthBoost: 20, happinessBoost: 25 },
                { id: 46, name: 'Comida orgÃ¡nica', price: 55, category: 'food', emoji: 'ğŸ¥¬', healthBoost: 32, happinessBoost: 20 },
                { id: 47, name: 'Suplemento vitamÃ­nico', price: 40, category: 'food', emoji: 'ğŸ’Š', healthBoost: 35, happinessBoost: 10 },
                { id: 48, name: 'Comida energÃ©tica', price: 65, category: 'food', emoji: 'âš¡', healthBoost: 40, happinessBoost: 30 },
                { id: 3, name: 'Juguete ratÃ³n', price: 30, category: 'toy', emoji: 'ğŸ­' },
                { id: 4, name: 'Pecera pequeÃ±a (frÃ­a)', price: 80, category: 'aquarium', emoji: 'ğŸ ', capacity: 3, temperature: 'cold' },
                { id: 5, name: 'Pecera mediana (frÃ­a)', price: 150, category: 'aquarium', emoji: 'ğŸ˜ï¸', capacity: 6, temperature: 'cold' },
                { id: 6, name: 'Pecera grande (frÃ­a)', price: 250, category: 'aquarium', emoji: 'ğŸ°', capacity: 10, temperature: 'cold' },
                { id: 22, name: 'Pecera pequeÃ±a (caliente)', price: 120, category: 'aquarium', emoji: 'ğŸŒ¡ï¸', capacity: 3, temperature: 'warm' },
                { id: 23, name: 'Pecera mediana (caliente)', price: 200, category: 'aquarium', emoji: 'ğŸ”¥', capacity: 6, temperature: 'warm' },
                { id: 24, name: 'Pecera grande (caliente)', price: 320, category: 'aquarium', emoji: 'â™¨ï¸', capacity: 10, temperature: 'warm' },
                { id: 7, name: 'Collar bÃ¡sico', price: 35, category: 'collar', emoji: 'ğŸ”—' },
                { id: 8, name: 'Collar elegante', price: 65, category: 'collar', emoji: 'ğŸ€' },
                { id: 9, name: 'Collar de diamantes', price: 120, category: 'collar', emoji: 'ğŸ’' },
                { id: 10, name: 'Collar con cascabel', price: 45, category: 'collar', emoji: 'ğŸ””' },
                { id: 25, name: 'Collar de cuero', price: 55, category: 'collar', emoji: 'ğŸŸ¤' },
                { id: 26, name: 'Collar con GPS', price: 180, category: 'collar', emoji: 'ğŸ“' },
                { id: 11, name: 'Cama suave', price: 80, category: 'catAccessory', emoji: 'ğŸ›ï¸' },
                { id: 12, name: 'Arenero', price: 60, category: 'catAccessory', emoji: 'ğŸ“¦' },
                { id: 27, name: 'Rascador', price: 90, category: 'catAccessory', emoji: 'ğŸªµ' },
                { id: 13, name: 'Adorno coral', price: 35, category: 'decoration', emoji: 'ğŸª¸' },
                { id: 14, name: 'Castillo acuÃ¡tico', price: 55, category: 'decoration', emoji: 'ğŸ°' },
                { id: 15, name: 'PiÃ±a decorativa', price: 25, category: 'decoration', emoji: 'ğŸ' },
                { id: 16, name: 'Cueva rocosa', price: 40, category: 'decoration', emoji: 'ğŸª¨' },
                { id: 17, name: 'Planta acuÃ¡tica', price: 20, category: 'decoration', emoji: 'ğŸŒ¿' },
                { id: 28, name: 'Tesoro pirata', price: 45, category: 'decoration', emoji: 'ğŸ’°' },
                { id: 29, name: 'Barco hundido', price: 60, category: 'decoration', emoji: 'ğŸš¢' },
                { id: 30, name: 'Algas marinas', price: 18, category: 'decoration', emoji: 'ğŸŒŠ' },
                { id: 18, name: 'Vacuna completa', price: 12, category: 'medicine', emoji: 'ğŸ’‰' },
                { id: 19, name: 'AntibiÃ³tico', price: 20, category: 'medicine', emoji: 'ğŸ’Š' },
                { id: 20, name: 'Vitaminas', price: 15, category: 'medicine', emoji: 'ğŸ§ª' },
                { id: 21, name: 'Antiparasitario', price: 18, category: 'medicine', emoji: 'ğŸ©¹' }
            ],
            availablePets: [],
            virusTypes: [
                { name: 'Resfriado comÃºn', emoji: 'ğŸ¤§', price: 30, severity: 'leve', color: 'text-green-600' },
                { name: 'Fiebre leve', emoji: 'ğŸ¤’', price: 45, severity: 'leve', color: 'text-yellow-600' },
                { name: 'InfecciÃ³n bacteriana', emoji: 'ğŸ¦ ', price: 65, severity: 'moderada', color: 'text-orange-600' },
                { name: 'ParÃ¡sitos intestinales', emoji: 'ğŸ©¸', price: 80, severity: 'moderada', color: 'text-red-600' },
                { name: 'Problemas articulares', emoji: 'ğŸ¦´', price: 95, severity: 'grave', color: 'text-purple-600' },
                { name: 'Problemas cardÃ­acos', emoji: 'ğŸ’”', price: 120, severity: 'grave', color: 'text-pink-600' },
                { name: 'Enfermedad grave', emoji: 'ğŸš¨', price: 150, severity: 'crÃ­tica', color: 'text-red-800' }
            ],
            breeds: {
                cat: [
                    { name: 'SiamÃ©s', emoji: 'ğŸ±', colors: ['crema', 'chocolate', 'seal point'], photo: 'https://images.unsplash.com/photo-1513245543132-31f507417b26?w=300&h=300&fit=crop' },
                    { name: 'Persa', emoji: 'ğŸ˜º', colors: ['blanco', 'gris', 'naranja', 'chinchilla'], photo: 'https://images.unsplash.com/photo-1574144611937-0df059b5ef3e?w=300&h=300&fit=crop' },
                    { name: 'Maine Coon', emoji: 'ğŸ¦', colors: ['marrÃ³n tabby', 'gris', 'rojo'], photo: 'https://images.unsplash.com/photo-1595433707802-6b2626ef1c91?w=300&h=300&fit=crop' },
                    { name: 'BritÃ¡nico', emoji: 'ğŸ˜¸', colors: ['gris azul', 'crema', 'blanco'], photo: 'https://images.unsplash.com/photo-1596854407944-bf87f6fdd49e?w=300&h=300&fit=crop' },
                    { name: 'BengalÃ­', emoji: 'ğŸ…', colors: ['dorado manchado', 'plata manchado', 'marble'], photo: 'https://images.unsplash.com/photo-1606214174585-fe31582cd22c?w=300&h=300&fit=crop' },
                    { name: 'Ragdoll', emoji: 'ğŸ˜»', colors: ['seal point', 'blue point', 'chocolate'], photo: 'https://images.unsplash.com/photo-1571566882372-1598d88abd90?w=300&h=300&fit=crop' },
                    { name: 'Sphynx', emoji: 'ğŸ™€', colors: ['rosa', 'gris', 'negro'], photo: 'https://images.unsplash.com/photo-1583337130417-3346a1be7dee?w=300&h=300&fit=crop' },
                    { name: 'Abisinio', emoji: 'ğŸ˜¾', colors: ['canela', 'rojizo', 'azul'], photo: 'https://images.unsplash.com/photo-1592194996308-7b43878e84a6?w=300&h=300&fit=crop' },
                    { name: 'Ruso Azul', emoji: 'ğŸ’™', colors: ['azul plateado', 'gris azul'], photo: 'https://images.unsplash.com/photo-1518791841217-8f162f1e1131?w=300&h=300&fit=crop' },
                    { name: 'Noruego', emoji: 'â„ï¸', colors: ['marrÃ³n tabby', 'blanco', 'negro'], photo: 'https://images.unsplash.com/photo-1472491235688-bdc81a63246e?w=300&h=300&fit=crop' },
                    { name: 'Scottish Fold', emoji: 'ğŸ¥°', colors: ['gris', 'crema', 'tabby'], photo: 'https://images.unsplash.com/photo-1541781774459-bb2af2f05b55?w=300&h=300&fit=crop' },
                    { name: 'Munchkin', emoji: 'ğŸ¾', colors: ['multicolor', 'tabby', 'sÃ³lido'], photo: 'https://images.unsplash.com/photo-1548247416-ec66f4900b2e?w=300&h=300&fit=crop' }
                ],
                fish: {
                    coldWater: [
                        { name: 'Goldfish', emoji: 'ğŸ ', colors: ['dorado', 'naranja', 'blanco', 'rojo'], photo: 'https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=300&h=300&fit=crop', temperature: 'cold' },
                        { name: 'Cometa', emoji: 'â˜„ï¸', colors: ['dorado brillante', 'naranja cometa', 'rojo cola larga'], photo: 'https://images.unsplash.com/photo-1520637836862-4d197d17c90a?w=300&h=300&fit=crop', temperature: 'cold' }
                    ],
                    warmWater: [
                        { name: 'Cebra', emoji: 'ğŸ¦“', colors: ['rayado negro', 'azul rayado', 'plateado rayado'], photo: 'https://images.unsplash.com/photo-1535591273668-578e31182c4f?w=300&h=300&fit=crop', temperature: 'warm' },
                        { name: 'Nemo', emoji: 'ğŸ¤¡', colors: ['naranja con blanco', 'rojo con blanco'], photo: 'https://images.unsplash.com/photo-1583212292454-1fe6229603b7?w=300&h=300&fit=crop', temperature: 'warm' }
                    ]
                }
            },
            petNames: {
                cat: {
                    male: ['Simba', 'Garfield', 'FÃ©lix', 'Shadow', 'Tiger', 'Smokey', 'Max', 'Charlie', 'Leo', 'Milo'],
                    female: ['Luna', 'Nala', 'Bella', 'Mittens', 'Coco', 'Mia', 'Chloe', 'Sophie', 'Lily', 'Zoe']
                },
                fish: {
                    male: ['Nemo', 'Finn', 'Neptuno', 'Azul', 'Dorado', 'Cristal', 'OcÃ©ano', 'Splash', 'Aqua', 'Coral'],
                    female: ['Dory', 'Marina', 'Perla', 'Estrella', 'Sirena', 'Burbuja', 'Coral', 'Aqua', 'Luna', 'Bella']
                }
            }
        };

        // Initialize game
        document.addEventListener('DOMContentLoaded', function() {
            loadGameData();
            initializeGame();
            startGameTime();
            generateInitialPets();
        });

        function loadGameData() {
            const savedData = localStorage.getItem('catsFishGameData');
            if (savedData) {
                const parsed = JSON.parse(savedData);
                gameState.users = parsed.users || {};
                gameState.gameTime = parsed.gameTime || gameState.gameTime;
                gameState.availablePets = parsed.availablePets || [];
            }
            
            // Create admin account if it doesn't exist
            if (!gameState.users['admin']) {
                gameState.users['admin'] = {
                    password: 'GAME-ADMIN',
                    isAdmin: true,
                    coins: 5000,
                    pets: [],
                    aquariums: [],
                    catAccessories: [],
                    litters: [],
                    inventory: {
                        'Comida para gatos': 5,
                        'Comida para peces': 5,
                        'Medicina bÃ¡sica': 3,
                        'Vitaminas': 2,
                        'Pecera grande (frÃ­a)': 1,
                        'Rascador': 1,
                        'Arenero': 1,
                        'Adorno coral': 2
                    }
                };
            }
        }

        function saveGameData() {
            const dataToSave = {
                users: gameState.users,
                gameTime: gameState.gameTime,
                availablePets: gameState.availablePets
            };
            localStorage.setItem('catsFishGameData', JSON.stringify(dataToSave));
        }

        function initializeGame() {
            // Event listeners
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
            document.getElementById('createAccountBtn').addEventListener('click', showCreateAccountModal);
            document.getElementById('createAccountForm').addEventListener('submit', handleCreateAccount);
            document.getElementById('cancelCreateBtn').addEventListener('click', hideCreateAccountModal);
            document.getElementById('logoutBtn').addEventListener('click', logout);
            
            // Navigation buttons
            document.getElementById('homeBtn').addEventListener('click', () => showSection('home'));
            document.getElementById('shopBtn').addEventListener('click', () => showSection('shop'));
            document.getElementById('shelterBtn').addEventListener('click', () => showSection('shelter'));
            document.getElementById('vetBtn').addEventListener('click', () => showSection('vet'));
            document.getElementById('workBtn').addEventListener('click', () => showSection('work'));
            document.getElementById('transportBtn').addEventListener('click', () => showSection('transport'));
            document.getElementById('adminBtn').addEventListener('click', () => showSection('admin'));

            updateDisplay();
        }

        function generateInitialPets() {
            if (gameState.availablePets.length < 3) {
                for (let i = 0; i < 5; i++) {
                    addRandomPetToShelter();
                }
            }
        }

        function handleLogin(e) {
            e.preventDefault();
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();

            if (!username || !password) {
                alert('Por favor completa todos los campos');
                return;
            }

            // Check if user exists, if not create account automatically
            if (!gameState.users[username]) {
                // Create new account automatically
                gameState.users[username] = {
                    password: password,
                    isAdmin: username === 'admin',
                    coins: 1000,
                    pets: [],
                    aquariums: [],
                    catAccessories: [],
                    activeJobs: [],
                    breedingProjects: [],
                    litters: [],
                    inventory: {
                        'Comida para gatos': 3,
                        'Comida para peces': 3,
                        'Vitaminas': 2
                    }
                };
                saveGameData();
                console.log('Nueva cuenta creada para:', username);
            }

            // Login user
            const user = gameState.users[username];
            if (user && user.password === password) {
                gameState.currentUser = username;
                
                // Initialize missing properties
                if (!user.activeJobs) user.activeJobs = [];
                if (!user.breedingProjects) user.breedingProjects = [];
                if (!user.litters) user.litters = [];
                if (!user.aquariums) user.aquariums = [];
                if (!user.catAccessories) user.catAccessories = [];
                if (!user.inventory) user.inventory = {};
                
                // Hide login screen and show game
                document.getElementById('loginScreen').classList.add('hidden');
                document.getElementById('gameScreen').classList.remove('hidden');
                
                // Show admin button if admin
                if (user.isAdmin) {
                    document.getElementById('adminBtn').classList.remove('hidden');
                }
                
                // Clear form
                document.getElementById('username').value = '';
                document.getElementById('password').value = '';
                
                // Update displays
                updateDisplay();
                showSection('home');
                saveGameData();
                
                console.log('Usuario logueado:', username);
            } else {
                alert('Error en el login. Intenta de nuevo.');
            }
        }

        function showCreateAccountModal() {
            document.getElementById('createAccountModal').classList.remove('hidden');
        }

        function hideCreateAccountModal() {
            document.getElementById('createAccountModal').classList.add('hidden');
            // Clear form
            document.getElementById('newUsername').value = '';
            document.getElementById('newPassword').value = '';
        }

        function handleCreateAccount(e) {
            e.preventDefault();
            const username = document.getElementById('newUsername').value.trim();
            const password = document.getElementById('newPassword').value.trim();
            
            if (!username || !password) {
                alert('Por favor completa todos los campos');
                return;
            }
            
            if (gameState.users[username]) {
                alert('Este usuario ya existe');
                return;
            }
            
            if (!password.startsWith('GAME-')) {
                alert('La contraseÃ±a debe comenzar con GAME-');
                return;
            }
            
            if (password.length < 6) {
                alert('La contraseÃ±a debe tener al menos 6 caracteres');
                return;
            }
            
            gameState.users[username] = {
                password: password,
                isAdmin: false,
                coins: 1000,
                pets: [],
                aquariums: [],
                catAccessories: [],
                litters: [],
                inventory: {
                    'Comida para gatos': 3,
                    'Comida para peces': 3,
                    'Vitaminas': 2
                }
            };
            
            saveGameData();
            hideCreateAccountModal();
            alert('Â¡Cuenta creada exitosamente! Ya puedes iniciar sesiÃ³n.');
        }

        function logout() {
            gameState.currentUser = null;
            document.getElementById('loginScreen').classList.remove('hidden');
            document.getElementById('gameScreen').classList.add('hidden');
            document.getElementById('adminBtn').classList.add('hidden');
        }

        function showSection(section) {
            // Hide all sections
            const sections = ['home', 'shop', 'shelter', 'vet', 'work', 'transport', 'admin'];
            sections.forEach(s => {
                document.getElementById(s + 'Section').classList.add('hidden');
            });
            
            // Show selected section
            document.getElementById(section + 'Section').classList.remove('hidden');
            
            // Update section content
            switch(section) {
                case 'home':
                    updatePetsDisplay();
                    updateInventoryDisplay();
                    updateLittersHomeDisplay();
                    break;
                case 'shop':
                    updateShopDisplay();
                    break;
                case 'shelter':
                    updateShelterDisplay();
                    break;
                case 'vet':
                    updateVetDisplay();
                    break;
                case 'work':
                    updateWorkDisplay();
                    break;
                case 'admin':
                    updateAdminDisplay();
                    break;
            }
        }

        function updateDisplay() {
            if (!gameState.currentUser) return;
            
            const user = gameState.users[gameState.currentUser];
            document.getElementById('userWelcome').textContent = `Bienvenido, ${gameState.currentUser}`;
            document.getElementById('userCoins').textContent = user.coins;
            document.getElementById('gameTime').textContent = `${gameState.gameTime.hour}:00h - DÃ­a ${gameState.gameTime.day}, Mes ${gameState.gameTime.month}, AÃ±o ${gameState.gameTime.year}`;
        }

        function updatePetsDisplay() {
            const user = gameState.users[gameState.currentUser];
            updateCatsDisplay();
            updateAquariumsDisplay();
            updateCatAccessoriesDisplay();
        }

        function updateCatsDisplay() {
            const user = gameState.users[gameState.currentUser];
            const cats = user.pets.filter(pet => pet.type === 'cat');
            const container = document.getElementById('catsContainer');
            const noMessage = document.getElementById('noCatsMessage');
            
            if (cats.length === 0) {
                container.innerHTML = '';
                noMessage.classList.remove('hidden');
                return;
            }
            
            noMessage.classList.add('hidden');
            container.innerHTML = cats.map(pet => {
                const health = Math.round(pet.health * 10) / 10;
                const happiness = Math.round(pet.happiness * 10) / 10;
                const age = Math.round(pet.age * 10) / 10;
                const breedData = gameState.breeds.cat.find(b => b.name === pet.breed);
                
                // Show virus info if pet is sick
                const virusInfo = pet.virus ? `
                    <div class="mt-2 p-2 bg-red-50 rounded border border-red-200">
                        <p class="text-red-600 text-xs font-medium">${pet.virus.emoji} ${pet.virus.name}</p>
                        <p class="text-red-500 text-xs">Costo tratamiento: ${pet.virus.price} ğŸª™</p>
                    </div>
                ` : '';
                
                // Show if pet is a baby
                const babyInfo = pet.isBaby ? `
                    <div class="mt-2 p-2 bg-yellow-50 rounded border border-yellow-200">
                        <p class="text-yellow-600 text-xs font-medium baby-pet">ğŸ¼ BebÃ© (${Math.round((pet.growthTime - Date.now()) / 3600000)} horas para crecer)</p>
                    </div>
                ` : '';
                
                return `
                <div class="pet-card bg-white rounded-xl shadow-sm p-4 cursor-pointer" onclick="showPetDetails('${pet.id}')">
                    <div class="text-center">
                        <div class="w-20 h-20 mx-auto mb-3 rounded-full overflow-hidden bg-gray-200">
                            <img src="${breedData?.photo || ''}" alt="${pet.name}" class="w-full h-full object-cover" 
                                 onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                            <div class="text-4xl pt-4 hidden">${pet.emoji}</div>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-1">${pet.name}</h3>
                        <p class="text-xs text-gray-600 mb-1">${pet.gender === 'male' ? 'â™‚ï¸' : 'â™€ï¸'} ${pet.breed}</p>
                        <p class="text-xs text-gray-500 mb-2">${pet.color} â€¢ ${age} ${age === 1 ? 'mes' : 'meses'}</p>
                        ${pet.collar ? `<p class="text-purple-600 text-xs mb-2">ğŸ€ ${pet.collar}</p>` : ''}
                        
                        <div class="space-y-1">
                            <div class="flex items-center justify-between text-xs">
                                <span>Salud:</span>
                                <span class="${health > 70 ? 'text-green-600' : health > 40 ? 'text-yellow-600' : 'text-red-600'}">${health}%</span>
                            </div>
                            <div class="flex items-center justify-between text-xs">
                                <span>Felicidad:</span>
                                <span class="${happiness > 70 ? 'text-green-600' : happiness > 40 ? 'text-yellow-600' : 'text-red-600'}">${happiness}%</span>
                            </div>
                        </div>
                        
                        ${virusInfo}
                        ${babyInfo}
                    </div>
                </div>
            `;
            }).join('');
        }

        function updateCatAccessoriesDisplay() {
            const user = gameState.users[gameState.currentUser];
            const container = document.getElementById('catAccessoriesContainer');
            const noMessage = document.getElementById('noCatAccessoriesMessage');
            
            if (!user.catAccessories || user.catAccessories.length === 0) {
                container.innerHTML = '';
                noMessage.classList.remove('hidden');
                return;
            }
            
            noMessage.classList.add('hidden');
            container.innerHTML = user.catAccessories.map(accessory => `
                <div class="flex items-center justify-between p-3 bg-orange-50 rounded-lg">
                    <div class="flex items-center space-x-3">
                        <span class="text-2xl">${accessory.emoji}</span>
                        <span class="font-medium text-gray-800">${accessory.name}</span>
                    </div>
                    <button onclick="removeCatAccessory('${accessory.id}')" class="text-red-500 hover:text-red-700 text-sm">
                        Quitar
                    </button>
                </div>
            `).join('');
        }

        function updateAquariumsDisplay() {
            const user = gameState.users[gameState.currentUser];
            const container = document.getElementById('aquariumsContainer');
            const noMessage = document.getElementById('noAquariumsMessage');
            
            if (!user.aquariums || user.aquariums.length === 0) {
                container.innerHTML = '';
                noMessage.classList.remove('hidden');
                return;
            }
            
            noMessage.classList.add('hidden');
            container.innerHTML = user.aquariums.map(aquarium => {
                const fish = user.pets.filter(pet => pet.aquariumId === aquarium.id);
                const capacity = aquarium.capacity;
                const used = fish.length;
                const decorations = aquarium.decorations || [];
                const tempIcon = aquarium.temperature === 'warm' ? 'ğŸŒ¡ï¸' : 'â„ï¸';
                const tempText = aquarium.temperature === 'warm' ? 'Caliente' : 'FrÃ­a';
                
                return `
                <div class="bg-white rounded-xl shadow-sm p-4">
                    <div class="flex justify-between items-center mb-3">
                        <div>
                            <h4 class="font-semibold text-gray-800">${aquarium.emoji} ${aquarium.name}</h4>
                            <p class="text-xs text-gray-500">${tempIcon} Agua ${tempText}</p>
                        </div>
                        <span class="text-sm text-gray-600">${used}/${capacity} peces</span>
                    </div>
                    
                    <!-- Aquarium Visual -->
                    <div class="relative bg-gradient-to-b from-blue-100 to-blue-200 rounded-lg p-3 mb-3 min-h-[120px] border-4 border-blue-300">
                        <!-- Decorations at bottom -->
                        <div class="absolute bottom-2 left-2 right-2 flex justify-center space-x-1">
                            ${decorations.map(decoration => `
                                <span class="text-lg" title="${decoration}">${gameState.shopItems.find(item => item.name === decoration)?.emoji || 'ğŸ¨'}</span>
                            `).join('')}
                        </div>
                        
                        <!-- Fish swimming -->
                        <div class="grid grid-cols-5 gap-1 h-full">
                            ${fish.map(pet => {
                                const allFish = [...gameState.breeds.fish.coldWater, ...gameState.breeds.fish.warmWater];
                                const breedData = allFish.find(b => b.name === pet.breed);
                                return `
                                <div class="text-center cursor-pointer flex flex-col justify-center" onclick="showPetDetails('${pet.id}')">
                                    <div class="w-8 h-8 mx-auto mb-1 rounded-full overflow-hidden bg-blue-50">
                                        <img src="${breedData?.photo || ''}" alt="${pet.name}" class="w-full h-full object-cover" 
                                             onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                                        <div class="text-sm pt-1 hidden">${pet.emoji}</div>
                                    </div>
                                    <p class="text-xs text-gray-700">${pet.name}</p>
                                    <p class="text-xs text-gray-500">${pet.gender === 'male' ? 'â™‚ï¸' : 'â™€ï¸'}</p>
                                    ${pet.virus ? `<p class="text-xs text-red-500">${pet.virus.emoji}</p>` : ''}
                                    ${pet.isBaby ? `<p class="text-xs text-yellow-500 baby-pet">ğŸ¼</p>` : ''}
                                </div>
                            `}).join('')}
                            ${Array(capacity - used).fill().map(() => `
                                <div class="w-8 h-8 mx-auto border-2 border-dashed border-blue-300 rounded-full flex items-center justify-center">
                                    <span class="text-blue-400 text-xs">+</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-3 gap-2 text-xs">
                        <button onclick="addFishToAquarium('${aquarium.id}')" 
                                class="bg-blue-500 text-white py-1 px-2 rounded hover:bg-blue-600 ${used >= capacity ? 'opacity-50 cursor-not-allowed' : ''}"
                                ${used >= capacity ? 'disabled' : ''}>
                            + Pez
                        </button>
                        <button onclick="decorateAquarium('${aquarium.id}')" class="bg-green-500 text-white py-1 px-2 rounded hover:bg-green-600">
                            ğŸ¨ Decorar
                        </button>
                        <button onclick="removeAquarium('${aquarium.id}')" class="bg-red-500 text-white py-1 px-2 rounded hover:bg-red-600">
                            Quitar
                        </button>
                    </div>
                </div>
            `;
            }).join('');
        }

        function updateLittersHomeDisplay() {
            const user = gameState.users[gameState.currentUser];
            const container = document.getElementById('littersHomeContainer');
            const noMessage = document.getElementById('noLittersHomeMessage');
            
            if (!user.litters || user.litters.length === 0) {
                container.innerHTML = '';
                noMessage.classList.remove('hidden');
                return;
            }
            
            noMessage.classList.add('hidden');
            container.innerHTML = user.litters.map(litter => {
                const timeLeft = Math.max(0, Math.ceil((litter.readyTime - Date.now()) / 3600000)); // hours
                const isReady = timeLeft === 0;
                
                return `
                <div class="litter-card rounded-xl shadow-sm p-4">
                    <div class="flex justify-between items-center mb-3">
                        <div>
                            <h4 class="font-semibold text-gray-800">${litter.type === 'cat' ? 'ğŸ±' : 'ğŸ '} Camada de ${litter.type === 'cat' ? 'Gatitos' : 'Alevines'}</h4>
                            <p class="text-sm text-gray-600">${litter.count} bebÃ©s â€¢ ${litter.breed}</p>
                        </div>
                        <div class="text-right">
                            ${isReady ? 
                                `<button onclick="collectLitter('${litter.id}')" class="bg-green-500 text-white px-3 py-1 rounded-lg hover:bg-green-600 text-sm">
                                    Â¡Listos!
                                </button>` :
                                `<p class="text-sm text-orange-600">${timeLeft}h restantes</p>`
                            }
                        </div>
                    </div>
                    
                    <div class="flex justify-center space-x-2 mb-3">
                        ${Array(litter.count).fill().map(() => `
                            <span class="text-2xl baby-pet">${litter.type === 'cat' ? 'ğŸ±' : 'ğŸ '}</span>
                        `).join('')}
                    </div>
                    
                    <div class="text-center">
                        <p class="text-xs text-gray-600">Los bebÃ©s crecerÃ¡n en ${litter.type === 'cat' ? '24' : '12'} horas despuÃ©s de nacer</p>
                    </div>
                </div>
            `;
            }).join('');
        }

        function updateInventoryDisplay() {
            const user = gameState.users[gameState.currentUser];
            const container = document.getElementById('inventoryList');
            
            const items = Object.entries(user.inventory).filter(([name, quantity]) => quantity > 0);
            
            if (items.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center">Inventario vacÃ­o</p>';
                return;
            }
            
            container.innerHTML = items.map(([name, quantity]) => {
                const item = gameState.shopItems.find(i => i.name === name);
                const emoji = item ? item.emoji : 'ğŸ“¦';
                
                return `
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <span class="text-2xl">${emoji}</span>
                            <span class="font-medium text-gray-800">${name}</span>
                        </div>
                        <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-sm font-medium">${quantity}</span>
                    </div>
                `;
            }).join('');
        }

        function updateShopDisplay() {
            const container = document.getElementById('shopSection');
            const itemsGrid = container.querySelector('.grid') || container;
            
            itemsGrid.innerHTML = gameState.shopItems.map(item => `
                <div class="shop-item bg-white rounded-xl shadow-sm p-6 text-center">
                    <div class="text-4xl mb-4">${item.emoji}</div>
                    <h3 class="font-semibold text-gray-800 mb-2">${item.name}</h3>
                    <p class="text-2xl font-bold text-green-600 mb-4">${item.price} ğŸª™</p>
                    <button onclick="buyItem(${item.id})" class="w-full bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition duration-200">
                        Comprar
                    </button>
                </div>
            `).join('');
        }

        function updateShelterDisplay() {
            const container = document.getElementById('shelterSection');
            const petsGrid = container.querySelector('.grid') || container;
            
            if (gameState.availablePets.length === 0) {
                petsGrid.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <div class="text-6xl mb-4">ğŸ </div>
                        <h3 class="text-xl font-semibold text-gray-700 mb-2">No hay mascotas disponibles</h3>
                        <p class="text-gray-500">Vuelve mÃ¡s tarde, llegan nuevas mascotas cada hora</p>
                    </div>
                `;
                return;
            }
            
            petsGrid.innerHTML = gameState.availablePets.map(pet => {
                const health = Math.round(pet.health * 10) / 10;
                const happiness = Math.round(pet.happiness * 10) / 10;
                const age = Math.round(pet.age * 10) / 10;
                
                let breedData;
                if (pet.type === 'cat') {
                    breedData = gameState.breeds.cat.find(b => b.name === pet.breed);
                } else {
                    const allFish = [...gameState.breeds.fish.coldWater, ...gameState.breeds.fish.warmWater];
                    breedData = allFish.find(b => b.name === pet.breed);
                }
                
                const tempRequirement = pet.temperature ? 
                    `<p class="text-blue-600 text-xs mb-2">${pet.temperature === 'warm' ? 'ğŸŒ¡ï¸ Agua caliente' : 'â„ï¸ Agua frÃ­a'}</p>` : '';
                
                return `
                <div class="bg-white rounded-xl shadow-sm p-6 text-center">
                    <div class="w-24 h-24 mx-auto mb-4 rounded-full overflow-hidden bg-gray-200">
                        <img src="${breedData?.photo || ''}" alt="${pet.name}" class="w-full h-full object-cover" 
                             onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                        <div class="text-6xl pt-4 hidden">${pet.emoji}</div>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-800 mb-2">${pet.name}</h3>
                    <p class="text-gray-600 mb-1">${pet.gender === 'male' ? 'â™‚ï¸' : 'â™€ï¸'} ${pet.breed}</p>
                    <p class="text-gray-500 mb-4">${pet.color} â€¢ ${age} ${age === 1 ? 'mes' : 'meses'}</p>
                    
                    <div class="mb-4 space-y-2">
                        <div class="flex justify-between text-sm">
                            <span>Salud:</span>
                            <span class="${health > 70 ? 'text-green-600' : health > 40 ? 'text-yellow-600' : 'text-red-600'}">${health}%</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span>Felicidad:</span>
                            <span class="${happiness > 70 ? 'text-green-600' : happiness > 40 ? 'text-yellow-600' : 'text-red-600'}">${happiness}%</span>
                        </div>
                    </div>
                    
                    ${pet.type === 'fish' ? '<p class="text-orange-600 text-xs mb-2">âš ï¸ Requiere pecera instalada</p>' : ''}
                    ${tempRequirement}
                    
                    <button onclick="adoptPet(${pet.id})" class="w-full bg-purple-500 text-white py-2 rounded-lg hover:bg-purple-600 transition duration-200">
                        Adoptar (+${pet.type === 'cat' ? '250' : '100'} ğŸª™)
                    </button>
                </div>
            `;
            }).join('');
        }

        function updateVetDisplay() {
            const user = gameState.users[gameState.currentUser];
            const sickPets = user.pets.filter(pet => pet.health < 80 || pet.virus);
            const sickContainer = document.getElementById('sickPetsList');
            const noSickMessage = document.getElementById('noSickPets');
            
            if (sickPets.length === 0) {
                sickContainer.innerHTML = '';
                noSickMessage.classList.remove('hidden');
                return;
            }
            
            noSickMessage.classList.add('hidden');
            sickContainer.innerHTML = sickPets.map(pet => {
                // Determine treatment cost
                let treatmentCost = 25; // Base consultation
                let diagnosis = 'Consulta general';
                let diagnosisEmoji = 'ğŸ”';
                let severityColor = 'text-gray-600';
                
                if (pet.virus) {
                    treatmentCost = pet.virus.price;
                    diagnosis = pet.virus.name;
                    diagnosisEmoji = pet.virus.emoji;
                    severityColor = pet.virus.color;
                } else if (pet.health < 50) {
                    // Assign random virus based on health level
                    const availableViruses = gameState.virusTypes.filter(virus => {
                        if (pet.health < 30) return virus.severity === 'crÃ­tica' || virus.severity === 'grave';
                        if (pet.health < 50) return virus.severity === 'grave' || virus.severity === 'moderada';
                        return virus.severity === 'moderada' || virus.severity === 'leve';
                    });
                    
                    if (availableViruses.length > 0) {
                        const randomVirus = availableViruses[Math.floor(Math.random() * availableViruses.length)];
                        pet.virus = randomVirus;
                        treatmentCost = randomVirus.price;
                        diagnosis = randomVirus.name;
                        diagnosisEmoji = randomVirus.emoji;
                        severityColor = randomVirus.color;
                    }
                }
                
                return `
                <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-4">
                            <span class="text-3xl">${pet.emoji}</span>
                            <div>
                                <h4 class="font-semibold text-gray-800">${pet.name}</h4>
                                <p class="text-sm text-gray-600">Salud: ${Math.round(pet.health)}%</p>
                                <p class="text-sm ${severityColor} font-medium">${diagnosisEmoji} ${diagnosis}</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <p class="text-lg font-bold text-red-600 mb-2">${treatmentCost} ğŸª™</p>
                            <button onclick="treatPet('${pet.id}')" class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600">
                                Tratar
                            </button>
                        </div>
                    </div>
                </div>
            `;
            }).join('');
        }

        function updateWorkDisplay() {
            updateLittersDisplay();
        }

        function updateLittersDisplay() {
            const user = gameState.users[gameState.currentUser];
            const container = document.getElementById('littersContainer');
            const noMessage = document.getElementById('noLittersMessage');
            
            if (!user.litters || user.litters.length === 0) {
                container.innerHTML = '';
                noMessage.classList.remove('hidden');
                return;
            }
            
            noMessage.classList.add('hidden');
            container.innerHTML = user.litters.map(litter => {
                const timeLeft = Math.max(0, Math.ceil((litter.readyTime - Date.now()) / 3600000)); // hours
                const isReady = timeLeft === 0;
                
                return `
                <div class="litter-card rounded-xl shadow-sm p-6">
                    <div class="flex justify-between items-center mb-4">
                        <div>
                            <h4 class="text-xl font-semibold text-gray-800">${litter.type === 'cat' ? 'ğŸ±' : 'ğŸ '} Camada de ${litter.type === 'cat' ? 'Gatitos' : 'Alevines'}</h4>
                            <p class="text-gray-600">${litter.count} bebÃ©s â€¢ Raza: ${litter.breed}</p>
                            <p class="text-sm text-gray-500">Padres: ${litter.parents.join(' y ')}</p>
                        </div>
                        <div class="text-right">
                            ${isReady ? 
                                `<button onclick="collectLitter('${litter.id}')" class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600">
                                    ğŸ¼ Recoger BebÃ©s
                                </button>` :
                                `<div class="text-center">
                                    <p class="text-lg font-bold text-orange-600">${timeLeft}h</p>
                                    <p class="text-sm text-gray-600">restantes</p>
                                </div>`
                            }
                        </div>
                    </div>
                    
                    <div class="bg-white bg-opacity-50 rounded-lg p-4 mb-4">
                        <div class="flex justify-center space-x-3 mb-3">
                            ${Array(litter.count).fill().map((_, index) => `
                                <div class="text-center">
                                    <span class="text-3xl baby-pet">${litter.type === 'cat' ? 'ğŸ±' : 'ğŸ '}</span>
                                    <p class="text-xs text-gray-600">${litter.babyNames[index]}</p>
                                </div>
                            `).join('')}
                        </div>
                        
                        <div class="text-center">
                            <p class="text-sm text-gray-600 mb-2">
                                ${isReady ? 
                                    'Â¡Los bebÃ©s estÃ¡n listos para unirse a tu familia!' : 
                                    `Los bebÃ©s nacerÃ¡n en ${timeLeft} horas`
                                }
                            </p>
                            <p class="text-xs text-gray-500">
                                DespuÃ©s de nacer, crecerÃ¡n en ${litter.type === 'cat' ? '24' : '12'} horas mÃ¡s
                            </p>
                        </div>
                    </div>
                    
                    <div class="flex justify-between items-center text-sm">
                        <span class="text-gray-600">Iniciado: ${new Date(litter.startTime).toLocaleString()}</span>
                        <span class="text-gray-600">ID: ${litter.id.slice(-6)}</span>
                    </div>
                </div>
            `;
            }).join('');
        }

        function updateAdminDisplay() {
            if (!gameState.users[gameState.currentUser].isAdmin) return;
            
            // Update breeds list
            const breedsList = document.getElementById('breedsList');
            breedsList.innerHTML = Object.entries(gameState.breeds).map(([type, breeds]) => `
                <div class="p-3 bg-gray-50 rounded-lg">
                    <h4 class="font-semibold text-gray-800 mb-2">${type === 'cat' ? 'Gatos' : 'Peces'}:</h4>
                    <p class="text-sm text-gray-600">${breeds.join(', ')}</p>
                </div>
            `).join('');
            
            // Update shop items list
            const shopItemsList = document.getElementById('shopItemsList');
            shopItemsList.innerHTML = gameState.shopItems.map(item => `
                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                    <div class="flex items-center space-x-3">
                        <span class="text-xl">${item.emoji}</span>
                        <span class="font-medium">${item.name}</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <span class="text-green-600 font-semibold">${item.price} ğŸª™</span>
                        <button onclick="removeShopItem(${item.id})" class="text-red-500 hover:text-red-700">
                            âŒ
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Breeding and Litter Functions
        function startBreeding(type) {
            const user = gameState.users[gameState.currentUser];
            const cost = type === 'cat' ? 200 : 100;
            
            if (user.coins < cost) {
                alert(`No tienes suficientes monedas (${cost} ğŸª™)`);
                return;
            }
            
            // Check if user has pets of this type
            const availablePets = user.pets.filter(pet => 
                pet.type === type && 
                !pet.isBaby && 
                pet.health > 70 && 
                pet.happiness > 60
            );
            
            if (availablePets.length < 2) {
                const typeText = type === 'cat' ? 'gatos' : 'peces';
                alert(`Necesitas al menos 2 ${typeText} adultos, sanos y felices para la crÃ­a`);
                return;
            }
            
            // Deduct cost
            user.coins -= cost;
            
            // Create breeding project
            const duration = type === 'cat' ? 12 : 6; // hours
            const count = type === 'cat' ? 
                Math.floor(Math.random() * 4) + 1 : // 1-4 kittens
                Math.floor(Math.random() * 6) + 3;   // 3-8 fry
            
            // Select random parents
            const parent1 = availablePets[Math.floor(Math.random() * availablePets.length)];
            const parent2 = availablePets.filter(p => p.id !== parent1.id)[Math.floor(Math.random() * (availablePets.length - 1))];
            
            // Generate baby names
            const babyNames = [];
            for (let i = 0; i < count; i++) {
                const gender = Math.random() < 0.5 ? 'male' : 'female';
                const names = gameState.petNames[type][gender];
                babyNames.push(names[Math.floor(Math.random() * names.length)]);
            }
            
            const litter = {
                id: Date.now().toString(),
                type: type,
                breed: parent1.breed, // Inherit from first parent
                count: count,
                parents: [parent1.name, parent2.name],
                parentIds: [parent1.id, parent2.id],
                babyNames: babyNames,
                startTime: Date.now(),
                readyTime: Date.now() + (duration * 3600000), // Convert hours to milliseconds
                colors: [parent1.color, parent2.color] // For color inheritance
            };
            
            user.litters.push(litter);
            
            updateDisplay();
            updateWorkDisplay();
            saveGameData();
            
            const typeText = type === 'cat' ? 'gatitos' : 'alevines';
            alert(`Â¡Proyecto de crÃ­a iniciado! ${parent1.name} y ${parent2.name} tendrÃ¡n ${count} ${typeText} en ${duration} horas.`);
        }

        function collectLitter(litterId) {
            const user = gameState.users[gameState.currentUser];
            const litter = user.litters.find(l => l.id === litterId);
            
            if (!litter) return;
            
            // Check if litter is ready
            if (Date.now() < litter.readyTime) {
                alert('Los bebÃ©s aÃºn no estÃ¡n listos');
                return;
            }
            
            // Create baby pets
            const newPets = [];
            for (let i = 0; i < litter.count; i++) {
                const gender = Math.random() < 0.5 ? 'male' : 'female';
                const color = litter.colors[Math.floor(Math.random() * litter.colors.length)];
                
                let breedData;
                if (litter.type === 'cat') {
                    breedData = gameState.breeds.cat.find(b => b.name === litter.breed);
                } else {
                    const allFish = [...gameState.breeds.fish.coldWater, ...gameState.breeds.fish.warmWater];
                    breedData = allFish.find(b => b.name === litter.breed);
                }
                
                const baby = {
                    id: Date.now().toString() + '_' + i,
                    name: litter.babyNames[i],
                    type: litter.type,
                    breed: litter.breed,
                    color: color,
                    gender: gender,
                    emoji: breedData?.emoji || (litter.type === 'cat' ? 'ğŸ±' : 'ğŸ '),
                    temperature: breedData?.temperature,
                    age: 0.1, // Very young
                    health: Math.random() * 20 + 80, // 80-100%
                    happiness: Math.random() * 20 + 80, // 80-100%
                    isBaby: true,
                    growthTime: Date.now() + (litter.type === 'cat' ? 24 : 12) * 3600000, // Growth time
                    adoptedAt: gameState.gameTime,
                    parents: litter.parentIds
                };
                
                // For fish, assign to compatible aquarium
                if (litter.type === 'fish') {
                    const compatibleAquariums = user.aquariums.filter(aq => {
                        const fishInAquarium = user.pets.filter(p => p.aquariumId === aq.id).length;
                        return fishInAquarium < aq.capacity && aq.temperature === baby.temperature;
                    });
                    
                    if (compatibleAquariums.length > 0) {
                        baby.aquariumId = compatibleAquariums[0].id;
                    } else {
                        // If no space, keep as inventory item temporarily
                        baby.needsAquarium = true;
                    }
                }
                
                newPets.push(baby);
            }
            
            // Add babies to user's pets
            user.pets.push(...newPets);
            
            // Remove litter from active litters
            user.litters = user.litters.filter(l => l.id !== litterId);
            
            // Give coins as reward
            const reward = litter.type === 'cat' ? litter.count * 50 : litter.count * 25;
            user.coins += reward;
            
            updateDisplay();
            updatePetsDisplay();
            updateWorkDisplay();
            saveGameData();
            
            const typeText = litter.type === 'cat' ? 'gatitos' : 'alevines';
            alert(`Â¡Felicidades! Has recibido ${litter.count} ${typeText} bebÃ©s. Recibes ${reward} monedas de recompensa. Los bebÃ©s crecerÃ¡n en ${litter.type === 'cat' ? '24' : '12'} horas.`);
        }

        // Game Actions
        function buyItem(itemId) {
            const user = gameState.users[gameState.currentUser];
            const item = gameState.shopItems.find(i => i.id === itemId);
            
            if (!item) return;
            
            if (user.coins < item.price) {
                alert('No tienes suficientes monedas');
                return;
            }
            
            user.coins -= item.price;
            user.inventory[item.name] = (user.inventory[item.name] || 0) + 1;
            
            updateDisplay();
            updateInventoryDisplay();
            saveGameData();
            
            alert(`Â¡Has comprado ${item.name}!`);
        }

        function adoptPet(petId) {
            const user = gameState.users[gameState.currentUser];
            const pet = gameState.availablePets.find(p => p.id === petId);
            
            if (!pet) return;
            
            // Check if user has space for fish
            if (pet.type === 'fish') {
                if (!user.aquariums || user.aquariums.length === 0) {
                    alert('Â¡Necesitas instalar una pecera primero! Ve a Acciones RÃ¡pidas â†’ Instalar Pecera.');
                    return;
                }
                
                // Check if there's a compatible aquarium (temperature match)
                const compatibleAquariums = user.aquariums.filter(aq => {
                    const fishInAquarium = user.pets.filter(p => p.aquariumId === aq.id).length;
                    return fishInAquarium < aq.capacity && aq.temperature === pet.temperature;
                });
                
                if (compatibleAquariums.length === 0) {
                    const tempText = pet.temperature === 'warm' ? 'caliente' : 'frÃ­a';
                    alert(`Â¡Este pez necesita agua ${tempText}! Necesitas una pecera ${tempText} con espacio disponible.`);
                    return;
                }
            }
            
            const reward = pet.type === 'cat' ? 250 : 100;
            
            // Add pet to user's collection
            const newPet = {
                ...pet,
                id: Date.now().toString(),
                adoptedAt: gameState.gameTime
            };
            
            // If it's a fish, assign to a compatible aquarium
            if (pet.type === 'fish') {
                const compatibleAquarium = user.aquariums.find(aq => {
                    const fishInAquarium = user.pets.filter(p => p.aquariumId === aq.id).length;
                    return fishInAquarium < aq.capacity && aq.temperature === pet.temperature;
                });
                newPet.aquariumId = compatibleAquarium.id;
            }
            
            user.pets.push(newPet);
            user.coins += reward;
            
            // Remove from available pets
            gameState.availablePets = gameState.availablePets.filter(p => p.id !== petId);
            
            updateDisplay();
            updateShelterDisplay();
            updatePetsDisplay();
            saveGameData();
            
            alert(`Â¡Has adoptado a ${pet.name}! Recibes ${reward} monedas de recompensa.`);
        }

        function treatPet(petId) {
            const user = gameState.users[gameState.currentUser];
            const pet = user.pets.find(p => p.id === petId);
            
            if (!pet) return;
            
            // Calculate treatment cost
            let treatmentCost = 25; // Base consultation
            if (pet.virus) {
                treatmentCost = pet.virus.price;
            }
            
            if (user.coins < treatmentCost) {
                alert(`No tienes suficientes monedas para el tratamiento (${treatmentCost} ğŸª™)`);
                return;
            }
            
            user.coins -= treatmentCost;
            
            // Cure the pet
            if (pet.virus) {
                const virusName = pet.virus.name;
                pet.virus = null; // Remove virus
                pet.health = Math.min(100, pet.health + 40);
                alert(`${pet.name} ha sido curado de ${virusName} y se siente mucho mejor!`);
            } else {
                pet.health = Math.min(100, pet.health + 30);
                alert(`${pet.name} ha recibido tratamiento y se siente mejor!`);
            }
            
            updateDisplay();
            updateVetDisplay();
            updatePetsDisplay();
            saveGameData();
        }

        function takeTransport(line) {
            const user = gameState.users[gameState.currentUser];
            
            if (user.coins < 15) {
                alert('No tienes suficientes monedas para el transporte');
                return;
            }
            
            user.coins -= 15;
            updateDisplay();
            
            const routes = {
                'C1': 'Casa â†’ Tienda â†’ Veterinario â†’ Casa',
                '5A': 'Casa â†’ Tienda â†’ Casa',
                '15C': 'Casa â†’ Protectora â†’ Tienda â†’ Protectora â†’ Casa',
                '28': 'Casa â†’ Veterinario â†’ Casa'
            };
            
            alert(`Â¡Viajando en la lÃ­nea ${line}!\nRuta: ${routes[line]}`);
        }

        function addBreed() {
            const type = document.getElementById('newPetType').value;
            const breedName = document.getElementById('newBreedName').value.trim();
            
            if (!breedName) {
                alert('Ingresa el nombre de la raza');
                return;
            }
            
            if (!gameState.breeds[type].includes(breedName)) {
                gameState.breeds[type].push(breedName);
                document.getElementById('newBreedName').value = '';
                updateAdminDisplay();
                alert(`Raza ${breedName} agregada exitosamente`);
            } else {
                alert('Esta raza ya existe');
            }
        }

        function addShopItem() {
            const name = document.getElementById('newItemName').value.trim();
            const price = parseInt(document.getElementById('newItemPrice').value);
            const category = document.getElementById('newItemCategory').value;
            
            if (!name || !price) {
                alert('Completa todos los campos');
                return;
            }
            
            const emojis = {
                food: 'ğŸ¥«',
                toy: 'ğŸ§¸',
                accessory: 'ğŸ€',
                medicine: 'ğŸ’Š'
            };
            
            const newItem = {
                id: Date.now(),
                name: name,
                price: price,
                category: category,
                emoji: emojis[category]
            };
            
            gameState.shopItems.push(newItem);
            
            // Clear form
            document.getElementById('newItemName').value = '';
            document.getElementById('newItemPrice').value = '';
            
            updateAdminDisplay();
            alert(`Producto ${name} agregado exitosamente`);
        }

        function removeShopItem(itemId) {
            if (confirm('Â¿EstÃ¡s seguro de eliminar este producto?')) {
                gameState.shopItems = gameState.shopItems.filter(item => item.id !== itemId);
                updateAdminDisplay();
            }
        }

        function addRandomPetToShelter() {
            // Ensure equal distribution of cats and fish
            const currentCats = gameState.availablePets.filter(pet => pet.type === 'cat').length;
            const currentFish = gameState.availablePets.filter(pet => pet.type === 'fish').length;
            
            let type;
            if (currentCats > currentFish) {
                type = 'fish';
            } else if (currentFish > currentCats) {
                type = 'cat';
            } else {
                // Equal amounts, choose randomly
                type = Math.random() < 0.5 ? 'cat' : 'fish';
            }
            
            let breed, breedData;
            if (type === 'cat') {
                breedData = gameState.breeds.cat;
                breed = breedData[Math.floor(Math.random() * breedData.length)];
            } else {
                // For fish, combine all breeds to ensure equal representation
                const allFishBreeds = [...gameState.breeds.fish.coldWater, ...gameState.breeds.fish.warmWater];
                breed = allFishBreeds[Math.floor(Math.random() * allFishBreeds.length)];
            }
            
            const gender = Math.random() < 0.5 ? 'male' : 'female';
            const names = gameState.petNames[type][gender];
            const name = names[Math.floor(Math.random() * names.length)];
            const color = breed.colors[Math.floor(Math.random() * breed.colors.length)];
            
            const newPet = {
                id: Date.now() + Math.random(),
                name: name,
                type: type,
                breed: breed.name,
                color: color,
                gender: gender,
                emoji: breed.emoji,
                temperature: breed.temperature, // Always include temperature for fish
                age: Math.round((Math.random() * 24 + 1) * 10) / 10, // 0.1 to 24 months
                health: Math.round((Math.random() * 30 + 70) * 10) / 10, // 70-100%
                happiness: Math.round((Math.random() * 40 + 60) * 10) / 10 // 60-100%
            };
            
            gameState.availablePets.push(newPet);
            saveGameData();
        }

        function setupAquarium() {
            const user = gameState.users[gameState.currentUser];
            
            // Check available aquariums in inventory
            const availableAquariums = gameState.shopItems.filter(item => 
                item.category === 'aquarium' && user.inventory[item.name] > 0
            );
            
            if (availableAquariums.length === 0) {
                alert('Â¡No tienes peceras en tu inventario! Compra una en la tienda primero.');
                return;
            }
            
            // Show selection modal
            const aquariumOptions = availableAquariums.map(aq => 
                `<button onclick="installAquarium('${aq.name}')" class="w-full bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 mb-2">
                    ${aq.emoji} ${aq.name} (Capacidad: ${aq.capacity} peces)
                </button>`
            ).join('');
            
            const modal = document.getElementById('petModal');
            const content = document.getElementById('petModalContent');
            
            content.innerHTML = `
                <div class="text-center">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">ğŸ  Instalar Pecera</h2>
                    <p class="text-gray-600 mb-6">Selecciona quÃ© pecera quieres instalar:</p>
                    
                    <div class="space-y-3">
                        ${aquariumOptions}
                    </div>
                    
                    <button onclick="closeModal()" class="w-full bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 mt-4">
                        Cancelar
                    </button>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        function installAquarium(aquariumName) {
            const user = gameState.users[gameState.currentUser];
            const aquariumItem = gameState.shopItems.find(item => item.name === aquariumName);
            
            if (!aquariumItem || !user.inventory[aquariumName] || user.inventory[aquariumName] <= 0) {
                return;
            }
            
            // Initialize aquariums array if it doesn't exist
            if (!user.aquariums) {
                user.aquariums = [];
            }
            
            // Create new aquarium
            const newAquarium = {
                id: Date.now().toString(),
                name: aquariumName,
                emoji: aquariumItem.emoji,
                capacity: aquariumItem.capacity,
                temperature: aquariumItem.temperature,
                decorations: [],
                installedAt: gameState.gameTime
            };
            
            user.aquariums.push(newAquarium);
            user.inventory[aquariumName]--;
            
            updateDisplay();
            updatePetsDisplay();
            updateInventoryDisplay();
            saveGameData();
            closeModal();
            
            alert(`Â¡Pecera ${aquariumName} instalada correctamente!`);
        }

        function removeAquarium(aquariumId) {
            const user = gameState.users[gameState.currentUser];
            const aquarium = user.aquariums.find(aq => aq.id === aquariumId);
            
            if (!aquarium) return;
            
            // Check if aquarium has fish
            const fishInAquarium = user.pets.filter(pet => pet.aquariumId === aquariumId);
            
            if (fishInAquarium.length > 0) {
                alert('Â¡No puedes quitar una pecera que tiene peces! Mueve los peces primero.');
                return;
            }
            
            if (confirm(`Â¿EstÃ¡s seguro de quitar la ${aquarium.name}?`)) {
                // Return aquarium to inventory
                user.inventory[aquarium.name] = (user.inventory[aquarium.name] || 0) + 1;
                
                // Remove aquarium
                user.aquariums = user.aquariums.filter(aq => aq.id !== aquariumId);
                
                updateDisplay();
                updatePetsDisplay();
                updateInventoryDisplay();
                saveGameData();
                
                alert(`${aquarium.name} devuelta al inventario.`);
            }
        }

        function addFishToAquarium(aquariumId) {
            showSection('shelter');
            alert('Ve a la protectora para adoptar peces. Se asignarÃ¡n automÃ¡ticamente a esta pecera si hay espacio.');
        }

        function setupCatAccessory() {
            const user = gameState.users[gameState.currentUser];
            
            // Check available cat accessories in inventory
            const availableAccessories = gameState.shopItems.filter(item => 
                item.category === 'catAccessory' && user.inventory[item.name] > 0
            );
            
            if (availableAccessories.length === 0) {
                alert('Â¡No tienes accesorios para gatos en tu inventario! Compra algunos en la tienda primero.');
                return;
            }
            
            // Show selection modal
            const accessoryOptions = availableAccessories.map(acc => 
                `<button onclick="installCatAccessory('${acc.name}')" class="w-full bg-orange-500 text-white py-2 px-4 rounded-lg hover:bg-orange-600 mb-2">
                    ${acc.emoji} ${acc.name}
                </button>`
            ).join('');
            
            const modal = document.getElementById('petModal');
            const content = document.getElementById('petModalContent');
            
            content.innerHTML = `
                <div class="text-center">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">ğŸ± Instalar Accesorio</h2>
                    <p class="text-gray-600 mb-6">Selecciona quÃ© accesorio quieres instalar:</p>
                    
                    <div class="space-y-3">
                        ${accessoryOptions}
                    </div>
                    
                    <button onclick="closeModal()" class="w-full bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 mt-4">
                        Cancelar
                    </button>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        function installCatAccessory(accessoryName) {
            const user = gameState.users[gameState.currentUser];
            const accessoryItem = gameState.shopItems.find(item => item.name === accessoryName);
            
            if (!accessoryItem || !user.inventory[accessoryName] || user.inventory[accessoryName] <= 0) {
                return;
            }
            
            // Initialize catAccessories array if it doesn't exist
            if (!user.catAccessories) {
                user.catAccessories = [];
            }
            
            // Create new accessory
            const newAccessory = {
                id: Date.now().toString(),
                name: accessoryName,
                emoji: accessoryItem.emoji,
                installedAt: gameState.gameTime
            };
            
            user.catAccessories.push(newAccessory);
            user.inventory[accessoryName]--;
            
            updateDisplay();
            updatePetsDisplay();
            updateInventoryDisplay();
            saveGameData();
            closeModal();
            
            alert(`Â¡${accessoryName} instalado correctamente!`);
        }

        function removeCatAccessory(accessoryId) {
            const user = gameState.users[gameState.currentUser];
            const accessory = user.catAccessories.find(acc => acc.id === accessoryId);
            
            if (!accessory) return;
            
            if (confirm(`Â¿EstÃ¡s seguro de quitar ${accessory.name}?`)) {
                // Return accessory to inventory
                user.inventory[accessory.name] = (user.inventory[accessory.name] || 0) + 1;
                
                // Remove accessory
                user.catAccessories = user.catAccessories.filter(acc => acc.id !== accessoryId);
                
                updateDisplay();
                updatePetsDisplay();
                updateInventoryDisplay();
                saveGameData();
                
                alert(`${accessory.
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9c69235dc777a431',t:'MTc2OTg2MTc2NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>
<html/>
